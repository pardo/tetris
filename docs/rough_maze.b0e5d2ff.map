{"version":3,"sources":["helpers.js","piece.js","block.js","ground.js","tetris.js","node_modules/roughjs/bin/path.js","node_modules/roughjs/bin/geometry.js","node_modules/roughjs/bin/utils/hachure.js","node_modules/roughjs/bin/fillers/filler-utils.js","node_modules/roughjs/bin/fillers/hachure-filler.js","node_modules/roughjs/bin/fillers/zigzag-filler.js","node_modules/roughjs/bin/fillers/hatch-filler.js","node_modules/roughjs/bin/fillers/dot-filler.js","node_modules/roughjs/bin/fillers/filler.js","node_modules/roughjs/bin/renderer.js","node_modules/roughjs/bin/renderer-factory.js","node_modules/roughjs/bin/generator-base.js","node_modules/roughjs/bin/generator.js","node_modules/roughjs/bin/canvas-base.js","node_modules/roughjs/bin/canvas.js","node_modules/roughjs/bin/generator-async.js","node_modules/roughjs/bin/canvas-async.js","node_modules/roughjs/bin/svg-base.js","node_modules/roughjs/bin/svg.js","node_modules/roughjs/bin/svg-async.js","node_modules/roughjs/bin/rough.js","drawable.js","node_modules/js-binarypack/lib/bufferbuilder.js","node_modules/js-binarypack/lib/binarypack.js","node_modules/webrtc-adapter/src/js/utils.js","node_modules/webrtc-adapter/src/js/chrome/getusermedia.js","node_modules/webrtc-adapter/src/js/chrome/chrome_shim.js","node_modules/webrtc-adapter/src/js/edge/filtericeservers.js","node_modules/sdp/sdp.js","node_modules/rtcpeerconnection-shim/rtcpeerconnection.js","node_modules/webrtc-adapter/src/js/edge/getusermedia.js","node_modules/webrtc-adapter/src/js/edge/edge_shim.js","node_modules/webrtc-adapter/src/js/firefox/getusermedia.js","node_modules/webrtc-adapter/src/js/firefox/firefox_shim.js","node_modules/webrtc-adapter/src/js/safari/safari_shim.js","node_modules/webrtc-adapter/src/js/common_shim.js","node_modules/webrtc-adapter/src/js/adapter_factory.js","node_modules/webrtc-adapter/src/js/adapter_core.js","node_modules/peerjs/lib/adapter.js","node_modules/peerjs/lib/util.js","node_modules/eventemitter3/index.js","node_modules/peerjs/lib/socket.js","node_modules/peerjs/lib/negotiator.js","node_modules/peerjs/lib/mediaconnection.js","node_modules/reliable/lib/util.js","node_modules/reliable/lib/reliable.js","node_modules/peerjs/lib/dataconnection.js","node_modules/peerjs/lib/peer.js","htmlgame.js","main.js","index.js"],"names":["goFullscreen","elem","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","FisherYatesShuffle","myArray","i","j","tempi","tempj","length","Math","floor","random","range","start","end","step","arguments","push","distancePoints","p1","p2","sqrt","pow","x","y","distanceXY","x1","y1","x2","y2","rad2deg","d","deg2rad","angleBetweenXY","a","atan2","console","log","PI","pointFollowingAnglePoint","pos","angle","distance","cos","sin","mapObj","func","obj","keys","Object","result","getWindowSizePoint","winW","winH","document","body","offsetWidth","offsetHeight","compatMode","documentElement","window","innerWidth","innerHeight","width","height","getElementSize","element","downloadText","filename","text","pom","createElement","setAttribute","encodeURIComponent","click","getId","base62","str","debounce","wait","immediate","timeout","context","args","callNow","clearTimeout","setTimeout","apply","throttle","throttling","more","whenDone","changeColorLuminance","hex","lum","String","replace","rgb","c","parseInt","substr","round","min","max","toString","randomHexColor","isTouchDevice","Piece","PiecesShapes","type","options","initialize","piece","hard","assign","color","shapes","offset","shapeIndex","rotateClockwise","rotateCounterClockwise","draw","groundObject","placeOnGround","collide","outside","method","ground","pattern","block","shouldDrawALine","p","xground","yground","e","empty","setColor","lines","Block","TOP_LINE","RIGHT_LINE","BOTTOM_LINE","LEFT_LINE","ALL_LINES","toLines","points","index","drawBlock","drawable","data","roughCanvas","margin","size","left","right","top","bottom","b","f","g","h","k","l","n","o","topLeftPoints","topRightPoints","bottomRightPoints","bottomLeftPoints","topPoints","rightPoints","bottomPoints","leftPoints","hachureAngle","concat","polygon","hachureGap","roughness","stroke","fill","fillStyle","lineOptions","strokeWidth","strokeColor","forEach","line","drawEmpty","getLinesAsNumber","drawOriginal","rectangle","emptyColor","drawBlockLines","copyFrom","setPos","setSize","Ground","groundWidth","groundHeight","blockSize","addRandomBottom","w","hide","mapGroundBlocks","setBlockSize","meld","callback","ended","getCompletedLines","completedLines","complete","removeLine","ht","removeLines","drawGrid","bowing","gridOptions","map","position","blocks","col","Tetris","drawableBackground","drawablePieces","newPiecePosition","currentPieceGround","reset","count","pieces","linesCount","speed","piecePosition","nextPiece","groundDirty","currentPieceGroundDirty","serialize","previousUpdate","serializedGround","cpb","blockToPush","loadSerializedData","slice","drawPieceGround","clear","bind","drawGround","rotatePiece","action","reverseAction","tmpPos","rotatePieceClockwise","rotatePieceCounterClockwise","pieceMove","offsetX","newPos","pieceMoveLeft","pieceMoveRight","pieceMoveDown","auto","linesRemovedCallback","newPieceCallback","gameEndedCallback","resize","getPoints","makeNextPieceHardOne","numberOfLines","undefined","ceil","tetris","currentPiece","isType","token","PARAMS","A","C","H","L","M","m","Q","q","S","s","T","t","V","v","Z","z","ParsedPath","constructor","COMMAND","NUMBER","EOD","segments","parseData","processPoints","tokenize","tokens","Array","match","RegExp","$1","error","parseFloat","mode","param_length","params","numbeToken","segment","key","closed","_closed","toLowerCase","first","currentPoint","point","RoughPath","_position","_first","bezierReflectionPoint","quadReflectionPoint","parsed","linearPoints","_linearPoints","lp","setPosition","RoughArcConverter","from","to","radii","largeArcFlag","sweepFlag","_segIndex","_numSegs","_rx","_ry","_sinPhi","_cosPhi","_C","_theta","_delta","_T","_from","radPerDeg","abs","x1dash","y1dash","root","numerator","cxdash","cydash","calculateVectorAngle","dtheta","getNextSegment","cosTheta1","sinTheta1","theta2","cosTheta2","sinTheta2","cp1","cp2","ux","uy","vx","vy","ta","tb","PathFitter","sets","fit","simplification","outSets","set","estLength","reduce","areas","minArea","minIndex","area","splice","Segment","xi","Number","MAX_VALUE","yi","px1","py1","px2","py2","_undefined","isUndefined","intersects","otherSegment","grad1","grad2","int1","int2","HachureIterator","gap","sinAngle","cosAngle","tanAngle","deltaX","hGap","sLeft","sRight","nextLine","xLower","xUpper","yLower","yUpper","lineLength","getIntersectingLines","intersections","s1","s2","affine","cx","cy","sinAnglePrime","cosAnglePrime","R","hachureLinesForPolygon","ret","tan","it","rect","hachureLinesForEllipse","renderer","rx","ry","getOffset","fweight","fillWeight","aspectRatio","hyp","gapPrime","halfLen","xPos","HachureFiller","fillPolygon","_fillPolygon","fillEllipse","_fillEllipse","connectEnds","ops","renderLines","prevPoint","doubleLine","ZigZagFiller","HatchFiller","o2","set2","DotFiller","curveStepCount","dotsOnLines","dl","alpha","atan","dy","dx","ellipse","fillers","getFiller","fillerName","RoughRenderer","linearPath","close","len","curve","o1","_curveWithOffset","increment","_ellipse","arc","stop","roughClosure","strt","stp","ellipseInc","arcInc","_arc","op","svgPath","path","fitter","prev","opList","_processSegment","solidFillPolygon","maxRandomnessOffset","patternFillPolygon","filler","patternFillEllipse","patternFillArc","_line","move","overlay","lengthSq","halfOffset","divergePoint","midDispX","midDispY","_curve","closePoint","curveTightness","cachedVertArray","ro","overlap","radOffset","ps","_bezierTo","ros","seg","prevSeg","delta","ob","prevKey","ref","offset1","offset2","arcConverter","hasSelf","self","roughScript","currentScript","src","createRenderer","config","workly","async","noWorker","worklySource","worklyURL","code","ourl","URL","createObjectURL","Blob","proxy","RoughGeneratorBase","surface","defaultOptions","_options","_drawable","shape","lib","getCanvasSize","val","baseVal","value","computePolygonSize","polygonPath","computePathSize","ns","svg","createElementNS","pathNode","appendChild","bb","getBBox","removeChild","err","canvasSize","toPaths","paths","drawing","opsToPath","fillSketch","viewBox","patternUnits","item","trim","RoughGenerator","circle","diameter","fillPoints","hasDocument","RoughCanvasBase","canvas","ctx","getContext","getDefaultOptions","save","strokeStyle","lineWidth","_drawToContext","restore","p2d","Path2D","doc","ownerDocument","hcanvas","hcontext","bbox","computeBBox","translate","createPattern","beginPath","moveTo","bezierCurveTo","quadraticCurveTo","lineTo","RoughCanvas","gen","generator","RoughGeneratorAsync","RoughCanvasAsync","genAsync","RoughSVGBase","defs","_defs","dnode","firstChild","insertBefore","style","id","MAX_SAFE_INTEGER","patternPath","RoughSVG","RoughSVGAsync","Drawable","createAndAppend","parent","context2d","rough","getSize","clearRect","logDisabled_","deprecationWarnings_","extractVersion","uastring","expr","wrapPeerConnectionEvent","eventNameToWrap","wrapper","RTCPeerConnection","proto","prototype","nativeAddEventListener","addEventListener","nativeEventName","cb","wrappedCallback","modifiedEvent","_eventMap","nativeRemoveEventListener","removeEventListener","unwrappedCb","defineProperty","get","enumerable","configurable","module","exports","disableLog","bool","Error","disableWarnings","deprecated","oldMethod","newMethod","warn","detectBrowser","navigator","browser","mozGetUserMedia","version","userAgent","webkitGetUserMedia","mediaDevices","utils","require","logging","browserDetails","constraintsToChrome_","mandatory","optional","cc","r","ideal","exact","oldname_","prefix","name","charAt","toUpperCase","oc","mix","advanced","shimConstraints_","constraints","JSON","parse","stringify","audio","remap","video","face","facingMode","getSupportedFacingModeLies","matches","getSupportedConstraints","enumerateDevices","then","devices","dev","filter","kind","find","some","label","indexOf","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","getUserMedia","onSuccess","onError","getUserMediaPromise_","Promise","resolve","reject","kinds","MediaStreamTrack","getSources","device","groupId","echoCancellation","frameRate","origGetUserMedia","cs","stream","getAudioTracks","getVideoTracks","getTracks","track","DOMException","walkStats","stats","base","resultSet","has","endsWith","filterStats","outbound","streamStatsType","filteredResult","Map","trackStats","trackIdentifier","trackStat","trackId","shimGetUserMedia","shimMediaStream","MediaStream","webkitMediaStream","shimOnTrack","transceiver","receiver","_ontrack","origSetRemoteDescription","setRemoteDescription","pc","_ontrackpoly","te","getReceivers","event","Event","streams","dispatchEvent","shimGetSendersWithDtmf","shimSenderWithDtmf","dtmf","_dtmf","createDTMFSender","_pc","getSenders","_senders","origAddTrack","addTrack","sender","origRemoveTrack","removeTrack","idx","origAddStream","addStream","origRemoveStream","removeStream","RTCRtpSender","origGetSenders","senders","shimSenderReceiverGetStats","RTCRtpReceiver","getStats","origGetReceivers","receivers","srcElement","origGetStats","shimSourceObject","HTMLMediaElement","_srcObject","revokeObjectURL","shimAddTrackRemoveTrackWithNative","getLocalStreams","_shimmedLocalStreams","streamId","alreadyExists","existingSenders","newSenders","newSender","shimAddTrackRemoveTrack","origGetLocalStreams","nativeStreams","_reverseStreams","_streams","newStream","signalingState","call","oldStream","nativeMethod","isLegacyCall","description","desc","replaceInternalStreamId","origSetLocalDescription","setLocalDescription","replaceExternalStreamId","sdp","internalId","externalStream","internalStream","RTCSessionDescription","origLocalDescription","getOwnPropertyDescriptor","streamid","shimPeerConnection","webkitRTCPeerConnection","pcConfig","pcConstraints","iceTransportPolicy","iceTransports","generateCertificate","selector","successCallback","errorCallback","fixChromeStats_","response","standardReport","report","standardStats","timestamp","localcandidate","remotecandidate","names","stat","makeMapStats","promise","opts","RTCIceCandidate","nativeAddIceCandidate","addIceCandidate","fixNegotiationNeeded","target","shimGetDisplayMedia","getSourceId","getDisplayMedia","sourceId","widthSpecified","heightSpecified","frameRateSpecified","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","iceServers","edgeVersion","hasTurn","server","urls","url","isString","validTurn","SDPUtils","fixStatsType","inboundrtp","outboundrtp","candidatepair","writeMediaSection","caps","dtlsRole","writeRtpDescription","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","mid","rtpSender","rtpReceiver","_initialTrackId","msid","sendEncodingParameters","ssrc","rtx","localCName","filterIceServers","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","codecs","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","parameters","apt","rCodec","clockRate","numChannels","rtcpFeedback","fb","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","offer","answer","maybeAddCandidate","iceTransport","candidate","alreadyAdded","getRemoteCandidates","remoteCandidate","foundation","ip","port","priority","protocol","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","TypeError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","trackEvent","_dispatchEvent","_eventTarget","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceConnectionState","connectionState","iceGatheringState","usingBundle","bundlePolicy","rtcpMuxPolicy","_iceGatherers","iceCandidatePoolSize","RTCIceGatherer","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","getConfiguration","getRemoteStreams","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","enabled","_createIceGatherer","sdpMLineIndex","shift","writable","bufferedCandidateEvents","bufferCandidates","state","_gather","onlocalcandidate","evt","sdpMid","cand","component","ufrag","usernameFragment","serializedCandidate","writeCandidate","parseCandidate","toJSON","sections","getMediaSections","getDescription","join","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","_disposeIceAndDtlsTransports","_transceive","send","recv","encodings","rtcp","cname","compound","rtcpParameters","receive","sessionpart","splitSections","mediaSection","parseRtpParameters","isIceLite","matchPrefix","isRejected","rejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","role","_updateSignalingState","receiverList","iceOptions","split","splitLines","getKind","direction","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","cands","setTransport","setRemoteCandidates","default","getCapabilities","codec","isNewTrack","nativeTrack","sid","newState","states","checking","connected","completed","disconnected","failed","new","connecting","createOffer","numAudioTracks","numVideoTracks","offerOptions","offerToReceiveAudio","offerToReceiveVideo","writeSessionBoilerplate","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","createAnswer","mediaSectionsInOffer","localTrack","reducedSize","candidateString","senderOrReceiver","promises","all","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","catch","shimRTCPeerConnection","origMSTEnabled","ev","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","shimReplaceTrack","replaceTrack","setTrack","preferredMediaSource","origGetDisplayMedia","InternalError","SecurityError","getUserMedia_","constraintsToFF37_","orgEnumerateDevices","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","RTCTrackEvent","mozSrcObject","mozRTCPeerConnection","newIceServers","hasOwnProperty","newServer","username","credential","mozRTCSessionDescription","mozRTCIceCandidate","modernStatsTypes","nativeGetStats","onSucc","onErr","shimSenderGetStats","shimReceiverGetStats","shimRemoveStream","shimRTCDataChannel","DataChannel","RTCDataChannel","mediaSource","shimLocalStreamsAPI","_localStreams","getStreamById","_remoteStreams","_addTrack","tracks","shimRemoteStreamsAPI","_onaddstream","_onaddstreampoly","shimCallbacksAPI","failureCallback","withCallback","errcb","shimRTCIceServerUrls","OrigPeerConnection","shimTrackEventTransceiver","RTCTransceiver","shimCreateOfferLegacy","origCreateOffer","audioTransceiver","getTransceivers","setDirection","addTransceiver","videoTransceiver","shimRTCIceCandidate","NativeRTCIceCandidate","nativeCandidate","parsedCandidate","augmentedCandidate","shimCreateObjectURL","nativeCreateObjectURL","nativeRevokeObjectURL","newId","delete","dsc","srcObject","nativeSetAttribute","shimMaxMessageSize","RTCSctpTransport","_sctp","sctpInDescription","remoteIsFirefox","canSendMaxMessageSize","mLine","parseMLine","isFirefox","maxMessageSize","getRemoteFirefoxVersion","canSendMMS","remoteMMS","getMaxMessageSize","POSITIVE_INFINITY","sctp","shimSendThrowTypeError","origCreateDataChannel","createDataChannel","dataChannel","wrapDcSend","channel","dc","origDataChannelSend","byteLength","readyState","dependencies","shimChrome","shimFirefox","shimEdge","shimSafari","chromeShim","edgeShim","firefoxShim","safariShim","commonShim","adapter","browserShim","adapterFactory","global","HTMLTetrisGame","playable","half","sendGroundLoopInterval","createHtmlElements","createDrawables","createTetrisGame","attachWindowEvents","startPieceMoveDownLoop","startDrawLoop","handleResize","addReplica","conn","replica","sendGroundLoop","on","destroy","createPeer","handleKeyboardEvent","background","className","elementInner","moveDown","moveLeft","moveRight","which","prompt","connect","clearInterval","setInterval","anotherName","peer","Peer","getElementById","game","Game"],"mappings":"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","file":"rough_maze.b0e5d2ff.map","sourceRoot":"..","sourcesContent":["function goFullscreen (elem) {\n  if (elem.requestFullscreen) {\n    elem.requestFullscreen()\n  } else if (elem.msRequestFullscreen) {\n    elem.msRequestFullscreen()\n  } else if (elem.mozRequestFullScreen) {\n    elem.mozRequestFullScreen()\n  } else if (elem.webkitRequestFullscreen) {\n    elem.webkitRequestFullscreen()\n  }\n}\n\nfunction FisherYatesShuffle (myArray) {\n  var i = myArray.length\n  var j\n  var tempi\n  var tempj\n  if (i === 0) return false\n  while (--i) {\n    j = Math.floor(Math.random() * (i + 1))\n    tempi = myArray[i]\n    tempj = myArray[j]\n    myArray[i] = tempj\n    myArray[j] = tempi\n  }\n  return myArray\n}\n\nfunction range (start, end, step) {\n  var range = []\n  var i\n  switch (arguments.length) {\n    case 1:\n      for (i = 0; i < start; i++) { range.push(i) }\n      break\n    case 2:\n      if (end > start) {\n        for (i = start; i < end; i++) { range.push(i) }\n      } else {\n        for (i = start; i > end; i--) { range.push(i) }\n      }\n      break\n    case 3:\n      if (start < end && step > 0) {\n        for (i = start; i < end;) { range.push(i); i += step }\n      } else if (start > end && step < 0) {\n        for (i = start; i > end;) { range.push(i); i += step }\n      }\n      break\n  }\n  return range\n}\n\nfunction distancePoints (p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2))\n}\n\nfunction distanceXY (x1, y1, x2, y2) {\n  return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2))\n}\n\n// 57.29577951308232 = 180 / Math.PI\nfunction rad2deg (d) {\n  return d * 57.29577951308232\n}\n\nfunction deg2rad (d) {\n  return d / 57.29577951308232\n}\n\nfunction angleBetweenXY (x1, y1, x2, y2) {\n  var a = Math.atan2(y2 - y1, x2 - x1)\n  console.log(a)\n  if (a < 0) { a += Math.PI * 2 }\n  return a\n}\n\nfunction pointFollowingAnglePoint (pos, angle, distance) {\n  // angle should be radians\n  // 0-360 0 mean east 90 south 180 west 270 north in degrees\n  return {\n    x: pos.x + Math.cos(angle) * distance,\n    y: pos.y + Math.sin(angle) * distance\n  }\n}\n\nfunction mapObj (func, obj) {\n  // iterate over objects keys\n  // func(obj , key, index)\n  var keys = Object.keys(obj)\n  var result = []\n  for (var i = 0; i < keys.length; i++) {\n    result.push(\n      func(obj[keys[i]], keys[i], i)\n    )\n  }\n  return result\n}\n\nfunction getWindowSizePoint () {\n  var winW = 0\n  var winH = 0\n  if (document.body && document.body.offsetWidth) {\n    winW = document.body.offsetWidth\n    winH = document.body.offsetHeight\n  }\n  if (document.compatMode === 'CSS1Compat' &&\n  document.documentElement &&\n  document.documentElement.offsetWidth) {\n    winW = document.documentElement.offsetWidth\n    winH = document.documentElement.offsetHeight\n  }\n  if (window.innerWidth && window.innerHeight) {\n    winW = window.innerWidth\n    winH = window.innerHeight\n  }\n  return {\n    width: winW,\n    height: winH\n  }\n}\n\nfunction getElementSize (element) {\n  return {\n    width: element.offsetWidth,\n    height: element.offsetHeight\n  }\n}\n\nfunction downloadText (filename, text) {\n  // download content as a data test\n  var pom = document.createElement('a')\n  pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text))\n  pom.setAttribute('download', filename)\n  pom.click()\n}\n\nfunction getId (length) {\n  // with a length of 6 the first collision occurs after more than 9000000 of ids\n  var base62 = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'\n  var str = ''\n  length = length || 10\n  for (let i = 0; i < length; i++) {\n    str += base62[Math.floor(Math.random() * 62)]\n  }\n  return str\n}\n// extracted from underscore\nfunction debounce (func, wait, immediate) {\n  var timeout\n  var result\n  return function () {\n    var context = this\n    var args = arguments\n    var later = function () {\n      timeout = null\n      if (!immediate) result = func.apply(context, args)\n    }\n    var callNow = immediate && !timeout\n    clearTimeout(timeout)\n    timeout = setTimeout(later, wait)\n    if (callNow) result = func.apply(context, args)\n    return result\n  }\n}\n\nfunction throttle (func, wait) {\n  var context\n  var args\n  var timeout\n  var throttling\n  var more\n  var result\n  var whenDone = debounce(function () { more = throttling = false }, wait)\n  return function () {\n    context = this\n    args = arguments\n    var later = function () {\n      timeout = null\n      if (more) func.apply(context, args)\n      whenDone()\n    }\n    if (!timeout) timeout = setTimeout(later, wait)\n    if (throttling) {\n      more = true\n    } else {\n      result = func.apply(context, args)\n    }\n    whenDone()\n    throttling = true\n    return result\n  }\n}\n\nfunction changeColorLuminance (hex, lum) {\n  // validate hex string\n  hex = String(hex).replace(/[^0-9a-f]/gi, '')\n  if (hex.length < 6) {\n    hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2]\n  }\n  lum = lum || 0\n  // convert to decimal and change luminosity\n  var rgb = '#'\n  var c\n  var i\n  for (i = 0; i < 3; i++) {\n    c = parseInt(hex.substr(i * 2, 2), 16)\n    c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16)\n    rgb += ('00' + c).substr(c.length)\n  }\n  return rgb\n}\n\nfunction randomHexColor () {\n  var rgb = '#'\n  var c\n  var i\n  for (i = 0; i < 3; i++) {\n    c = Math.random() * 256\n    c = Math.round(Math.min(Math.max(0, c), 255)).toString(16)\n    rgb += ('00' + c).substr(c.length)\n  }\n  return rgb\n}\n\nfunction isTouchDevice () {\n  return 'ontouchstart' in window || 'onmsgesturechange' in window\n}\n\nexport {\n  debounce,\n  throttle,\n  getId,\n  downloadText,\n  getWindowSizePoint,\n  mapObj,\n  pointFollowingAnglePoint,\n  angleBetweenXY,\n  deg2rad,\n  rad2deg,\n  distancePoints,\n  distanceXY,\n  range,\n  FisherYatesShuffle,\n  goFullscreen,\n  isTouchDevice,\n  changeColorLuminance,\n  randomHexColor,\n  getElementSize\n}\n","import {FisherYatesShuffle} from './helpers'\n\nvar PiecesShapes = {}\n\nPiecesShapes['is'] = {\n  color: '#64b0ff',\n  shapes: [\n    [\n      [1, 1, 0],\n      [0, 1, 1],\n      [0, 0, 0]\n    ],\n    [\n      [0, 1, 0],\n      [1, 1, 0],\n      [1, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['s'] = {\n  color: '#008f32',\n  shapes: [\n    [\n      [0, 1, 1],\n      [1, 1, 0],\n      [0, 0, 0]\n    ],\n    [\n      [1, 0, 0],\n      [1, 1, 0],\n      [0, 1, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['il'] = {\n  color: '#ea9e22',\n  shapes: [\n    [\n      [1, 1, 1],\n      [0, 0, 1],\n      [0, 0, 0]\n    ],\n    [\n      [0, 1, 0],\n      [0, 1, 0],\n      [1, 1, 0]\n    ],\n    [\n      [1, 0, 0],\n      [1, 1, 1],\n      [0, 0, 0]\n    ],\n    [\n      [1, 1, 0],\n      [1, 0, 0],\n      [1, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['l'] = {\n  color: '#f26aff',\n  shapes: [\n    [\n      [1, 1, 1],\n      [1, 0, 0],\n      [0, 0, 0]\n    ],\n    [\n      [1, 1, 0],\n      [0, 1, 0],\n      [0, 1, 0]\n    ],\n    [\n      [0, 0, 1],\n      [1, 1, 1],\n      [0, 0, 0]\n    ],\n    [\n      [1, 0, 0],\n      [1, 0, 0],\n      [1, 1, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['c'] = {\n  color: '#4240ff',\n  shapes: [\n    [\n      [1, 1],\n      [1, 1]\n    ]\n  ],\n  offset: [0, 0]\n}\n\nPiecesShapes['t'] = {\n  // color: \"#6b6d00\",\n  // color: \"#afaf24\",\n  color: '#afcf30',\n  shapes: [\n    [\n      [1, 1, 1],\n      [0, 1, 0],\n      [0, 0, 0]\n    ],\n    [\n      [0, 1, 0],\n      [1, 1, 0],\n      [0, 1, 0]\n    ],\n    [\n      [0, 1, 0],\n      [1, 1, 1],\n      [0, 0, 0]\n    ],\n    [\n      [1, 0, 0],\n      [1, 1, 0],\n      [1, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['i'] = {\n  color: '#b53120',\n  shapes: [\n    [\n      [1, 1, 1, 1],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0]\n    ],\n    [\n      [0, 1, 0, 0],\n      [0, 1, 0, 0],\n      [0, 1, 0, 0],\n      [0, 1, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['w'] = {\n  color: '#ffdd00',\n  shapes: [\n    [\n      [1, 1, 0, 0],\n      [0, 1, 1, 0],\n      [0, 0, 1, 1],\n      [0, 0, 0, 1]\n    ],\n    [\n      [0, 0, 0, 1],\n      [0, 0, 1, 1],\n      [0, 1, 1, 0],\n      [1, 1, 0, 0]\n    ],\n    [\n      [1, 0, 0, 0],\n      [1, 1, 0, 0],\n      [0, 1, 1, 0],\n      [0, 0, 1, 1]\n    ],\n    [\n      [0, 0, 1, 1],\n      [0, 1, 1, 0],\n      [1, 1, 0, 0],\n      [1, 0, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['o'] = {\n  color: '#04a0fb',\n  shapes: [\n    [\n      [0, 1, 1, 0],\n      [1, 0, 0, 1],\n      [0, 1, 1, 0],\n      [0, 0, 0, 0]\n    ],\n    [\n      [0, 1, 0, 0],\n      [1, 0, 1, 0],\n      [1, 0, 1, 0],\n      [0, 1, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['ii'] = {\n  color: '#ec1346',\n  shapes: [\n    [\n      [1, 0, 0, 1],\n      [0, 0, 0, 0],\n      [0, 0, 0, 0],\n      [1, 0, 0, 1]\n    ],\n    [\n      [1, 0, 1, 0],\n      [0, 0, 0, 0],\n      [1, 0, 1, 0],\n      [0, 0, 0, 0]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nPiecesShapes['ca'] = {\n  color: '#ec1346',\n  shapes: [\n    [\n      [1, 1, 0],\n      [1, 0, 0],\n      [1, 1, 0]\n    ],\n    [\n      [1, 1, 1],\n      [1, 0, 1],\n      [0, 0, 0]\n    ],\n    [\n      [0, 1, 1],\n      [0, 0, 1],\n      [0, 1, 1]\n    ],\n    [\n      [0, 0, 0],\n      [1, 0, 1],\n      [1, 1, 1]\n    ]\n  ],\n  offset: [1, 0]\n}\n\nfunction Piece (type, options) {\n  this.initialize = function (type) {\n    // pieces first Y then X\n    this.options = {\n      hard: false\n    }\n    Object.assign(this.options, options)\n\n    var piece\n    if (type) {\n      piece = PiecesShapes[type]\n    }\n    if (!piece) {\n      if (this.options.hard) {\n        type = FisherYatesShuffle(['w', 'o', 'ii', 'ca'])[0]\n      } else {\n        type = FisherYatesShuffle(['c', 's', 'is', 'i', 'l', 'il', 't'])[0]\n      }\n      piece = PiecesShapes[type]\n    }\n    this.type = type\n    this.color = piece.color\n    this.shapes = piece.shapes\n    this.offset = piece.offset\n    this.shapeIndex = 0\n  }\n\n  this.rotateClockwise = function () {\n    this.shapeIndex += 1\n    this.shapeIndex = this.shapeIndex >= this.shapes.length ? 0 : this.shapeIndex\n  }\n\n  this.rotateCounterClockwise = function () {\n    this.shapeIndex -= 1\n    this.shapeIndex = this.shapeIndex < 0 ? this.shapes.length - 1 : this.shapeIndex\n  }\n\n  this.draw = function (groundObject, pos) {\n    // this updates all the blocks on the groundObject to draw the piece\n    return this.placeOnGround(groundObject, pos, 'draw')\n  }\n  this.collide = function (groundObject, pos) {\n    // check if the piece collides with the ground at position\n    return this.placeOnGround(groundObject, pos, 'collide')\n  }\n  this.outside = function (groundObject, pos) {\n    // check if the piece is outside the ground are\n    return this.placeOnGround(groundObject, pos, 'outside')\n  }\n  this.placeOnGround = function (groundObject, pos, method) {\n    // method could be one of \"draw\", \"collide\", \"outside\"\n    // draw will update the blocks on the ground based on the piece position\n    // collide will check if the piece collides with the ground\n    // outside will check if the piece if outside the ground area\n    var ground = groundObject.ground\n    // the shape of the piece\n    var pattern = this.shapes[this.shapeIndex]\n    var block = null\n    function shouldDrawALine (p, y, x) {\n      // this returns if a line should be painted on the side of the rectangle pixel\n      if (p[y] && p[y][x]) {\n        return 1 - p[y][x]\n      }\n      return 1\n    }\n    for (var y = 0; y < pattern.length; y++) {\n      for (var x = 0; x < pattern[y].length; x++) {\n        if (pattern[y][x] === 1) {\n          try {\n            let xground = x + pos[0] - this.offset[0]\n            let yground = y + pos[1] - this.offset[1]\n            block = ground[xground][yground]\n          } catch (e) {\n            block = null\n          }\n\n          // test collide\n          if (method === 'collide' && block && !block.empty) {\n            return true\n          } else if (method === 'draw' && block) {\n            block.setColor(this.color)\n            block.empty = false\n            block.lines = [\n              shouldDrawALine(pattern, y - 1, x),\n              shouldDrawALine(pattern, y, x + 1),\n              shouldDrawALine(pattern, y + 1, x),\n              shouldDrawALine(pattern, y, x - 1)\n            ]\n          } else if (method === 'outside' && block == null) {\n            return true\n          }\n        }\n      }\n    }\n    if (method === 'collide' || method === 'outside') {\n      return false\n    }\n  }\n\n  this.initialize()\n}\n\nexport default Piece\n","import {changeColorLuminance} from './helpers'\n\nconst TOP_LINE = 1\nconst RIGHT_LINE = 2\nconst BOTTOM_LINE = 4\nconst LEFT_LINE = 8\nconst ALL_LINES = TOP_LINE + RIGHT_LINE + BOTTOM_LINE + LEFT_LINE\n\nfunction toLines (points) {\n  var lines = []\n  for (let index = 0; index < points.length - 1; index++) {\n    lines.push(\n      [points[index], points[index + 1]]\n    )\n  }\n  return lines\n}\n\nfunction drawBlock (drawable, data) {\n  let roughCanvas = drawable.roughCanvas\n  // draw the block\n  var margin = data.size * 0.1\n  var left = data.x\n  var right = data.x + data.size\n  var top = data.y\n  var bottom = data.y + data.size\n  /*\n  Block diagram from drawing margins\n\n  ##b##c##\n  ##-##-##\n  e-f##g-h\n  ########\n  ########\n  i-j##k-l\n  ##-##-##\n  ##n##o##\n\n  */\n  var b = [left + margin, top]\n  var c = [right - margin, top]\n\n  var e = [left, top + margin]\n  var f = [left + margin, top + margin]\n  var g = [right - margin, top + margin]\n  var h = [right, top + margin]\n\n  var i = [left, bottom - margin]\n  var j = [left + margin, bottom - margin]\n  var k = [right - margin, bottom - margin]\n  var l = [right, bottom - margin]\n\n  var n = [left + margin, bottom]\n  var o = [right - margin, bottom]\n\n  var topLeftPoints = [e, f, b]\n  var topRightPoints = [c, g, h]\n  var bottomRightPoints = [l, k, o]\n  var bottomLeftPoints = [n, j, i]\n\n  var topPoints = [e, h]\n  var rightPoints = [c, o]\n  var bottomPoints = [l, i]\n  var leftPoints = [n, b]\n\n  var lines = []\n  var points = []\n  var hachureAngle = 45\n\n  switch (data.lines) {\n    case ALL_LINES:\n      points = [f, g, k, j]\n      lines = [\n        [f, g], [g, k], [k, j], [j, f]\n      ]\n      hachureAngle = 0\n      break\n    case TOP_LINE + BOTTOM_LINE:\n      points = [e, h, l, i]\n      lines = [[e, h], [l, i]]\n      hachureAngle = 90\n      break\n    case LEFT_LINE + RIGHT_LINE:\n      points = [b, c, o, n]\n      lines = [[b, n], [c, o]]\n      hachureAngle = 0\n      break\n    case ALL_LINES - TOP_LINE:\n      points = [b, c, k, j]\n      lines = [\n        [c, k], [k, j], [j, b]\n      ]\n      hachureAngle = 0\n      break\n    case ALL_LINES - RIGHT_LINE:\n      points = [f, h, l, j]\n      lines = [\n        [f, h], [l, j], [j, f]\n      ]\n      hachureAngle = 90\n      break\n    case ALL_LINES - BOTTOM_LINE:\n      points = [f, g, o, n]\n      lines = [\n        [f, g], [g, o], [n, f]\n      ]\n      hachureAngle = 0\n      break\n    case ALL_LINES - LEFT_LINE:\n      points = [e, g, k, i]\n      lines = [\n        [e, g], [g, k], [k, i]\n      ]\n      hachureAngle = 90\n      break\n    case LEFT_LINE + BOTTOM_LINE:\n      hachureAngle = 45\n      points = [j, b, c, g, h, l]\n      lines = [[c, g], [g, h], [l, j], [j, b]]\n      break\n    case LEFT_LINE + TOP_LINE:\n      hachureAngle = -45\n      points = [f, h, l, k, o, n]\n      lines = [[f, h], [l, k], [k, o], [n, f]]\n      break\n    case RIGHT_LINE + BOTTOM_LINE:\n      hachureAngle = -45\n      points = [e, f, b, c, k, i]\n      lines = [[e, f], [f, b], [c, k], [k, i]]\n      break\n    case RIGHT_LINE + TOP_LINE:\n      hachureAngle = 45\n      points = [e, g, o, n, j, i]\n      lines = [[e, g], [g, o], [n, j], [j, i]]\n      break\n    case TOP_LINE:\n      points = topPoints.concat(bottomRightPoints).concat(bottomLeftPoints)\n      lines = [topPoints].concat(toLines(bottomRightPoints)).concat(toLines(bottomLeftPoints))\n      hachureAngle = 90\n      break\n    case RIGHT_LINE:\n      points = rightPoints.concat(bottomLeftPoints).concat(topLeftPoints)\n      lines = [rightPoints].concat(toLines(bottomLeftPoints)).concat(toLines(topLeftPoints))\n      hachureAngle = 0\n      break\n    case BOTTOM_LINE:\n      points = bottomPoints.concat(topLeftPoints).concat(topRightPoints)\n      lines = [bottomPoints].concat(toLines(topLeftPoints)).concat(toLines(topRightPoints))\n      hachureAngle = 90\n      break\n    case LEFT_LINE:\n      points = leftPoints.concat(topRightPoints).concat(bottomRightPoints)\n      lines = [leftPoints].concat(toLines(topRightPoints)).concat(toLines(bottomRightPoints))\n      hachureAngle = 0\n      break\n    case 0:\n      points = topLeftPoints.concat(topRightPoints).concat(bottomRightPoints).concat(bottomLeftPoints)\n      lines = [topLeftPoints].concat(toLines(topRightPoints)).concat(toLines(bottomRightPoints)).concat(toLines(bottomLeftPoints))\n      hachureAngle = 0\n      break\n  }\n\n  roughCanvas.polygon(points, {\n    hachureAngle: hachureAngle,\n    hachureGap: 4,\n    roughness: 1.8,\n    stroke: 'rgba(0,0,0,0.1)',\n    fill: data.color,\n    fillStyle: 'zigzag' // solid fill\n  })\n\n  var lineOptions = {\n    strokeWidth: data.size * 0.06,\n    stroke: data.strokeColor\n  }\n\n  lines.forEach(line => {\n    roughCanvas.line(line[0][0], line[0][1], line[1][0], line[1][1], lineOptions)\n  })\n}\n\nfunction Block (x, y, options) {\n  // this represents a single pixel from the tetris\n  this.draw = function (drawable, drawEmpty) {\n    if (this.empty) { return }\n    drawBlock(drawable, {\n      x: this.x,\n      y: this.y,\n      size: this.size,\n      color: this.color,\n      strokeColor: this.strokeColor,\n      lines: this.getLinesAsNumber()\n    })\n  }\n  this.drawOriginal = function (drawable, drawEmpty) {\n    let roughCanvas = drawable.roughCanvas\n    // drawEmpty lets you know if the empty cell show be painted or not\n    if (this.empty && !drawEmpty) { return }\n    // draw the block\n    roughCanvas.rectangle(this.x, this.y, this.size, this.size, {\n      hachureGap: 4,\n      roughness: 1.8,\n      stroke: 'rgba(0,0,0,0.1)',\n      fill: this.empty ? this.emptyColor : this.color,\n      fillStyle: 'zigzag' // solid fill\n    })\n    if (this.empty) { return }\n    // never draw lines on empty blocks\n    this.drawBlockLines(drawable)\n  }\n  this.drawBlockLines = function (drawable) {\n    var roughCanvas = drawable.roughCanvas\n    var offset = this.size * 0.12 // this will draw lines outside the block\n    var left = this.x\n    var top = this.y\n    var bottom = this.y + this.size\n    var right = this.x + this.size\n    // strokeWidth\n    var lineOptions = {\n      strokeWidth: this.size * 0.06,\n      stroke: this.strokeColor\n    }\n    // top line\n    if (this.lines[0] === 1) {\n      roughCanvas.line(left - offset, top, right + offset, top, lineOptions)\n    }\n    // right line\n    if (this.lines[1] === 1) {\n      roughCanvas.line(right, top - offset, right, bottom + offset, lineOptions)\n    }\n    // bottom line\n    if (this.lines[2] === 1) {\n      roughCanvas.line(left - offset, bottom, right + offset, bottom, lineOptions)\n    }\n    // left line\n    if (this.lines[3] === 1) {\n      roughCanvas.line(left, top - offset, left, bottom + offset, lineOptions)\n    }\n  }\n  this.setColor = function (color) {\n    this.color = color\n    // add transparency\n    this.strokeColor = changeColorLuminance(this.color, -0.7) + '80'\n  }\n\n  this.copyFrom = function (block) {\n    this.setColor(block.color)\n    this.empty = block.empty\n    this.lines[0] = block.lines[0]\n    this.lines[1] = block.lines[1]\n    this.lines[2] = block.lines[2]\n    this.lines[3] = block.lines[3]\n  }\n\n  this.setPos = function (x, y) {\n    this.x = x\n    this.y = y\n  }\n\n  this.setSize = function (size) {\n    this.size = size\n  }\n  this.getLinesAsNumber = function () {\n    return this.lines[0] * 1 +\n           this.lines[1] * 2 +\n           this.lines[2] * 4 +\n           this.lines[3] * 8\n  }\n\n  // initialization\n  this.options = {\n    size: 15,\n    emptyColor: '#1a1a1a',\n    color: '#1a1a1a'\n  }\n  Object.assign(this.options, options)\n\n  this.empty = true\n  this.emptyColor = this.options.emptyColor\n  this.setColor(this.options.color)\n  this.setSize(this.options.size)\n  this.setPos(x, y)\n  this.x = x\n  this.y = y\n  // top right bottom left\n  this.lines = [0, 0, 0, 0]\n}\n\nexport default Block\n","import Block from './block'\nimport {range} from './helpers'\n\nfunction Ground (groundWidth, groundHeight, blockSize) {\n  this.addRandomBottom = function (lines) {\n    // move the lines up so the random blocks don't endup\n    // overriden user made blocks\n    var w\n    var h\n    var b\n    for (w = 0; w < this.groundWidth; w++) {\n      for (h = 0; h < this.groundHeight; h++) {\n        if (this.ground[w][h + lines] != null) {\n          this.ground[w][h].copyFrom(this.ground[w][h + lines])\n        }\n      }\n    }\n    // add random bottom\n    for (w = 0; w < this.groundWidth; w++) {\n      for (h = this.groundHeight - lines; h < this.groundHeight; h++) {\n        b = this.ground[w][h]\n        b.setColor('#af5089')\n        if (Math.random() < 0.7) {\n          b.empty = false\n          b.lines = [1, 1, 1, 1]\n        } else {\n          b.empty = true\n        }\n      }\n    }\n  }\n\n  this.hide = function (options) {\n    // mark all the blocks as empty\n    this.mapGroundBlocks(function (w, h, block) {\n      block.empty = true\n    })\n  }\n\n  this.setBlockSize = function (size) {\n    this.blockSize = size\n    for (var w = 0; w < this.groundWidth; w++) {\n      for (var h = 0; h < this.groundHeight; h++) {\n        // change the size of the block\n        this.ground[w][h].setSize(this.blockSize)\n        // reposition the block inside the canvas\n        this.ground[w][h].setPos(\n          w * this.blockSize,\n          h * this.blockSize\n        )\n      }\n    }\n  }\n\n  this.meld = function (size) {\n    // remove lines inside continous blocks\n    function shouldDrawALine (ground, block, y, x) {\n      if (ground[x] && ground[x][y]) {\n        if (ground[x][y].empty) {\n          return 1 // draw a line\n        } else {\n          // if the block is not empty\n          // then check if is the same color\n          // and draw a line if not the same\n          return ground[x][y].color === block.color ? 0 : 1\n        }\n      } else {\n        // outside the ground area, always draw a line\n        return 1\n      }\n    }\n\n    for (var w = 0; w < this.groundWidth; w++) {\n      for (var h = 0; h < this.groundHeight; h++) {\n        var block = this.ground[w][h]\n        this.ground[w][h].lines = [\n          shouldDrawALine(this.ground, block, h - 1, w), // top\n          shouldDrawALine(this.ground, block, h, w + 1), // right\n          shouldDrawALine(this.ground, block, h + 1, w), // bottom\n          shouldDrawALine(this.ground, block, h, w - 1) // left\n        ]\n      }\n    }\n  }\n\n  this.mapGroundBlocks = function (callback) {\n    for (var w = 0; w < this.groundWidth; w++) {\n      for (var h = 0; h < this.groundHeight; h++) {\n        callback(w, h, this.ground[w][h], this.ground)\n      }\n    }\n  }\n\n  this.ended = function () {\n    for (var w = 0; w < this.groundWidth; w++) {\n      if (!this.ground[w][1].empty || !this.ground[w][1].empty) {\n        return true\n      }\n    }\n    return false\n  }\n\n  this.getCompletedLines = function () {\n    // returns the line number of lines with non empty block from side to side\n    var completedLines = []\n    var complete = 0\n    for (var h = 0; h < this.groundHeight; h++) {\n      complete = 0\n      for (var w = 0; w < this.groundWidth; w++) {\n        if (!this.ground[w][h].empty) {\n          complete += 1\n        }\n      }\n      if (complete === this.groundWidth) {\n        completedLines.push(h)\n      }\n    }\n    return completedLines\n  }\n\n  this.removeLine = function (line) {\n    for (var w = 0; w < this.groundWidth; w++) {\n      for (var h = 0; h < this.groundHeight; h++) {\n        if (h === line) {\n          // remove line\n          for (var ht = h; ht > 0; ht--) {\n            this.ground[w][ht].copyFrom(this.ground[w][ht - 1])\n          }\n          this.ground[w][h].lines[2] = 1\n          if (this.ground[w][h + 1]) {\n            this.ground[w][h + 1].lines[0] = 1\n          }\n        }\n      }\n    }\n  }\n\n  this.removeLines = function (lines) {\n    for (var i = 0; i < lines.length; i++) {\n      this.removeLine(lines[i])\n    }\n  }\n  this.drawGrid = function (drawable) {\n    let roughCanvas = drawable.roughCanvas\n    let options = {\n      stroke: 'rgb(0, 0, 0, 0.5)',\n      strokeWidth: this.blockSize / 10,\n      bowing: 0.6\n    }\n    let gridOptions = {\n      roughness: 0.6,\n      stroke: 'rgb(203, 255, 241, 0.7)',\n      strokeWidth: this.blockSize / 40\n    }\n    let top = 0\n    let bottom = this.groundHeight * this.blockSize\n    let left = 0\n    let right = this.groundWidth * this.blockSize\n    range(left, right, this.blockSize).map((position) => {\n      // vertical lines\n      roughCanvas.line(\n        position, bottom,\n        position, top,\n        gridOptions\n      )\n    })\n    range(top, bottom, this.blockSize).map((position) => {\n      // horizontal lines\n      roughCanvas.line(\n        left, position,\n        right, position,\n        gridOptions\n      )\n    })\n    // top left > top right\n    roughCanvas.line(\n      left, top,\n      right, top,\n      options\n    )\n    // top right > bottom right\n    roughCanvas.line(\n      right, top,\n      right, bottom,\n      options\n    )\n    // bottom right > bottom left\n    roughCanvas.line(\n      right, bottom,\n      left, bottom,\n      options\n    )\n    // bottom left > top left\n    roughCanvas.line(\n      left, bottom,\n      left, top,\n      options\n    )\n  }\n\n  this.groundWidth = groundWidth\n  this.groundHeight = groundHeight\n  this.blockSize = blockSize\n  this.blocks = []\n  this.ground = []\n\n  // Init\n  var b\n  var col = []\n  for (var w = 0; w < this.groundWidth; w++) {\n    col = []\n    for (var h = 0; h < this.groundHeight; h++) {\n      b = new Block(\n        w * this.blockSize,\n        h * this.blockSize,\n        {\n          size: blockSize\n        }\n      )\n      col.push(b)\n      this.blocks.push(b)\n    }\n    this.ground.push(col)\n  }\n}\n\nexport default Ground\n","import Piece from './piece'\nimport Ground from './ground'\n\nfunction Tetris (options) {\n  // initialize\n  this.initialize = function () {\n    this.options = {\n      width: 100,\n      height: 100,\n      groundWidth: 10,\n      groundHeight: 22,\n      drawableBackground: null,\n      drawablePieces: null\n    }\n    Object.assign(this.options, options)\n    this.blockSize = 20\n    this.options.width = this.options.groundWidth * this.blockSize\n    this.newPiecePosition = [\n      parseInt(this.options.groundWidth / 2) - 1, 0\n    ]\n    this.ground = new Ground(\n      this.options.groundWidth,\n      this.options.groundHeight,\n      this.blockSize\n    )\n    this.currentPieceGround = new Ground(\n      this.options.groundWidth,\n      this.options.groundHeight,\n      this.blockSize\n    )\n    this.reset()\n  }\n\n  this.reset = function () {\n    this.ground.hide()\n    this.currentPieceGround.hide()\n    this.ended = false\n    this.count = {\n      pieces: 0,\n      lines: 0,\n      linesCount: {\n        1: 0,\n        2: 0,\n        3: 0,\n        4: 0\n      },\n      speed: 0\n    }\n    this.piecePosition = [\n      this.newPiecePosition[0],\n      this.newPiecePosition[1]\n    ]\n    this.piece = new Piece()\n    this.nextPiece = new Piece()\n    this.groundDirty = true\n    this.currentPieceGroundDirty = true\n  }\n\n  this.serialize = function (previousUpdate) {\n    var serializedGround = []\n    for (let w = 0; w < this.ground.groundWidth; w++) {\n      for (let h = 0; h < this.ground.groundHeight; h++) {\n        var cpb = this.currentPieceGround.ground[w][h]\n        var b = this.ground.ground[w][h]\n        var blockToPush = null\n        if (b.empty && !cpb.empty) {\n          blockToPush = cpb\n        } else if (!b.empty && cpb.empty) {\n          blockToPush = b\n        }\n        if (blockToPush) {\n          serializedGround.push([\n            (w << 6) + h,\n            parseInt(blockToPush.color.replace('#', '0x')),\n            blockToPush.lines[0] * 1 +\n            blockToPush.lines[1] * 2 +\n            blockToPush.lines[2] * 4 +\n            blockToPush.lines[3] * 8\n          ])\n        } else {\n          serializedGround.push([(w << 6) + h])\n        }\n      }\n    }\n    return serializedGround\n  }\n\n  this.loadSerializedData = function (data) {\n    data.map((e) => {\n      var h = e[0] & 63\n      var w = e[0] >> 6 & 63\n      if (!e[1]) {\n        this.ground.ground[w][h].empty = true\n      } else {\n        this.ground.ground[w][h].empty = false\n        this.ground.ground[w][h].setColor('#' + ('000000' + (e[1]).toString(16)).slice(-6))\n        this.ground.ground[w][h].lines = [\n          e[2] & 1,\n          e[2] >> 1 & 1,\n          e[2] >> 2 & 1,\n          e[2] >> 3 & 1\n        ]\n      }\n    })\n    this.currentPieceGroundDirty = true\n    this.groundDirty = true\n    this.draw()\n  }\n\n  this.drawPieceGround = function () {\n    this.options.drawablePieces.clear()\n    this.currentPieceGround.mapGroundBlocks(function (x, y, block) {\n      block.draw(this.options.drawablePieces)\n    }.bind(this))\n    this.currentPieceGroundDirty = false\n  }\n\n  this.drawGround = function () {\n    this.options.drawableBackground.clear()\n    this.ground.drawGrid(this.options.drawableBackground)\n    this.ground.mapGroundBlocks(function (x, y, block) {\n      block.draw(this.options.drawableBackground)\n    }.bind(this))\n    this.groundDirty = false\n  }\n\n  this.draw = function () {\n    if (this.currentPieceGroundDirty) { this.drawPieceGround() }\n    if (this.groundDirty) { this.drawGround() }\n  }\n\n  this.rotatePiece = function (action, reverseAction) {\n    this.piece[action]()\n    var tmpPos = [this.piecePosition[0], this.piecePosition[1]]\n    if (this.piece.collide(this.ground, this.piecePosition) || this.piece.outside(this.ground, this.piecePosition)) {\n      // test moving left\n      tmpPos = [ this.piecePosition[0] - 1, this.piecePosition[1] ]\n      if (this.piece.collide(this.ground, tmpPos) || this.piece.outside(this.ground, tmpPos)) {\n        // test moving right\n        tmpPos = [ this.piecePosition[0] + 1, this.piecePosition[1] ]\n        if (this.piece.collide(this.ground, tmpPos) || this.piece.outside(this.ground, tmpPos)) {\n        // un able to move , undo\n          this.piece[reverseAction]()\n          return\n        }\n      }\n    }\n    this.piecePosition = tmpPos\n    this.currentPieceGroundDirty = true\n    this.currentPieceGround.hide()\n    this.piece.draw(this.currentPieceGround, this.piecePosition)\n  }\n\n  this.rotatePieceClockwise = function () {\n    this.rotatePiece('rotateClockwise', 'rotateCounterClockwise')\n  }\n\n  this.rotatePieceCounterClockwise = function () {\n    this.rotatePiece('rotateCounterClockwise', 'rotateClockwise')\n  }\n\n  this.pieceMove = function (offsetX) {\n    var newPos = [\n      this.piecePosition[0] + offsetX,\n      this.piecePosition[1]\n    ]\n    if (this.piece.collide(this.ground, newPos) || this.piece.outside(this.ground, newPos)) {\n      // collision nothing to do\n    } else {\n      this.piecePosition = newPos\n      this.currentPieceGroundDirty = true\n      this.currentPieceGround.hide()\n      this.piece.draw(this.currentPieceGround, this.piecePosition)\n    }\n  }\n\n  this.pieceMoveLeft = function () {\n    this.pieceMove(-1)\n  }\n\n  this.pieceMoveRight = function () {\n    this.pieceMove(1)\n  }\n\n  this.pieceMoveDown = function (options) {\n    if (this.ended) { return }\n    var args = {}\n    Object.assign(args, {\n      auto: false\n    }, options)\n    this.piecePosition[1] += 1\n    if (this.piece.collide(this.ground, this.piecePosition) || this.piece.outside(this.ground, this.piecePosition)) {\n      // after moving the piece down it collided so move it up and add a new one at the top\n      this.piecePosition[1] -= 1\n      this.piece.draw(this.ground, this.piecePosition)\n      this.piecePosition = [this.newPiecePosition[0], this.newPiecePosition[1]]\n      this.piece = this.nextPiece\n      this.nextPiece = new Piece()\n      var l = this.ground.getCompletedLines()\n      if (l.length > 0) {\n        this.count.linesCount[l.length] += 1\n        this.linesRemovedCallback(this, l)\n      }\n      this.count.lines += l.length\n      this.count.pieces += 1\n      this.newPieceCallback(this, this.piece, this.nextPiece, l)\n      this.ground.removeLines(l)\n      if (this.ground.ended()) {\n        this.ended = true\n        // when the game ends grey out all the pieces\n        this.ground.mapGroundBlocks(function (x, y, b) {\n          b.setColor('#777777')\n        })\n        this.gameEndedCallback(this)\n      }\n      this.ground.meld()\n      this.groundDirty = true\n    }\n    if (!args.auto) {\n      this.count.speed += 1\n    }\n    this.currentPieceGround.hide()\n    this.piece.draw(this.currentPieceGround, this.piecePosition)\n    this.currentPieceGroundDirty = true\n  }\n\n  // Methods\n  this.resize = function (blockSize) {\n    this.blockSize = blockSize\n    this.ground.setBlockSize(this.blockSize)\n    this.currentPieceGround.setBlockSize(this.blockSize)\n    this.groundDirty = true\n    this.currentPieceGroundDirty = true\n  }\n\n  this.getPoints = function () {\n    return (\n      this.count.linesCount[1] * 10 +\n      this.count.linesCount[2] * 20 +\n      this.count.linesCount[3] * 45 +\n      this.count.linesCount[4] * 70 +\n      this.count.pieces * 3 +\n      this.count.speed * 8\n    )\n  }\n\n  // punishments\n  this.makeNextPieceHardOne = function () {\n    this.nextPiece = new Piece(null, {\n      hard: true\n    })\n  }\n\n  this.addRandomBottom = function (numberOfLines) {\n    if (numberOfLines === undefined) {\n      numberOfLines = Math.ceil(Math.random() * 4)\n    }\n    this.ground.addRandomBottom(numberOfLines)\n    this.groundDirty = true\n  }\n\n  // callbacks\n  this.linesRemovedCallback = function (tetris, lines) {\n  }\n\n  this.gameEndedCallback = function (tetris) {\n  }\n\n  this.newPieceCallback = function (tetris, currentPiece, nextPiece, lines) {\n  }\n\n  this.initialize()\n}\n\nexport default Tetris\n","function isType(token, type) {\n    return token.type === type;\n}\nconst PARAMS = {\n    A: 7,\n    a: 7,\n    C: 6,\n    c: 6,\n    H: 1,\n    h: 1,\n    L: 2,\n    l: 2,\n    M: 2,\n    m: 2,\n    Q: 4,\n    q: 4,\n    S: 4,\n    s: 4,\n    T: 4,\n    t: 2,\n    V: 1,\n    v: 1,\n    Z: 0,\n    z: 0\n};\nclass ParsedPath {\n    constructor(d) {\n        this.COMMAND = 0;\n        this.NUMBER = 1;\n        this.EOD = 2;\n        this.segments = [];\n        this.parseData(d);\n        this.processPoints();\n    }\n    tokenize(d) {\n        const tokens = new Array();\n        while (d !== '') {\n            if (d.match(/^([ \\t\\r\\n,]+)/)) {\n                d = d.substr(RegExp.$1.length);\n            }\n            else if (d.match(/^([aAcChHlLmMqQsStTvVzZ])/)) {\n                tokens[tokens.length] = { type: this.COMMAND, text: RegExp.$1 };\n                d = d.substr(RegExp.$1.length);\n            }\n            else if (d.match(/^(([-+]?[0-9]+(\\.[0-9]*)?|[-+]?\\.[0-9]+)([eE][-+]?[0-9]+)?)/)) {\n                tokens[tokens.length] = { type: this.NUMBER, text: `${parseFloat(RegExp.$1)}` };\n                d = d.substr(RegExp.$1.length);\n            }\n            else {\n                console.error('Unrecognized segment command: ' + d);\n                return [];\n            }\n        }\n        tokens[tokens.length] = { type: this.EOD, text: '' };\n        return tokens;\n    }\n    parseData(d) {\n        const tokens = this.tokenize(d);\n        let index = 0;\n        let token = tokens[index];\n        let mode = 'BOD';\n        this.segments = new Array();\n        while (!isType(token, this.EOD)) {\n            let param_length;\n            const params = new Array();\n            if (mode === 'BOD') {\n                if (token.text === 'M' || token.text === 'm') {\n                    index++;\n                    param_length = PARAMS[token.text];\n                    mode = token.text;\n                }\n                else {\n                    this.parseData('M0,0' + d);\n                    return;\n                }\n            }\n            else {\n                if (isType(token, this.NUMBER)) {\n                    param_length = PARAMS[mode];\n                }\n                else {\n                    index++;\n                    param_length = PARAMS[token.text];\n                    mode = token.text;\n                }\n            }\n            if ((index + param_length) < tokens.length) {\n                for (let i = index; i < index + param_length; i++) {\n                    const numbeToken = tokens[i];\n                    if (isType(numbeToken, this.NUMBER)) {\n                        params[params.length] = +numbeToken.text;\n                    }\n                    else {\n                        console.error('Parameter type is not a number: ' + mode + ',' + numbeToken.text);\n                        return;\n                    }\n                }\n                if (typeof PARAMS[mode] === 'number') {\n                    const segment = { key: mode, data: params };\n                    this.segments.push(segment);\n                    index += param_length;\n                    token = tokens[index];\n                    if (mode === 'M')\n                        mode = 'L';\n                    if (mode === 'm')\n                        mode = 'l';\n                }\n                else {\n                    console.error('Unsupported segment type: ' + mode);\n                    return;\n                }\n            }\n            else {\n                console.error('Path data ended before all parameters were found');\n            }\n        }\n    }\n    get closed() {\n        if (typeof this._closed === 'undefined') {\n            this._closed = false;\n            for (const s of this.segments) {\n                if (s.key.toLowerCase() === 'z') {\n                    this._closed = true;\n                }\n            }\n        }\n        return this._closed;\n    }\n    processPoints() {\n        let first = null;\n        let currentPoint = [0, 0];\n        for (let i = 0; i < this.segments.length; i++) {\n            const s = this.segments[i];\n            switch (s.key) {\n                case 'M':\n                case 'L':\n                case 'T':\n                    s.point = [s.data[0], s.data[1]];\n                    break;\n                case 'm':\n                case 'l':\n                case 't':\n                    s.point = [s.data[0] + currentPoint[0], s.data[1] + currentPoint[1]];\n                    break;\n                case 'H':\n                    s.point = [s.data[0], currentPoint[1]];\n                    break;\n                case 'h':\n                    s.point = [s.data[0] + currentPoint[0], currentPoint[1]];\n                    break;\n                case 'V':\n                    s.point = [currentPoint[0], s.data[0]];\n                    break;\n                case 'v':\n                    s.point = [currentPoint[0], s.data[0] + currentPoint[1]];\n                    break;\n                case 'z':\n                case 'Z':\n                    if (first) {\n                        s.point = [first[0], first[1]];\n                    }\n                    break;\n                case 'C':\n                    s.point = [s.data[4], s.data[5]];\n                    break;\n                case 'c':\n                    s.point = [s.data[4] + currentPoint[0], s.data[5] + currentPoint[1]];\n                    break;\n                case 'S':\n                    s.point = [s.data[2], s.data[3]];\n                    break;\n                case 's':\n                    s.point = [s.data[2] + currentPoint[0], s.data[3] + currentPoint[1]];\n                    break;\n                case 'Q':\n                    s.point = [s.data[2], s.data[3]];\n                    break;\n                case 'q':\n                    s.point = [s.data[2] + currentPoint[0], s.data[3] + currentPoint[1]];\n                    break;\n                case 'A':\n                    s.point = [s.data[5], s.data[6]];\n                    break;\n                case 'a':\n                    s.point = [s.data[5] + currentPoint[0], s.data[6] + currentPoint[1]];\n                    break;\n            }\n            if (s.key === 'm' || s.key === 'M') {\n                first = null;\n            }\n            if (s.point) {\n                currentPoint = s.point;\n                if (!first) {\n                    first = s.point;\n                }\n            }\n            if (s.key === 'z' || s.key === 'Z') {\n                first = null;\n            }\n        }\n    }\n}\nexport class RoughPath {\n    constructor(d) {\n        this._position = [0, 0];\n        this._first = null;\n        this.bezierReflectionPoint = null;\n        this.quadReflectionPoint = null;\n        this.parsed = new ParsedPath(d);\n    }\n    get segments() {\n        return this.parsed.segments;\n    }\n    get closed() {\n        return this.parsed.closed;\n    }\n    get linearPoints() {\n        if (!this._linearPoints) {\n            const lp = [];\n            let points = [];\n            for (const s of this.parsed.segments) {\n                const key = s.key.toLowerCase();\n                if (key === 'm' || key === 'z') {\n                    if (points.length) {\n                        lp.push(points);\n                        points = [];\n                    }\n                    if (key === 'z') {\n                        continue;\n                    }\n                }\n                if (s.point) {\n                    points.push(s.point);\n                }\n            }\n            if (points.length) {\n                lp.push(points);\n                points = [];\n            }\n            this._linearPoints = lp;\n        }\n        return this._linearPoints;\n    }\n    get first() {\n        return this._first;\n    }\n    set first(v) {\n        this._first = v;\n    }\n    setPosition(x, y) {\n        this._position = [x, y];\n        if (!this._first) {\n            this._first = [x, y];\n        }\n    }\n    get position() {\n        return this._position;\n    }\n    get x() {\n        return this._position[0];\n    }\n    get y() {\n        return this._position[1];\n    }\n}\n// Algorithm as described in https://www.w3.org/TR/SVG/implnote.html\n// Code adapted from nsSVGPathDataParser.cpp in Mozilla \n// https://hg.mozilla.org/mozilla-central/file/17156fbebbc8/content/svg/content/src/nsSVGPathDataParser.cpp#l887\nexport class RoughArcConverter {\n    constructor(from, to, radii, angle, largeArcFlag, sweepFlag) {\n        this._segIndex = 0;\n        this._numSegs = 0;\n        this._rx = 0;\n        this._ry = 0;\n        this._sinPhi = 0;\n        this._cosPhi = 0;\n        this._C = [0, 0];\n        this._theta = 0;\n        this._delta = 0;\n        this._T = 0;\n        this._from = from;\n        if (from[0] === to[0] && from[1] === to[1]) {\n            return;\n        }\n        const radPerDeg = Math.PI / 180;\n        this._rx = Math.abs(radii[0]);\n        this._ry = Math.abs(radii[1]);\n        this._sinPhi = Math.sin(angle * radPerDeg);\n        this._cosPhi = Math.cos(angle * radPerDeg);\n        const x1dash = this._cosPhi * (from[0] - to[0]) / 2.0 + this._sinPhi * (from[1] - to[1]) / 2.0;\n        const y1dash = -this._sinPhi * (from[0] - to[0]) / 2.0 + this._cosPhi * (from[1] - to[1]) / 2.0;\n        let root = 0;\n        const numerator = this._rx * this._rx * this._ry * this._ry - this._rx * this._rx * y1dash * y1dash - this._ry * this._ry * x1dash * x1dash;\n        if (numerator < 0) {\n            const s = Math.sqrt(1 - (numerator / (this._rx * this._rx * this._ry * this._ry)));\n            this._rx = this._rx * s;\n            this._ry = this._ry * s;\n            root = 0;\n        }\n        else {\n            root = (largeArcFlag === sweepFlag ? -1.0 : 1.0) *\n                Math.sqrt(numerator / (this._rx * this._rx * y1dash * y1dash + this._ry * this._ry * x1dash * x1dash));\n        }\n        const cxdash = root * this._rx * y1dash / this._ry;\n        const cydash = -root * this._ry * x1dash / this._rx;\n        this._C = [0, 0];\n        this._C[0] = this._cosPhi * cxdash - this._sinPhi * cydash + (from[0] + to[0]) / 2.0;\n        this._C[1] = this._sinPhi * cxdash + this._cosPhi * cydash + (from[1] + to[1]) / 2.0;\n        this._theta = this.calculateVectorAngle(1.0, 0.0, (x1dash - cxdash) / this._rx, (y1dash - cydash) / this._ry);\n        let dtheta = this.calculateVectorAngle((x1dash - cxdash) / this._rx, (y1dash - cydash) / this._ry, (-x1dash - cxdash) / this._rx, (-y1dash - cydash) / this._ry);\n        if ((!sweepFlag) && (dtheta > 0)) {\n            dtheta -= 2 * Math.PI;\n        }\n        else if (sweepFlag && (dtheta < 0)) {\n            dtheta += 2 * Math.PI;\n        }\n        this._numSegs = Math.ceil(Math.abs(dtheta / (Math.PI / 2)));\n        this._delta = dtheta / this._numSegs;\n        this._T = (8 / 3) * Math.sin(this._delta / 4) * Math.sin(this._delta / 4) / Math.sin(this._delta / 2);\n    }\n    getNextSegment() {\n        if (this._segIndex === this._numSegs) {\n            return null;\n        }\n        const cosTheta1 = Math.cos(this._theta);\n        const sinTheta1 = Math.sin(this._theta);\n        const theta2 = this._theta + this._delta;\n        const cosTheta2 = Math.cos(theta2);\n        const sinTheta2 = Math.sin(theta2);\n        const to = [\n            this._cosPhi * this._rx * cosTheta2 - this._sinPhi * this._ry * sinTheta2 + this._C[0],\n            this._sinPhi * this._rx * cosTheta2 + this._cosPhi * this._ry * sinTheta2 + this._C[1]\n        ];\n        const cp1 = [\n            this._from[0] + this._T * (-this._cosPhi * this._rx * sinTheta1 - this._sinPhi * this._ry * cosTheta1),\n            this._from[1] + this._T * (-this._sinPhi * this._rx * sinTheta1 + this._cosPhi * this._ry * cosTheta1)\n        ];\n        const cp2 = [\n            to[0] + this._T * (this._cosPhi * this._rx * sinTheta2 + this._sinPhi * this._ry * cosTheta2),\n            to[1] + this._T * (this._sinPhi * this._rx * sinTheta2 - this._cosPhi * this._ry * cosTheta2)\n        ];\n        this._theta = theta2;\n        this._from = [to[0], to[1]];\n        this._segIndex++;\n        return {\n            cp1: cp1,\n            cp2: cp2,\n            to: to\n        };\n    }\n    calculateVectorAngle(ux, uy, vx, vy) {\n        const ta = Math.atan2(uy, ux);\n        const tb = Math.atan2(vy, vx);\n        if (tb >= ta)\n            return tb - ta;\n        return 2 * Math.PI - (ta - tb);\n    }\n}\nexport class PathFitter {\n    constructor(sets, closed) {\n        this.sets = sets;\n        this.closed = closed;\n    }\n    fit(simplification) {\n        const outSets = [];\n        for (const set of this.sets) {\n            const length = set.length;\n            let estLength = Math.floor(simplification * length);\n            if (estLength < 5) {\n                if (length <= 5) {\n                    continue;\n                }\n                estLength = 5;\n            }\n            outSets.push(this.reduce(set, estLength));\n        }\n        let d = '';\n        for (const set of outSets) {\n            for (let i = 0; i < set.length; i++) {\n                const point = set[i];\n                if (i === 0) {\n                    d += 'M' + point[0] + ',' + point[1];\n                }\n                else {\n                    d += 'L' + point[0] + ',' + point[1];\n                }\n            }\n            if (this.closed) {\n                d += 'z ';\n            }\n        }\n        return d;\n    }\n    distance(p1, p2) {\n        return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n    }\n    reduce(set, count) {\n        if (set.length <= count) {\n            return set;\n        }\n        const points = set.slice(0);\n        while (points.length > count) {\n            const areas = [];\n            let minArea = -1;\n            let minIndex = -1;\n            for (let i = 1; i < (points.length - 1); i++) {\n                const a = this.distance(points[i - 1], points[i]);\n                const b = this.distance(points[i], points[i + 1]);\n                const c = this.distance(points[i - 1], points[i + 1]);\n                const s = (a + b + c) / 2.0;\n                const area = Math.sqrt(s * (s - a) * (s - b) * (s - c));\n                areas.push(area);\n                if ((minArea < 0) || (area < minArea)) {\n                    minArea = area;\n                    minIndex = i;\n                }\n            }\n            if (minIndex > 0) {\n                points.splice(minIndex, 1);\n            }\n            else {\n                break;\n            }\n        }\n        return points;\n    }\n}\n","export class Segment {\n    constructor(p1, p2) {\n        this.xi = Number.MAX_VALUE;\n        this.yi = Number.MAX_VALUE;\n        this.px1 = p1[0];\n        this.py1 = p1[1];\n        this.px2 = p2[0];\n        this.py2 = p2[1];\n        this.a = this.py2 - this.py1;\n        this.b = this.px1 - this.px2;\n        this.c = this.px2 * this.py1 - this.px1 * this.py2;\n        this._undefined = ((this.a === 0) && (this.b === 0) && (this.c === 0));\n    }\n    isUndefined() {\n        return this._undefined;\n    }\n    intersects(otherSegment) {\n        if (this.isUndefined() || otherSegment.isUndefined()) {\n            return false;\n        }\n        let grad1 = Number.MAX_VALUE;\n        let grad2 = Number.MAX_VALUE;\n        let int1 = 0, int2 = 0;\n        const a = this.a, b = this.b, c = this.c;\n        if (Math.abs(b) > 0.00001) {\n            grad1 = -a / b;\n            int1 = -c / b;\n        }\n        if (Math.abs(otherSegment.b) > 0.00001) {\n            grad2 = -otherSegment.a / otherSegment.b;\n            int2 = -otherSegment.c / otherSegment.b;\n        }\n        if (grad1 === Number.MAX_VALUE) {\n            if (grad2 === Number.MAX_VALUE) {\n                if ((-c / a) !== (-otherSegment.c / otherSegment.a)) {\n                    return false;\n                }\n                if ((this.py1 >= Math.min(otherSegment.py1, otherSegment.py2)) && (this.py1 <= Math.max(otherSegment.py1, otherSegment.py2))) {\n                    this.xi = this.px1;\n                    this.yi = this.py1;\n                    return true;\n                }\n                if ((this.py2 >= Math.min(otherSegment.py1, otherSegment.py2)) && (this.py2 <= Math.max(otherSegment.py1, otherSegment.py2))) {\n                    this.xi = this.px2;\n                    this.yi = this.py2;\n                    return true;\n                }\n                return false;\n            }\n            this.xi = this.px1;\n            this.yi = (grad2 * this.xi + int2);\n            if (((this.py1 - this.yi) * (this.yi - this.py2) < -0.00001) || ((otherSegment.py1 - this.yi) * (this.yi - otherSegment.py2) < -0.00001)) {\n                return false;\n            }\n            if (Math.abs(otherSegment.a) < 0.00001) {\n                if ((otherSegment.px1 - this.xi) * (this.xi - otherSegment.px2) < -0.00001) {\n                    return false;\n                }\n                return true;\n            }\n            return true;\n        }\n        if (grad2 === Number.MAX_VALUE) {\n            this.xi = otherSegment.px1;\n            this.yi = grad1 * this.xi + int1;\n            if (((otherSegment.py1 - this.yi) * (this.yi - otherSegment.py2) < -0.00001) || ((this.py1 - this.yi) * (this.yi - this.py2) < -0.00001)) {\n                return false;\n            }\n            if (Math.abs(a) < 0.00001) {\n                if ((this.px1 - this.xi) * (this.xi - this.px2) < -0.00001) {\n                    return false;\n                }\n                return true;\n            }\n            return true;\n        }\n        if (grad1 === grad2) {\n            if (int1 !== int2) {\n                return false;\n            }\n            if ((this.px1 >= Math.min(otherSegment.px1, otherSegment.px2)) && (this.px1 <= Math.max(otherSegment.py1, otherSegment.py2))) {\n                this.xi = this.px1;\n                this.yi = this.py1;\n                return true;\n            }\n            if ((this.px2 >= Math.min(otherSegment.px1, otherSegment.px2)) && (this.px2 <= Math.max(otherSegment.px1, otherSegment.px2))) {\n                this.xi = this.px2;\n                this.yi = this.py2;\n                return true;\n            }\n            return false;\n        }\n        this.xi = ((int2 - int1) / (grad1 - grad2));\n        this.yi = (grad1 * this.xi + int1);\n        if (((this.px1 - this.xi) * (this.xi - this.px2) < -0.00001) || ((otherSegment.px1 - this.xi) * (this.xi - otherSegment.px2) < -0.00001)) {\n            return false;\n        }\n        return true;\n    }\n}\n","import { Segment } from '../geometry';\nexport class HachureIterator {\n    constructor(top, bottom, left, right, gap, sinAngle, cosAngle, tanAngle) {\n        this.deltaX = 0;\n        this.hGap = 0;\n        this.top = top;\n        this.bottom = bottom;\n        this.left = left;\n        this.right = right;\n        this.gap = gap;\n        this.sinAngle = sinAngle;\n        this.tanAngle = tanAngle;\n        if (Math.abs(sinAngle) < 0.0001) {\n            this.pos = left + gap;\n        }\n        else if (Math.abs(sinAngle) > 0.9999) {\n            this.pos = top + gap;\n        }\n        else {\n            this.deltaX = (bottom - top) * Math.abs(tanAngle);\n            this.pos = left - Math.abs(this.deltaX);\n            this.hGap = Math.abs(gap / cosAngle);\n            this.sLeft = new Segment([left, bottom], [left, top]);\n            this.sRight = new Segment([right, bottom], [right, top]);\n        }\n    }\n    nextLine() {\n        if (Math.abs(this.sinAngle) < 0.0001) {\n            if (this.pos < this.right) {\n                const line = [this.pos, this.top, this.pos, this.bottom];\n                this.pos += this.gap;\n                return line;\n            }\n        }\n        else if (Math.abs(this.sinAngle) > 0.9999) {\n            if (this.pos < this.bottom) {\n                const line = [this.left, this.pos, this.right, this.pos];\n                this.pos += this.gap;\n                return line;\n            }\n        }\n        else {\n            let xLower = this.pos - this.deltaX / 2;\n            let xUpper = this.pos + this.deltaX / 2;\n            let yLower = this.bottom;\n            let yUpper = this.top;\n            if (this.pos < (this.right + this.deltaX)) {\n                while (((xLower < this.left) && (xUpper < this.left)) || ((xLower > this.right) && (xUpper > this.right))) {\n                    this.pos += this.hGap;\n                    xLower = this.pos - this.deltaX / 2;\n                    xUpper = this.pos + this.deltaX / 2;\n                    if (this.pos > (this.right + this.deltaX)) {\n                        return null;\n                    }\n                }\n                const s = new Segment([xLower, yLower], [xUpper, yUpper]);\n                if (this.sLeft && s.intersects(this.sLeft)) {\n                    xLower = s.xi;\n                    yLower = s.yi;\n                }\n                if (this.sRight && s.intersects(this.sRight)) {\n                    xUpper = s.xi;\n                    yUpper = s.yi;\n                }\n                if (this.tanAngle > 0) {\n                    xLower = this.right - (xLower - this.left);\n                    xUpper = this.right - (xUpper - this.left);\n                }\n                const line = [xLower, yLower, xUpper, yUpper];\n                this.pos += this.hGap;\n                return line;\n            }\n        }\n        return null;\n    }\n}\n","import { Segment } from '../geometry';\nimport { HachureIterator } from '../utils/hachure';\nexport function lineLength(line) {\n    const p1 = line[0];\n    const p2 = line[1];\n    return Math.sqrt(Math.pow(p1[0] - p2[0], 2) + Math.pow(p1[1] - p2[1], 2));\n}\nexport function getIntersectingLines(line, points) {\n    const intersections = [];\n    const s1 = new Segment([line[0], line[1]], [line[2], line[3]]);\n    for (let i = 0; i < points.length; i++) {\n        const s2 = new Segment(points[i], points[(i + 1) % points.length]);\n        if (s1.intersects(s2)) {\n            intersections.push([s1.xi, s1.yi]);\n        }\n    }\n    return intersections;\n}\nexport function affine(x, y, cx, cy, sinAnglePrime, cosAnglePrime, R) {\n    const A = -cx * cosAnglePrime - cy * sinAnglePrime + cx;\n    const B = R * (cx * sinAnglePrime - cy * cosAnglePrime) + cy;\n    const C = cosAnglePrime;\n    const D = sinAnglePrime;\n    const E = -R * sinAnglePrime;\n    const F = R * cosAnglePrime;\n    return [\n        A + C * x + D * y,\n        B + E * x + F * y\n    ];\n}\nexport function hachureLinesForPolygon(points, o) {\n    const ret = [];\n    if (points && points.length) {\n        let left = points[0][0];\n        let right = points[0][0];\n        let top = points[0][1];\n        let bottom = points[0][1];\n        for (let i = 1; i < points.length; i++) {\n            left = Math.min(left, points[i][0]);\n            right = Math.max(right, points[i][0]);\n            top = Math.min(top, points[i][1]);\n            bottom = Math.max(bottom, points[i][1]);\n        }\n        const angle = o.hachureAngle;\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        const radPerDeg = Math.PI / 180;\n        const hachureAngle = (angle % 180) * radPerDeg;\n        const cosAngle = Math.cos(hachureAngle);\n        const sinAngle = Math.sin(hachureAngle);\n        const tanAngle = Math.tan(hachureAngle);\n        const it = new HachureIterator(top - 1, bottom + 1, left - 1, right + 1, gap, sinAngle, cosAngle, tanAngle);\n        let rect;\n        while ((rect = it.nextLine()) != null) {\n            const lines = getIntersectingLines(rect, points);\n            for (let i = 0; i < lines.length; i++) {\n                if (i < (lines.length - 1)) {\n                    const p1 = lines[i];\n                    const p2 = lines[i + 1];\n                    ret.push([p1, p2]);\n                }\n            }\n        }\n    }\n    return ret;\n}\nexport function hachureLinesForEllipse(cx, cy, width, height, o, renderer) {\n    const ret = [];\n    let rx = Math.abs(width / 2);\n    let ry = Math.abs(height / 2);\n    rx += renderer.getOffset(-rx * 0.05, rx * 0.05, o);\n    ry += renderer.getOffset(-ry * 0.05, ry * 0.05, o);\n    const angle = o.hachureAngle;\n    let gap = o.hachureGap;\n    if (gap <= 0) {\n        gap = o.strokeWidth * 4;\n    }\n    let fweight = o.fillWeight;\n    if (fweight < 0) {\n        fweight = o.strokeWidth / 2;\n    }\n    const radPerDeg = Math.PI / 180;\n    const hachureAngle = (angle % 180) * radPerDeg;\n    const tanAngle = Math.tan(hachureAngle);\n    const aspectRatio = ry / rx;\n    const hyp = Math.sqrt(aspectRatio * tanAngle * aspectRatio * tanAngle + 1);\n    const sinAnglePrime = aspectRatio * tanAngle / hyp;\n    const cosAnglePrime = 1 / hyp;\n    const gapPrime = gap / ((rx * ry / Math.sqrt((ry * cosAnglePrime) * (ry * cosAnglePrime) + (rx * sinAnglePrime) * (rx * sinAnglePrime))) / rx);\n    let halfLen = Math.sqrt((rx * rx) - (cx - rx + gapPrime) * (cx - rx + gapPrime));\n    for (let xPos = cx - rx + gapPrime; xPos < cx + rx; xPos += gapPrime) {\n        halfLen = Math.sqrt((rx * rx) - (cx - xPos) * (cx - xPos));\n        const p1 = affine(xPos, cy - halfLen, cx, cy, sinAnglePrime, cosAnglePrime, aspectRatio);\n        const p2 = affine(xPos, cy + halfLen, cx, cy, sinAnglePrime, cosAnglePrime, aspectRatio);\n        ret.push([p1, p2]);\n    }\n    return ret;\n}\n","import { hachureLinesForPolygon, hachureLinesForEllipse } from './filler-utils';\nexport class HachureFiller {\n    constructor(renderer) {\n        this.renderer = renderer;\n    }\n    fillPolygon(points, o) {\n        return this._fillPolygon(points, o);\n    }\n    fillEllipse(cx, cy, width, height, o) {\n        return this._fillEllipse(cx, cy, width, height, o);\n    }\n    _fillPolygon(points, o, connectEnds = false) {\n        const lines = hachureLinesForPolygon(points, o);\n        const ops = this.renderLines(lines, o, connectEnds);\n        return { type: 'fillSketch', ops };\n    }\n    _fillEllipse(cx, cy, width, height, o, connectEnds = false) {\n        const lines = hachureLinesForEllipse(cx, cy, width, height, o, this.renderer);\n        const ops = this.renderLines(lines, o, connectEnds);\n        return { type: 'fillSketch', ops };\n    }\n    renderLines(lines, o, connectEnds) {\n        let ops = [];\n        let prevPoint = null;\n        for (const line of lines) {\n            ops = ops.concat(this.renderer.doubleLine(line[0][0], line[0][1], line[1][0], line[1][1], o));\n            if (connectEnds && prevPoint) {\n                ops = ops.concat(this.renderer.doubleLine(prevPoint[0], prevPoint[1], line[0][0], line[0][1], o));\n            }\n            prevPoint = line[1];\n        }\n        return ops;\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nexport class ZigZagFiller extends HachureFiller {\n    fillPolygon(points, o) {\n        return this._fillPolygon(points, o, true);\n    }\n    fillEllipse(cx, cy, width, height, o) {\n        return this._fillEllipse(cx, cy, width, height, o, true);\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nexport class HatchFiller extends HachureFiller {\n    fillPolygon(points, o) {\n        const set = this._fillPolygon(points, o);\n        const o2 = Object.assign({}, o, { hachureAngle: o.hachureAngle + 90 });\n        const set2 = this._fillPolygon(points, o2);\n        set.ops = set.ops.concat(set2.ops);\n        return set;\n    }\n    fillEllipse(cx, cy, width, height, o) {\n        const set = this._fillEllipse(cx, cy, width, height, o);\n        const o2 = Object.assign({}, o, { hachureAngle: o.hachureAngle + 90 });\n        const set2 = this._fillEllipse(cx, cy, width, height, o2);\n        set.ops = set.ops.concat(set2.ops);\n        return set;\n    }\n}\n","import { hachureLinesForPolygon, hachureLinesForEllipse, lineLength } from './filler-utils';\nexport class DotFiller {\n    constructor(renderer) {\n        this.renderer = renderer;\n    }\n    fillPolygon(points, o) {\n        o = Object.assign({}, o, { curveStepCount: 4, hachureAngle: 0 });\n        const lines = hachureLinesForPolygon(points, o);\n        return this.dotsOnLines(lines, o);\n    }\n    fillEllipse(cx, cy, width, height, o) {\n        o = Object.assign({}, o, { curveStepCount: 4, hachureAngle: 0 });\n        const lines = hachureLinesForEllipse(cx, cy, width, height, o, this.renderer);\n        return this.dotsOnLines(lines, o);\n    }\n    dotsOnLines(lines, o) {\n        let ops = [];\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        for (const line of lines) {\n            const length = lineLength(line);\n            const dl = length / gap;\n            const count = Math.ceil(dl) - 1;\n            const alpha = Math.atan((line[1][1] - line[0][1]) / (line[1][0] - line[0][0]));\n            for (let i = 0; i < count; i++) {\n                const l = gap * (i + 1);\n                const dy = l * Math.sin(alpha);\n                const dx = l * Math.cos(alpha);\n                const c = [line[0][0] - dx, line[0][1] + dy];\n                const cx = this.renderer.getOffset(c[0] - gap / 4, c[0] + gap / 4, o);\n                const cy = this.renderer.getOffset(c[1] - gap / 4, c[1] + gap / 4, o);\n                const ellipse = this.renderer.ellipse(cx, cy, fweight, fweight, o);\n                ops = ops.concat(ellipse.ops);\n            }\n        }\n        return { type: 'fillSketch', ops };\n    }\n}\n","import { HachureFiller } from './hachure-filler';\nimport { ZigZagFiller } from './zigzag-filler';\nimport { HatchFiller } from './hatch-filler';\nimport { DotFiller } from './dot-filler';\nconst fillers = {};\nexport function getFiller(renderer, o) {\n    let fillerName = o.fillStyle || 'hachure';\n    if (!fillers[fillerName]) {\n        switch (fillerName) {\n            case 'zigzag':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new ZigZagFiller(renderer);\n                }\n                break;\n            case 'cross-hatch':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new HatchFiller(renderer);\n                }\n                break;\n            case 'dots':\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new DotFiller(renderer);\n                }\n                break;\n            case 'hachure':\n            default:\n                fillerName = 'hachure';\n                if (!fillers[fillerName]) {\n                    fillers[fillerName] = new HachureFiller(renderer);\n                }\n                break;\n        }\n    }\n    return fillers[fillerName];\n}\n","import { RoughPath, RoughArcConverter, PathFitter } from './path.js';\nimport { getFiller } from './fillers/filler';\nexport class RoughRenderer {\n    line(x1, y1, x2, y2, o) {\n        const ops = this.doubleLine(x1, y1, x2, y2, o);\n        return { type: 'path', ops };\n    }\n    linearPath(points, close, o) {\n        const len = (points || []).length;\n        if (len > 2) {\n            let ops = [];\n            for (let i = 0; i < (len - 1); i++) {\n                ops = ops.concat(this.doubleLine(points[i][0], points[i][1], points[i + 1][0], points[i + 1][1], o));\n            }\n            if (close) {\n                ops = ops.concat(this.doubleLine(points[len - 1][0], points[len - 1][1], points[0][0], points[0][1], o));\n            }\n            return { type: 'path', ops };\n        }\n        else if (len === 2) {\n            return this.line(points[0][0], points[0][1], points[1][0], points[1][1], o);\n        }\n        return { type: 'path', ops: [] };\n    }\n    polygon(points, o) {\n        return this.linearPath(points, true, o);\n    }\n    rectangle(x, y, width, height, o) {\n        const points = [\n            [x, y], [x + width, y], [x + width, y + height], [x, y + height]\n        ];\n        return this.polygon(points, o);\n    }\n    curve(points, o) {\n        const o1 = this._curveWithOffset(points, 1 * (1 + o.roughness * 0.2), o);\n        const o2 = this._curveWithOffset(points, 1.5 * (1 + o.roughness * 0.22), o);\n        return { type: 'path', ops: o1.concat(o2) };\n    }\n    ellipse(x, y, width, height, o) {\n        const increment = (Math.PI * 2) / o.curveStepCount;\n        let rx = Math.abs(width / 2);\n        let ry = Math.abs(height / 2);\n        rx += this.getOffset(-rx * 0.05, rx * 0.05, o);\n        ry += this.getOffset(-ry * 0.05, ry * 0.05, o);\n        const o1 = this._ellipse(increment, x, y, rx, ry, 1, increment * this.getOffset(0.1, this.getOffset(0.4, 1, o), o), o);\n        const o2 = this._ellipse(increment, x, y, rx, ry, 1.5, 0, o);\n        return { type: 'path', ops: o1.concat(o2) };\n    }\n    arc(x, y, width, height, start, stop, closed, roughClosure, o) {\n        const cx = x;\n        const cy = y;\n        let rx = Math.abs(width / 2);\n        let ry = Math.abs(height / 2);\n        rx += this.getOffset(-rx * 0.01, rx * 0.01, o);\n        ry += this.getOffset(-ry * 0.01, ry * 0.01, o);\n        let strt = start;\n        let stp = stop;\n        while (strt < 0) {\n            strt += Math.PI * 2;\n            stp += Math.PI * 2;\n        }\n        if ((stp - strt) > (Math.PI * 2)) {\n            strt = 0;\n            stp = Math.PI * 2;\n        }\n        const ellipseInc = (Math.PI * 2) / o.curveStepCount;\n        const arcInc = Math.min(ellipseInc / 2, (stp - strt) / 2);\n        const o1 = this._arc(arcInc, cx, cy, rx, ry, strt, stp, 1, o);\n        const o2 = this._arc(arcInc, cx, cy, rx, ry, strt, stp, 1.5, o);\n        let ops = o1.concat(o2);\n        if (closed) {\n            if (roughClosure) {\n                ops = ops.concat(this.doubleLine(cx, cy, cx + rx * Math.cos(strt), cy + ry * Math.sin(strt), o));\n                ops = ops.concat(this.doubleLine(cx, cy, cx + rx * Math.cos(stp), cy + ry * Math.sin(stp), o));\n            }\n            else {\n                ops.push({ op: 'lineTo', data: [cx, cy] });\n                ops.push({ op: 'lineTo', data: [cx + rx * Math.cos(strt), cy + ry * Math.sin(strt)] });\n            }\n        }\n        return { type: 'path', ops };\n    }\n    svgPath(path, o) {\n        path = (path || '').replace(/\\n/g, ' ').replace(/(-\\s)/g, '-').replace('/(\\s\\s)/g', ' ');\n        let p = new RoughPath(path);\n        if (o.simplification) {\n            const fitter = new PathFitter(p.linearPoints, p.closed);\n            const d = fitter.fit(o.simplification);\n            p = new RoughPath(d);\n        }\n        let ops = [];\n        const segments = p.segments || [];\n        for (let i = 0; i < segments.length; i++) {\n            const s = segments[i];\n            const prev = i > 0 ? segments[i - 1] : null;\n            const opList = this._processSegment(p, s, prev, o);\n            if (opList && opList.length) {\n                ops = ops.concat(opList);\n            }\n        }\n        return { type: 'path', ops };\n    }\n    solidFillPolygon(points, o) {\n        const ops = [];\n        if (points.length) {\n            const offset = o.maxRandomnessOffset || 0;\n            const len = points.length;\n            if (len > 2) {\n                ops.push({ op: 'move', data: [points[0][0] + this.getOffset(-offset, offset, o), points[0][1] + this.getOffset(-offset, offset, o)] });\n                for (let i = 1; i < len; i++) {\n                    ops.push({ op: 'lineTo', data: [points[i][0] + this.getOffset(-offset, offset, o), points[i][1] + this.getOffset(-offset, offset, o)] });\n                }\n            }\n        }\n        return { type: 'fillPath', ops };\n    }\n    patternFillPolygon(points, o) {\n        const filler = getFiller(this, o);\n        return filler.fillPolygon(points, o);\n    }\n    patternFillEllipse(cx, cy, width, height, o) {\n        const filler = getFiller(this, o);\n        return filler.fillEllipse(cx, cy, width, height, o);\n    }\n    patternFillArc(x, y, width, height, start, stop, o) {\n        const cx = x;\n        const cy = y;\n        let rx = Math.abs(width / 2);\n        let ry = Math.abs(height / 2);\n        rx += this.getOffset(-rx * 0.01, rx * 0.01, o);\n        ry += this.getOffset(-ry * 0.01, ry * 0.01, o);\n        let strt = start;\n        let stp = stop;\n        while (strt < 0) {\n            strt += Math.PI * 2;\n            stp += Math.PI * 2;\n        }\n        if ((stp - strt) > (Math.PI * 2)) {\n            strt = 0;\n            stp = Math.PI * 2;\n        }\n        const increment = (stp - strt) / o.curveStepCount;\n        const points = [];\n        for (let angle = strt; angle <= stp; angle = angle + increment) {\n            points.push([cx + rx * Math.cos(angle), cy + ry * Math.sin(angle)]);\n        }\n        points.push([cx + rx * Math.cos(stp), cy + ry * Math.sin(stp)]);\n        points.push([cx, cy]);\n        return this.patternFillPolygon(points, o);\n    }\n    /// \n    getOffset(min, max, ops) {\n        return ops.roughness * ((Math.random() * (max - min)) + min);\n    }\n    doubleLine(x1, y1, x2, y2, o) {\n        const o1 = this._line(x1, y1, x2, y2, o, true, false);\n        const o2 = this._line(x1, y1, x2, y2, o, true, true);\n        return o1.concat(o2);\n    }\n    _line(x1, y1, x2, y2, o, move, overlay) {\n        const lengthSq = Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2);\n        let offset = o.maxRandomnessOffset || 0;\n        if ((offset * offset * 100) > lengthSq) {\n            offset = Math.sqrt(lengthSq) / 10;\n        }\n        const halfOffset = offset / 2;\n        const divergePoint = 0.2 + Math.random() * 0.2;\n        let midDispX = o.bowing * o.maxRandomnessOffset * (y2 - y1) / 200;\n        let midDispY = o.bowing * o.maxRandomnessOffset * (x1 - x2) / 200;\n        midDispX = this.getOffset(-midDispX, midDispX, o);\n        midDispY = this.getOffset(-midDispY, midDispY, o);\n        const ops = [];\n        if (move) {\n            if (overlay) {\n                ops.push({\n                    op: 'move', data: [\n                        x1 + this.getOffset(-halfOffset, halfOffset, o),\n                        y1 + this.getOffset(-halfOffset, halfOffset, o)\n                    ]\n                });\n            }\n            else {\n                ops.push({\n                    op: 'move', data: [\n                        x1 + this.getOffset(-offset, offset, o),\n                        y1 + this.getOffset(-offset, offset, o)\n                    ]\n                });\n            }\n        }\n        if (overlay) {\n            ops.push({\n                op: 'bcurveTo', data: [\n                    midDispX + x1 + (x2 - x1) * divergePoint + this.getOffset(-halfOffset, halfOffset, o),\n                    midDispY + y1 + (y2 - y1) * divergePoint + this.getOffset(-halfOffset, halfOffset, o),\n                    midDispX + x1 + 2 * (x2 - x1) * divergePoint + this.getOffset(-halfOffset, halfOffset, o),\n                    midDispY + y1 + 2 * (y2 - y1) * divergePoint + this.getOffset(-halfOffset, halfOffset, o),\n                    x2 + this.getOffset(-halfOffset, halfOffset, o),\n                    y2 + this.getOffset(-halfOffset, halfOffset, o)\n                ]\n            });\n        }\n        else {\n            ops.push({\n                op: 'bcurveTo', data: [\n                    midDispX + x1 + (x2 - x1) * divergePoint + this.getOffset(-offset, offset, o),\n                    midDispY + y1 + (y2 - y1) * divergePoint + this.getOffset(-offset, offset, o),\n                    midDispX + x1 + 2 * (x2 - x1) * divergePoint + this.getOffset(-offset, offset, o),\n                    midDispY + y1 + 2 * (y2 - y1) * divergePoint + this.getOffset(-offset, offset, o),\n                    x2 + this.getOffset(-offset, offset, o),\n                    y2 + this.getOffset(-offset, offset, o)\n                ]\n            });\n        }\n        return ops;\n    }\n    _curve(points, closePoint, o) {\n        const len = points.length;\n        let ops = [];\n        if (len > 3) {\n            const b = [];\n            const s = 1 - o.curveTightness;\n            ops.push({ op: 'move', data: [points[1][0], points[1][1]] });\n            for (let i = 1; (i + 2) < len; i++) {\n                const cachedVertArray = points[i];\n                b[0] = [cachedVertArray[0], cachedVertArray[1]];\n                b[1] = [cachedVertArray[0] + (s * points[i + 1][0] - s * points[i - 1][0]) / 6, cachedVertArray[1] + (s * points[i + 1][1] - s * points[i - 1][1]) / 6];\n                b[2] = [points[i + 1][0] + (s * points[i][0] - s * points[i + 2][0]) / 6, points[i + 1][1] + (s * points[i][1] - s * points[i + 2][1]) / 6];\n                b[3] = [points[i + 1][0], points[i + 1][1]];\n                ops.push({ op: 'bcurveTo', data: [b[1][0], b[1][1], b[2][0], b[2][1], b[3][0], b[3][1]] });\n            }\n            if (closePoint && closePoint.length === 2) {\n                const ro = o.maxRandomnessOffset;\n                ops.push({ op: 'lineTo', data: [closePoint[0] + this.getOffset(-ro, ro, o), closePoint[1] + +this.getOffset(-ro, ro, o)] });\n            }\n        }\n        else if (len === 3) {\n            ops.push({ op: 'move', data: [points[1][0], points[1][1]] });\n            ops.push({\n                op: 'bcurveTo', data: [\n                    points[1][0], points[1][1],\n                    points[2][0], points[2][1],\n                    points[2][0], points[2][1]\n                ]\n            });\n        }\n        else if (len === 2) {\n            ops = ops.concat(this.doubleLine(points[0][0], points[0][1], points[1][0], points[1][1], o));\n        }\n        return ops;\n    }\n    _ellipse(increment, cx, cy, rx, ry, offset, overlap, o) {\n        const radOffset = this.getOffset(-0.5, 0.5, o) - (Math.PI / 2);\n        const points = [];\n        points.push([\n            this.getOffset(-offset, offset, o) + cx + 0.9 * rx * Math.cos(radOffset - increment),\n            this.getOffset(-offset, offset, o) + cy + 0.9 * ry * Math.sin(radOffset - increment)\n        ]);\n        for (let angle = radOffset; angle < (Math.PI * 2 + radOffset - 0.01); angle = angle + increment) {\n            points.push([\n                this.getOffset(-offset, offset, o) + cx + rx * Math.cos(angle),\n                this.getOffset(-offset, offset, o) + cy + ry * Math.sin(angle)\n            ]);\n        }\n        points.push([\n            this.getOffset(-offset, offset, o) + cx + rx * Math.cos(radOffset + Math.PI * 2 + overlap * 0.5),\n            this.getOffset(-offset, offset, o) + cy + ry * Math.sin(radOffset + Math.PI * 2 + overlap * 0.5)\n        ]);\n        points.push([\n            this.getOffset(-offset, offset, o) + cx + 0.98 * rx * Math.cos(radOffset + overlap),\n            this.getOffset(-offset, offset, o) + cy + 0.98 * ry * Math.sin(radOffset + overlap)\n        ]);\n        points.push([\n            this.getOffset(-offset, offset, o) + cx + 0.9 * rx * Math.cos(radOffset + overlap * 0.5),\n            this.getOffset(-offset, offset, o) + cy + 0.9 * ry * Math.sin(radOffset + overlap * 0.5)\n        ]);\n        return this._curve(points, null, o);\n    }\n    _curveWithOffset(points, offset, o) {\n        const ps = [];\n        ps.push([\n            points[0][0] + this.getOffset(-offset, offset, o),\n            points[0][1] + this.getOffset(-offset, offset, o),\n        ]);\n        ps.push([\n            points[0][0] + this.getOffset(-offset, offset, o),\n            points[0][1] + this.getOffset(-offset, offset, o),\n        ]);\n        for (let i = 1; i < points.length; i++) {\n            ps.push([\n                points[i][0] + this.getOffset(-offset, offset, o),\n                points[i][1] + this.getOffset(-offset, offset, o),\n            ]);\n            if (i === (points.length - 1)) {\n                ps.push([\n                    points[i][0] + this.getOffset(-offset, offset, o),\n                    points[i][1] + this.getOffset(-offset, offset, o),\n                ]);\n            }\n        }\n        return this._curve(ps, null, o);\n    }\n    _arc(increment, cx, cy, rx, ry, strt, stp, offset, o) {\n        const radOffset = strt + this.getOffset(-0.1, 0.1, o);\n        const points = [];\n        points.push([\n            this.getOffset(-offset, offset, o) + cx + 0.9 * rx * Math.cos(radOffset - increment),\n            this.getOffset(-offset, offset, o) + cy + 0.9 * ry * Math.sin(radOffset - increment)\n        ]);\n        for (let angle = radOffset; angle <= stp; angle = angle + increment) {\n            points.push([\n                this.getOffset(-offset, offset, o) + cx + rx * Math.cos(angle),\n                this.getOffset(-offset, offset, o) + cy + ry * Math.sin(angle)\n            ]);\n        }\n        points.push([\n            cx + rx * Math.cos(stp),\n            cy + ry * Math.sin(stp)\n        ]);\n        points.push([\n            cx + rx * Math.cos(stp),\n            cy + ry * Math.sin(stp)\n        ]);\n        return this._curve(points, null, o);\n    }\n    _bezierTo(x1, y1, x2, y2, x, y, path, o) {\n        const ops = [];\n        const ros = [o.maxRandomnessOffset || 1, (o.maxRandomnessOffset || 1) + 0.5];\n        let f = [0, 0];\n        for (let i = 0; i < 2; i++) {\n            if (i === 0) {\n                ops.push({ op: 'move', data: [path.x, path.y] });\n            }\n            else {\n                ops.push({ op: 'move', data: [path.x + this.getOffset(-ros[0], ros[0], o), path.y + this.getOffset(-ros[0], ros[0], o)] });\n            }\n            f = [x + this.getOffset(-ros[i], ros[i], o), y + this.getOffset(-ros[i], ros[i], o)];\n            ops.push({\n                op: 'bcurveTo', data: [\n                    x1 + this.getOffset(-ros[i], ros[i], o), y1 + this.getOffset(-ros[i], ros[i], o),\n                    x2 + this.getOffset(-ros[i], ros[i], o), y2 + this.getOffset(-ros[i], ros[i], o),\n                    f[0], f[1]\n                ]\n            });\n        }\n        path.setPosition(f[0], f[1]);\n        return ops;\n    }\n    _processSegment(path, seg, prevSeg, o) {\n        let ops = [];\n        switch (seg.key) {\n            case 'M':\n            case 'm': {\n                const delta = seg.key === 'm';\n                if (seg.data.length >= 2) {\n                    let x = +seg.data[0];\n                    let y = +seg.data[1];\n                    if (delta) {\n                        x += path.x;\n                        y += path.y;\n                    }\n                    const ro = 1 * (o.maxRandomnessOffset || 0);\n                    x = x + this.getOffset(-ro, ro, o);\n                    y = y + this.getOffset(-ro, ro, o);\n                    path.setPosition(x, y);\n                    ops.push({ op: 'move', data: [x, y] });\n                }\n                break;\n            }\n            case 'L':\n            case 'l': {\n                const delta = seg.key === 'l';\n                if (seg.data.length >= 2) {\n                    let x = +seg.data[0];\n                    let y = +seg.data[1];\n                    if (delta) {\n                        x += path.x;\n                        y += path.y;\n                    }\n                    ops = ops.concat(this.doubleLine(path.x, path.y, x, y, o));\n                    path.setPosition(x, y);\n                }\n                break;\n            }\n            case 'H':\n            case 'h': {\n                const delta = seg.key === 'h';\n                if (seg.data.length) {\n                    let x = +seg.data[0];\n                    if (delta) {\n                        x += path.x;\n                    }\n                    ops = ops.concat(this.doubleLine(path.x, path.y, x, path.y, o));\n                    path.setPosition(x, path.y);\n                }\n                break;\n            }\n            case 'V':\n            case 'v': {\n                const delta = seg.key === 'v';\n                if (seg.data.length) {\n                    let y = +seg.data[0];\n                    if (delta) {\n                        y += path.y;\n                    }\n                    ops = ops.concat(this.doubleLine(path.x, path.y, path.x, y, o));\n                    path.setPosition(path.x, y);\n                }\n                break;\n            }\n            case 'Z':\n            case 'z': {\n                if (path.first) {\n                    ops = ops.concat(this.doubleLine(path.x, path.y, path.first[0], path.first[1], o));\n                    path.setPosition(path.first[0], path.first[1]);\n                    path.first = null;\n                }\n                break;\n            }\n            case 'C':\n            case 'c': {\n                const delta = seg.key === 'c';\n                if (seg.data.length >= 6) {\n                    let x1 = +seg.data[0];\n                    let y1 = +seg.data[1];\n                    let x2 = +seg.data[2];\n                    let y2 = +seg.data[3];\n                    let x = +seg.data[4];\n                    let y = +seg.data[5];\n                    if (delta) {\n                        x1 += path.x;\n                        x2 += path.x;\n                        x += path.x;\n                        y1 += path.y;\n                        y2 += path.y;\n                        y += path.y;\n                    }\n                    const ob = this._bezierTo(x1, y1, x2, y2, x, y, path, o);\n                    ops = ops.concat(ob);\n                    path.bezierReflectionPoint = [x + (x - x2), y + (y - y2)];\n                }\n                break;\n            }\n            case 'S':\n            case 's': {\n                const delta = seg.key === 's';\n                if (seg.data.length >= 4) {\n                    let x2 = +seg.data[0];\n                    let y2 = +seg.data[1];\n                    let x = +seg.data[2];\n                    let y = +seg.data[3];\n                    if (delta) {\n                        x2 += path.x;\n                        x += path.x;\n                        y2 += path.y;\n                        y += path.y;\n                    }\n                    let x1 = x2;\n                    let y1 = y2;\n                    const prevKey = prevSeg ? prevSeg.key : '';\n                    let ref = null;\n                    if (prevKey === 'c' || prevKey === 'C' || prevKey === 's' || prevKey === 'S') {\n                        ref = path.bezierReflectionPoint;\n                    }\n                    if (ref) {\n                        x1 = ref[0];\n                        y1 = ref[1];\n                    }\n                    const ob = this._bezierTo(x1, y1, x2, y2, x, y, path, o);\n                    ops = ops.concat(ob);\n                    path.bezierReflectionPoint = [x + (x - x2), y + (y - y2)];\n                }\n                break;\n            }\n            case 'Q':\n            case 'q': {\n                const delta = seg.key === 'q';\n                if (seg.data.length >= 4) {\n                    let x1 = +seg.data[0];\n                    let y1 = +seg.data[1];\n                    let x = +seg.data[2];\n                    let y = +seg.data[3];\n                    if (delta) {\n                        x1 += path.x;\n                        x += path.x;\n                        y1 += path.y;\n                        y += path.y;\n                    }\n                    const offset1 = 1 * (1 + o.roughness * 0.2);\n                    const offset2 = 1.5 * (1 + o.roughness * 0.22);\n                    ops.push({ op: 'move', data: [path.x + this.getOffset(-offset1, offset1, o), path.y + this.getOffset(-offset1, offset1, o)] });\n                    let f = [x + this.getOffset(-offset1, offset1, o), y + this.getOffset(-offset1, offset1, o)];\n                    ops.push({\n                        op: 'qcurveTo', data: [\n                            x1 + this.getOffset(-offset1, offset1, o), y1 + this.getOffset(-offset1, offset1, o),\n                            f[0], f[1]\n                        ]\n                    });\n                    ops.push({ op: 'move', data: [path.x + this.getOffset(-offset2, offset2, o), path.y + this.getOffset(-offset2, offset2, o)] });\n                    f = [x + this.getOffset(-offset2, offset2, o), y + this.getOffset(-offset2, offset2, o)];\n                    ops.push({\n                        op: 'qcurveTo', data: [\n                            x1 + this.getOffset(-offset2, offset2, o), y1 + this.getOffset(-offset2, offset2, o),\n                            f[0], f[1]\n                        ]\n                    });\n                    path.setPosition(f[0], f[1]);\n                    path.quadReflectionPoint = [x + (x - x1), y + (y - y1)];\n                }\n                break;\n            }\n            case 'T':\n            case 't': {\n                const delta = seg.key === 't';\n                if (seg.data.length >= 2) {\n                    let x = +seg.data[0];\n                    let y = +seg.data[1];\n                    if (delta) {\n                        x += path.x;\n                        y += path.y;\n                    }\n                    let x1 = x;\n                    let y1 = y;\n                    const prevKey = prevSeg ? prevSeg.key : '';\n                    let ref = null;\n                    if (prevKey === 'q' || prevKey === 'Q' || prevKey === 't' || prevKey === 'T') {\n                        ref = path.quadReflectionPoint;\n                    }\n                    if (ref) {\n                        x1 = ref[0];\n                        y1 = ref[1];\n                    }\n                    const offset1 = 1 * (1 + o.roughness * 0.2);\n                    const offset2 = 1.5 * (1 + o.roughness * 0.22);\n                    ops.push({ op: 'move', data: [path.x + this.getOffset(-offset1, offset1, o), path.y + this.getOffset(-offset1, offset1, o)] });\n                    let f = [x + this.getOffset(-offset1, offset1, o), y + this.getOffset(-offset1, offset1, o)];\n                    ops.push({\n                        op: 'qcurveTo', data: [\n                            x1 + this.getOffset(-offset1, offset1, o), y1 + this.getOffset(-offset1, offset1, o),\n                            f[0], f[1]\n                        ]\n                    });\n                    ops.push({ op: 'move', data: [path.x + this.getOffset(-offset2, offset2, o), path.y + this.getOffset(-offset2, offset2, o)] });\n                    f = [x + this.getOffset(-offset2, offset2, o), y + this.getOffset(-offset2, offset2, o)];\n                    ops.push({\n                        op: 'qcurveTo', data: [\n                            x1 + this.getOffset(-offset2, offset2, o), y1 + this.getOffset(-offset2, offset2, o),\n                            f[0], f[1]\n                        ]\n                    });\n                    path.setPosition(f[0], f[1]);\n                    path.quadReflectionPoint = [x + (x - x1), y + (y - y1)];\n                }\n                break;\n            }\n            case 'A':\n            case 'a': {\n                const delta = seg.key === 'a';\n                if (seg.data.length >= 7) {\n                    const rx = +seg.data[0];\n                    const ry = +seg.data[1];\n                    const angle = +seg.data[2];\n                    const largeArcFlag = +seg.data[3];\n                    const sweepFlag = +seg.data[4];\n                    let x = +seg.data[5];\n                    let y = +seg.data[6];\n                    if (delta) {\n                        x += path.x;\n                        y += path.y;\n                    }\n                    if (x === path.x && y === path.y) {\n                        break;\n                    }\n                    if (rx === 0 || ry === 0) {\n                        ops = ops.concat(this.doubleLine(path.x, path.y, x, y, o));\n                        path.setPosition(x, y);\n                    }\n                    else {\n                        for (let i = 0; i < 1; i++) {\n                            const arcConverter = new RoughArcConverter([path.x, path.y], [x, y], [rx, ry], angle, largeArcFlag ? true : false, sweepFlag ? true : false);\n                            let segment = arcConverter.getNextSegment();\n                            while (segment) {\n                                const ob = this._bezierTo(segment.cp1[0], segment.cp1[1], segment.cp2[0], segment.cp2[1], segment.to[0], segment.to[1], path, o);\n                                ops = ops.concat(ob);\n                                segment = arcConverter.getNextSegment();\n                            }\n                        }\n                    }\n                }\n                break;\n            }\n            default:\n                break;\n        }\n        return ops;\n    }\n}\n","import { RoughRenderer } from './renderer';\nconst hasSelf = typeof self !== 'undefined';\nconst roughScript = hasSelf && self && self.document && self.document.currentScript && self.document.currentScript.src;\nexport function createRenderer(config) {\n    if (hasSelf && roughScript && self && self.workly && config.async && (!config.noWorker)) {\n        const worklySource = config.worklyURL || 'https://cdn.jsdelivr.net/gh/pshihn/workly/dist/workly.min.js';\n        if (worklySource) {\n            const code = `importScripts('${worklySource}', '${roughScript}');\\nworkly.expose(self.rough.createRenderer());`;\n            const ourl = URL.createObjectURL(new Blob([code]));\n            return self.workly.proxy(ourl);\n        }\n    }\n    return new RoughRenderer();\n}\n","import { createRenderer } from './renderer-factory.js';\nconst hasSelf = typeof self !== 'undefined';\nexport class RoughGeneratorBase {\n    constructor(config, surface) {\n        this.defaultOptions = {\n            maxRandomnessOffset: 2,\n            roughness: 1,\n            bowing: 1,\n            stroke: '#000',\n            strokeWidth: 1,\n            curveTightness: 0,\n            curveStepCount: 9,\n            fillStyle: 'hachure',\n            fillWeight: -1,\n            hachureAngle: -41,\n            hachureGap: -1\n        };\n        this.config = config || {};\n        this.surface = surface;\n        this.renderer = createRenderer(this.config);\n        if (this.config.options) {\n            this.defaultOptions = this._options(this.config.options);\n        }\n    }\n    _options(options) {\n        return options ? Object.assign({}, this.defaultOptions, options) : this.defaultOptions;\n    }\n    _drawable(shape, sets, options) {\n        return { shape, sets: sets || [], options: options || this.defaultOptions };\n    }\n    get lib() {\n        return this.renderer;\n    }\n    getCanvasSize() {\n        const val = (w) => {\n            if (w && typeof w === 'object') {\n                if (w.baseVal && w.baseVal.value) {\n                    return w.baseVal.value;\n                }\n            }\n            return w || 100;\n        };\n        if (this.surface) {\n            return [val(this.surface.width), val(this.surface.height)];\n        }\n        return [100, 100];\n    }\n    computePolygonSize(points) {\n        if (points.length) {\n            let left = points[0][0];\n            let right = points[0][0];\n            let top = points[0][1];\n            let bottom = points[0][1];\n            for (let i = 1; i < points.length; i++) {\n                left = Math.min(left, points[i][0]);\n                right = Math.max(right, points[i][0]);\n                top = Math.min(top, points[i][1]);\n                bottom = Math.max(bottom, points[i][1]);\n            }\n            return [(right - left), (bottom - top)];\n        }\n        return [0, 0];\n    }\n    polygonPath(points) {\n        let d = '';\n        if (points.length) {\n            d = `M${points[0][0]},${points[0][1]}`;\n            for (let i = 1; i < points.length; i++) {\n                d = `${d} L${points[i][0]},${points[i][1]}`;\n            }\n        }\n        return d;\n    }\n    computePathSize(d) {\n        let size = [0, 0];\n        if (hasSelf && self.document) {\n            try {\n                const ns = 'http://www.w3.org/2000/svg';\n                const svg = self.document.createElementNS(ns, 'svg');\n                svg.setAttribute('width', '0');\n                svg.setAttribute('height', '0');\n                const pathNode = self.document.createElementNS(ns, 'path');\n                pathNode.setAttribute('d', d);\n                svg.appendChild(pathNode);\n                self.document.body.appendChild(svg);\n                const bb = pathNode.getBBox();\n                if (bb) {\n                    size[0] = bb.width || 0;\n                    size[1] = bb.height || 0;\n                }\n                self.document.body.removeChild(svg);\n            }\n            catch (err) { }\n        }\n        const canvasSize = this.getCanvasSize();\n        if (!(size[0] * size[1])) {\n            size = canvasSize;\n        }\n        return size;\n    }\n    toPaths(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.defaultOptions;\n        const paths = [];\n        for (const drawing of sets) {\n            let path = null;\n            switch (drawing.type) {\n                case 'path':\n                    path = {\n                        d: this.opsToPath(drawing),\n                        stroke: o.stroke,\n                        strokeWidth: o.strokeWidth,\n                        fill: 'none'\n                    };\n                    break;\n                case 'fillPath':\n                    path = {\n                        d: this.opsToPath(drawing),\n                        stroke: 'none',\n                        strokeWidth: 0,\n                        fill: o.fill || 'none'\n                    };\n                    break;\n                case 'fillSketch':\n                    path = this.fillSketch(drawing, o);\n                    break;\n                case 'path2Dfill':\n                    path = {\n                        d: drawing.path || '',\n                        stroke: 'none',\n                        strokeWidth: 0,\n                        fill: o.fill || 'none'\n                    };\n                    break;\n                case 'path2Dpattern': {\n                    const size = drawing.size;\n                    const pattern = {\n                        x: 0, y: 0, width: 1, height: 1,\n                        viewBox: `0 0 ${Math.round(size[0])} ${Math.round(size[1])}`,\n                        patternUnits: 'objectBoundingBox',\n                        path: this.fillSketch(drawing, o)\n                    };\n                    path = {\n                        d: drawing.path,\n                        stroke: 'none',\n                        strokeWidth: 0,\n                        pattern: pattern\n                    };\n                    break;\n                }\n            }\n            if (path) {\n                paths.push(path);\n            }\n        }\n        return paths;\n    }\n    fillSketch(drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        return {\n            d: this.opsToPath(drawing),\n            stroke: o.fill || 'none',\n            strokeWidth: fweight,\n            fill: 'none'\n        };\n    }\n    opsToPath(drawing) {\n        let path = '';\n        for (const item of drawing.ops) {\n            const data = item.data;\n            switch (item.op) {\n                case 'move':\n                    path += `M${data[0]} ${data[1]} `;\n                    break;\n                case 'bcurveTo':\n                    path += `C${data[0]} ${data[1]}, ${data[2]} ${data[3]}, ${data[4]} ${data[5]} `;\n                    break;\n                case 'qcurveTo':\n                    path += `Q${data[0]} ${data[1]}, ${data[2]} ${data[3]} `;\n                    break;\n                case 'lineTo':\n                    path += `L${data[0]} ${data[1]} `;\n                    break;\n            }\n        }\n        return path.trim();\n    }\n}\n","import { RoughGeneratorBase } from './generator-base';\nexport class RoughGenerator extends RoughGeneratorBase {\n    constructor(config, surface) {\n        super(config, surface);\n    }\n    line(x1, y1, x2, y2, options) {\n        const o = this._options(options);\n        return this._drawable('line', [this.lib.line(x1, y1, x2, y2, o)], o);\n    }\n    rectangle(x, y, width, height, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (o.fill) {\n            const points = [[x, y], [x + width, y], [x + width, y + height], [x, y + height]];\n            if (o.fillStyle === 'solid') {\n                paths.push(this.lib.solidFillPolygon(points, o));\n            }\n            else {\n                paths.push(this.lib.patternFillPolygon(points, o));\n            }\n        }\n        paths.push(this.lib.rectangle(x, y, width, height, o));\n        return this._drawable('rectangle', paths, o);\n    }\n    ellipse(x, y, width, height, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = this.lib.ellipse(x, y, width, height, o);\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(this.lib.patternFillEllipse(x, y, width, height, o));\n            }\n        }\n        paths.push(this.lib.ellipse(x, y, width, height, o));\n        return this._drawable('ellipse', paths, o);\n    }\n    circle(x, y, diameter, options) {\n        const ret = this.ellipse(x, y, diameter, diameter, options);\n        ret.shape = 'circle';\n        return ret;\n    }\n    linearPath(points, options) {\n        const o = this._options(options);\n        return this._drawable('linearPath', [this.lib.linearPath(points, false, o)], o);\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (closed && o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = this.lib.arc(x, y, width, height, start, stop, true, false, o);\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(this.lib.patternFillArc(x, y, width, height, start, stop, o));\n            }\n        }\n        paths.push(this.lib.arc(x, y, width, height, start, stop, closed, true, o));\n        return this._drawable('arc', paths, o);\n    }\n    curve(points, options) {\n        const o = this._options(options);\n        return this._drawable('curve', [this.lib.curve(points, o)], o);\n    }\n    polygon(points, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                paths.push(this.lib.solidFillPolygon(points, o));\n            }\n            else {\n                const size = this.computePolygonSize(points);\n                const fillPoints = [\n                    [0, 0],\n                    [size[0], 0],\n                    [size[0], size[1]],\n                    [0, size[1]]\n                ];\n                const shape = this.lib.patternFillPolygon(fillPoints, o);\n                shape.type = 'path2Dpattern';\n                shape.size = size;\n                shape.path = this.polygonPath(points);\n                paths.push(shape);\n            }\n        }\n        paths.push(this.lib.linearPath(points, true, o));\n        return this._drawable('polygon', paths, o);\n    }\n    path(d, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (!d) {\n            return this._drawable('path', paths, o);\n        }\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = { type: 'path2Dfill', path: d, ops: [] };\n                paths.push(shape);\n            }\n            else {\n                const size = this.computePathSize(d);\n                const points = [\n                    [0, 0],\n                    [size[0], 0],\n                    [size[0], size[1]],\n                    [0, size[1]]\n                ];\n                const shape = this.lib.patternFillPolygon(points, o);\n                shape.type = 'path2Dpattern';\n                shape.size = size;\n                shape.path = d;\n                paths.push(shape);\n            }\n        }\n        paths.push(this.lib.svgPath(d, o));\n        return this._drawable('path', paths, o);\n    }\n}\n","import { RoughRenderer } from './renderer';\nconst hasDocument = typeof document !== 'undefined';\nexport class RoughCanvasBase {\n    constructor(canvas) {\n        this.canvas = canvas;\n        this.ctx = this.canvas.getContext('2d');\n    }\n    static createRenderer() {\n        return new RoughRenderer();\n    }\n    draw(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.getDefaultOptions();\n        const ctx = this.ctx;\n        for (const drawing of sets) {\n            switch (drawing.type) {\n                case 'path':\n                    ctx.save();\n                    ctx.strokeStyle = o.stroke;\n                    ctx.lineWidth = o.strokeWidth;\n                    this._drawToContext(ctx, drawing);\n                    ctx.restore();\n                    break;\n                case 'fillPath':\n                    ctx.save();\n                    ctx.fillStyle = o.fill || '';\n                    this._drawToContext(ctx, drawing);\n                    ctx.restore();\n                    break;\n                case 'fillSketch':\n                    this.fillSketch(ctx, drawing, o);\n                    break;\n                case 'path2Dfill': {\n                    this.ctx.save();\n                    this.ctx.fillStyle = o.fill || '';\n                    const p2d = new Path2D(drawing.path);\n                    this.ctx.fill(p2d);\n                    this.ctx.restore();\n                    break;\n                }\n                case 'path2Dpattern': {\n                    const doc = this.canvas.ownerDocument || (hasDocument && document);\n                    if (doc) {\n                        const size = drawing.size;\n                        const hcanvas = doc.createElement('canvas');\n                        const hcontext = hcanvas.getContext('2d');\n                        const bbox = this.computeBBox(drawing.path);\n                        if (bbox && (bbox.width || bbox.height)) {\n                            hcanvas.width = this.canvas.width;\n                            hcanvas.height = this.canvas.height;\n                            hcontext.translate(bbox.x || 0, bbox.y || 0);\n                        }\n                        else {\n                            hcanvas.width = size[0];\n                            hcanvas.height = size[1];\n                        }\n                        this.fillSketch(hcontext, drawing, o);\n                        this.ctx.save();\n                        this.ctx.fillStyle = this.ctx.createPattern(hcanvas, 'repeat');\n                        const p2d = new Path2D(drawing.path);\n                        this.ctx.fill(p2d);\n                        this.ctx.restore();\n                    }\n                    else {\n                        console.error('Cannot render path2Dpattern. No defs/document defined.');\n                    }\n                    break;\n                }\n            }\n        }\n    }\n    computeBBox(d) {\n        if (hasDocument) {\n            try {\n                const ns = 'http://www.w3.org/2000/svg';\n                const svg = document.createElementNS(ns, 'svg');\n                svg.setAttribute('width', '0');\n                svg.setAttribute('height', '0');\n                const pathNode = self.document.createElementNS(ns, 'path');\n                pathNode.setAttribute('d', d);\n                svg.appendChild(pathNode);\n                document.body.appendChild(svg);\n                const bbox = pathNode.getBBox();\n                document.body.removeChild(svg);\n                return bbox;\n            }\n            catch (err) { }\n        }\n        return null;\n    }\n    fillSketch(ctx, drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        ctx.save();\n        ctx.strokeStyle = o.fill || '';\n        ctx.lineWidth = fweight;\n        this._drawToContext(ctx, drawing);\n        ctx.restore();\n    }\n    _drawToContext(ctx, drawing) {\n        ctx.beginPath();\n        for (const item of drawing.ops) {\n            const data = item.data;\n            switch (item.op) {\n                case 'move':\n                    ctx.moveTo(data[0], data[1]);\n                    break;\n                case 'bcurveTo':\n                    ctx.bezierCurveTo(data[0], data[1], data[2], data[3], data[4], data[5]);\n                    break;\n                case 'qcurveTo':\n                    ctx.quadraticCurveTo(data[0], data[1], data[2], data[3]);\n                    break;\n                case 'lineTo':\n                    ctx.lineTo(data[0], data[1]);\n                    break;\n            }\n        }\n        if (drawing.type === 'fillPath') {\n            ctx.fill();\n        }\n        else {\n            ctx.stroke();\n        }\n    }\n}\n","import { RoughGenerator } from './generator';\nimport { RoughCanvasBase } from './canvas-base';\nexport class RoughCanvas extends RoughCanvasBase {\n    constructor(canvas, config) {\n        super(canvas);\n        this.gen = new RoughGenerator(config || null, this.canvas);\n    }\n    get generator() {\n        return this.gen;\n    }\n    getDefaultOptions() {\n        return this.gen.defaultOptions;\n    }\n    line(x1, y1, x2, y2, options) {\n        const d = this.gen.line(x1, y1, x2, y2, options);\n        this.draw(d);\n        return d;\n    }\n    rectangle(x, y, width, height, options) {\n        const d = this.gen.rectangle(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    ellipse(x, y, width, height, options) {\n        const d = this.gen.ellipse(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    circle(x, y, diameter, options) {\n        const d = this.gen.circle(x, y, diameter, options);\n        this.draw(d);\n        return d;\n    }\n    linearPath(points, options) {\n        const d = this.gen.linearPath(points, options);\n        this.draw(d);\n        return d;\n    }\n    polygon(points, options) {\n        const d = this.gen.polygon(points, options);\n        this.draw(d);\n        return d;\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const d = this.gen.arc(x, y, width, height, start, stop, closed, options);\n        this.draw(d);\n        return d;\n    }\n    curve(points, options) {\n        const d = this.gen.curve(points, options);\n        this.draw(d);\n        return d;\n    }\n    path(d, options) {\n        const drawing = this.gen.path(d, options);\n        this.draw(drawing);\n        return drawing;\n    }\n}\n","import { RoughGeneratorBase } from './generator-base';\nexport class RoughGeneratorAsync extends RoughGeneratorBase {\n    async line(x1, y1, x2, y2, options) {\n        const o = this._options(options);\n        return this._drawable('line', [await this.lib.line(x1, y1, x2, y2, o)], o);\n    }\n    async rectangle(x, y, width, height, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (o.fill) {\n            const points = [[x, y], [x + width, y], [x + width, y + height], [x, y + height]];\n            if (o.fillStyle === 'solid') {\n                paths.push(await this.lib.solidFillPolygon(points, o));\n            }\n            else {\n                paths.push(await this.lib.patternFillPolygon(points, o));\n            }\n        }\n        paths.push(await this.lib.rectangle(x, y, width, height, o));\n        return this._drawable('rectangle', paths, o);\n    }\n    async ellipse(x, y, width, height, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = await this.lib.ellipse(x, y, width, height, o);\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(await this.lib.patternFillEllipse(x, y, width, height, o));\n            }\n        }\n        paths.push(await this.lib.ellipse(x, y, width, height, o));\n        return this._drawable('ellipse', paths, o);\n    }\n    async circle(x, y, diameter, options) {\n        const ret = await this.ellipse(x, y, diameter, diameter, options);\n        ret.shape = 'circle';\n        return ret;\n    }\n    async linearPath(points, options) {\n        const o = this._options(options);\n        return this._drawable('linearPath', [await this.lib.linearPath(points, false, o)], o);\n    }\n    async arc(x, y, width, height, start, stop, closed = false, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (closed && o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = await this.lib.arc(x, y, width, height, start, stop, true, false, o);\n                shape.type = 'fillPath';\n                paths.push(shape);\n            }\n            else {\n                paths.push(await this.lib.patternFillArc(x, y, width, height, start, stop, o));\n            }\n        }\n        paths.push(await this.lib.arc(x, y, width, height, start, stop, closed, true, o));\n        return this._drawable('arc', paths, o);\n    }\n    async curve(points, options) {\n        const o = this._options(options);\n        return this._drawable('curve', [await this.lib.curve(points, o)], o);\n    }\n    async polygon(points, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                paths.push(await this.lib.solidFillPolygon(points, o));\n            }\n            else {\n                const size = this.computePolygonSize(points);\n                const fillPoints = [\n                    [0, 0],\n                    [size[0], 0],\n                    [size[0], size[1]],\n                    [0, size[1]]\n                ];\n                const shape = await this.lib.patternFillPolygon(fillPoints, o);\n                shape.type = 'path2Dpattern';\n                shape.size = size;\n                shape.path = this.polygonPath(points);\n                paths.push(shape);\n            }\n        }\n        paths.push(await this.lib.linearPath(points, true, o));\n        return this._drawable('polygon', paths, o);\n    }\n    async path(d, options) {\n        const o = this._options(options);\n        const paths = [];\n        if (!d) {\n            return this._drawable('path', paths, o);\n        }\n        if (o.fill) {\n            if (o.fillStyle === 'solid') {\n                const shape = { type: 'path2Dfill', path: d, ops: [] };\n                paths.push(shape);\n            }\n            else {\n                const size = this.computePathSize(d);\n                const points = [\n                    [0, 0],\n                    [size[0], 0],\n                    [size[0], size[1]],\n                    [0, size[1]]\n                ];\n                const shape = await this.lib.patternFillPolygon(points, o);\n                shape.type = 'path2Dpattern';\n                shape.size = size;\n                shape.path = d;\n                paths.push(shape);\n            }\n        }\n        paths.push(await this.lib.svgPath(d, o));\n        return this._drawable('path', paths, o);\n    }\n}\n","import { RoughGeneratorAsync } from './generator-async';\nimport { RoughCanvasBase } from './canvas-base';\nexport class RoughCanvasAsync extends RoughCanvasBase {\n    constructor(canvas, config) {\n        super(canvas);\n        this.genAsync = new RoughGeneratorAsync(config || null, this.canvas);\n    }\n    get generator() {\n        return this.genAsync;\n    }\n    getDefaultOptions() {\n        return this.genAsync.defaultOptions;\n    }\n    async line(x1, y1, x2, y2, options) {\n        const d = await this.genAsync.line(x1, y1, x2, y2, options);\n        this.draw(d);\n        return d;\n    }\n    async rectangle(x, y, width, height, options) {\n        const d = await this.genAsync.rectangle(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    async ellipse(x, y, width, height, options) {\n        const d = await this.genAsync.ellipse(x, y, width, height, options);\n        this.draw(d);\n        return d;\n    }\n    async circle(x, y, diameter, options) {\n        const d = await this.genAsync.circle(x, y, diameter, options);\n        this.draw(d);\n        return d;\n    }\n    async linearPath(points, options) {\n        const d = await this.genAsync.linearPath(points, options);\n        this.draw(d);\n        return d;\n    }\n    async polygon(points, options) {\n        const d = await this.genAsync.polygon(points, options);\n        this.draw(d);\n        return d;\n    }\n    async arc(x, y, width, height, start, stop, closed = false, options) {\n        const d = await this.genAsync.arc(x, y, width, height, start, stop, closed, options);\n        this.draw(d);\n        return d;\n    }\n    async curve(points, options) {\n        const d = await this.genAsync.curve(points, options);\n        this.draw(d);\n        return d;\n    }\n    async path(d, options) {\n        const drawing = await this.genAsync.path(d, options);\n        this.draw(drawing);\n        return drawing;\n    }\n}\n","import { RoughRenderer } from './renderer';\nconst hasDocument = typeof document !== 'undefined';\nexport class RoughSVGBase {\n    constructor(svg) {\n        this.svg = svg;\n    }\n    static createRenderer() {\n        return new RoughRenderer();\n    }\n    get defs() {\n        const doc = this.svg.ownerDocument || (hasDocument && document);\n        if (doc) {\n            if (!this._defs) {\n                const dnode = doc.createElementNS('http://www.w3.org/2000/svg', 'defs');\n                if (this.svg.firstChild) {\n                    this.svg.insertBefore(dnode, this.svg.firstChild);\n                }\n                else {\n                    this.svg.appendChild(dnode);\n                }\n                this._defs = dnode;\n            }\n        }\n        return this._defs || null;\n    }\n    draw(drawable) {\n        const sets = drawable.sets || [];\n        const o = drawable.options || this.getDefaultOptions();\n        const doc = this.svg.ownerDocument || (hasDocument && document);\n        const g = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n        for (const drawing of sets) {\n            let path = null;\n            switch (drawing.type) {\n                case 'path': {\n                    path = doc.createElementNS('http://www.w3.org/2000/svg', 'path');\n                    path.setAttribute('d', this.opsToPath(drawing));\n                    path.style.stroke = o.stroke;\n                    path.style.strokeWidth = o.strokeWidth + '';\n                    path.style.fill = 'none';\n                    break;\n                }\n                case 'fillPath': {\n                    path = doc.createElementNS('http://www.w3.org/2000/svg', 'path');\n                    path.setAttribute('d', this.opsToPath(drawing));\n                    path.style.stroke = 'none';\n                    path.style.strokeWidth = '0';\n                    path.style.fill = o.fill || null;\n                    break;\n                }\n                case 'fillSketch': {\n                    path = this.fillSketch(doc, drawing, o);\n                    break;\n                }\n                case 'path2Dfill': {\n                    path = doc.createElementNS('http://www.w3.org/2000/svg', 'path');\n                    path.setAttribute('d', drawing.path || '');\n                    path.style.stroke = 'none';\n                    path.style.strokeWidth = '0';\n                    path.style.fill = o.fill || null;\n                    break;\n                }\n                case 'path2Dpattern': {\n                    if (!this.defs) {\n                        console.error('Cannot render path2Dpattern. No defs/document defined.');\n                    }\n                    else {\n                        const size = drawing.size;\n                        const pattern = doc.createElementNS('http://www.w3.org/2000/svg', 'pattern');\n                        const id = `rough-${Math.floor(Math.random() * (Number.MAX_SAFE_INTEGER || 999999))}`;\n                        pattern.setAttribute('id', id);\n                        pattern.setAttribute('x', '0');\n                        pattern.setAttribute('y', '0');\n                        pattern.setAttribute('width', '1');\n                        pattern.setAttribute('height', '1');\n                        pattern.setAttribute('height', '1');\n                        pattern.setAttribute('viewBox', `0 0 ${Math.round(size[0])} ${Math.round(size[1])}`);\n                        pattern.setAttribute('patternUnits', 'objectBoundingBox');\n                        const patternPath = this.fillSketch(doc, drawing, o);\n                        pattern.appendChild(patternPath);\n                        this.defs.appendChild(pattern);\n                        path = doc.createElementNS('http://www.w3.org/2000/svg', 'path');\n                        path.setAttribute('d', drawing.path || '');\n                        path.style.stroke = 'none';\n                        path.style.strokeWidth = '0';\n                        path.style.fill = `url(#${id})`;\n                    }\n                    break;\n                }\n            }\n            if (path) {\n                g.appendChild(path);\n            }\n        }\n        return g;\n    }\n    fillSketch(doc, drawing, o) {\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        const path = doc.createElementNS('http://www.w3.org/2000/svg', 'path');\n        path.setAttribute('d', this.opsToPath(drawing));\n        path.style.stroke = o.fill || null;\n        path.style.strokeWidth = fweight + '';\n        path.style.fill = 'none';\n        return path;\n    }\n}\n","import { RoughGenerator } from './generator';\nimport { RoughSVGBase } from './svg-base';\nexport class RoughSVG extends RoughSVGBase {\n    constructor(svg, config) {\n        super(svg);\n        this.gen = new RoughGenerator(config || null, this.svg);\n    }\n    get generator() {\n        return this.gen;\n    }\n    getDefaultOptions() {\n        return this.gen.defaultOptions;\n    }\n    opsToPath(drawing) {\n        return this.gen.opsToPath(drawing);\n    }\n    line(x1, y1, x2, y2, options) {\n        const d = this.gen.line(x1, y1, x2, y2, options);\n        return this.draw(d);\n    }\n    rectangle(x, y, width, height, options) {\n        const d = this.gen.rectangle(x, y, width, height, options);\n        return this.draw(d);\n    }\n    ellipse(x, y, width, height, options) {\n        const d = this.gen.ellipse(x, y, width, height, options);\n        return this.draw(d);\n    }\n    circle(x, y, diameter, options) {\n        const d = this.gen.circle(x, y, diameter, options);\n        return this.draw(d);\n    }\n    linearPath(points, options) {\n        const d = this.gen.linearPath(points, options);\n        return this.draw(d);\n    }\n    polygon(points, options) {\n        const d = this.gen.polygon(points, options);\n        return this.draw(d);\n    }\n    arc(x, y, width, height, start, stop, closed = false, options) {\n        const d = this.gen.arc(x, y, width, height, start, stop, closed, options);\n        return this.draw(d);\n    }\n    curve(points, options) {\n        const d = this.gen.curve(points, options);\n        return this.draw(d);\n    }\n    path(d, options) {\n        const drawing = this.gen.path(d, options);\n        return this.draw(drawing);\n    }\n}\n","import { RoughGeneratorAsync } from './generator-async';\nimport { RoughSVGBase } from './svg-base';\nexport class RoughSVGAsync extends RoughSVGBase {\n    constructor(svg, config) {\n        super(svg);\n        this.genAsync = new RoughGeneratorAsync(config || null, this.svg);\n    }\n    get generator() {\n        return this.genAsync;\n    }\n    getDefaultOptions() {\n        return this.genAsync.defaultOptions;\n    }\n    opsToPath(drawing) {\n        return this.genAsync.opsToPath(drawing);\n    }\n    async line(x1, y1, x2, y2, options) {\n        const d = await this.genAsync.line(x1, y1, x2, y2, options);\n        return this.draw(d);\n    }\n    async rectangle(x, y, width, height, options) {\n        const d = await this.genAsync.rectangle(x, y, width, height, options);\n        return this.draw(d);\n    }\n    async ellipse(x, y, width, height, options) {\n        const d = await this.genAsync.ellipse(x, y, width, height, options);\n        return this.draw(d);\n    }\n    async circle(x, y, diameter, options) {\n        const d = await this.genAsync.circle(x, y, diameter, options);\n        return this.draw(d);\n    }\n    async linearPath(points, options) {\n        const d = await this.genAsync.linearPath(points, options);\n        return this.draw(d);\n    }\n    async polygon(points, options) {\n        const d = await this.genAsync.polygon(points, options);\n        return this.draw(d);\n    }\n    async arc(x, y, width, height, start, stop, closed = false, options) {\n        const d = await this.genAsync.arc(x, y, width, height, start, stop, closed, options);\n        return this.draw(d);\n    }\n    async curve(points, options) {\n        const d = await this.genAsync.curve(points, options);\n        return this.draw(d);\n    }\n    async path(d, options) {\n        const drawing = await this.genAsync.path(d, options);\n        return this.draw(drawing);\n    }\n}\n","import { RoughCanvas } from './canvas';\nimport { RoughGenerator } from './generator';\nimport { RoughGeneratorAsync } from './generator-async';\nimport { RoughCanvasAsync } from './canvas-async';\nimport { RoughSVG } from './svg';\nimport { RoughSVGAsync } from './svg-async';\nexport default {\n    canvas(canvas, config) {\n        if (config && config.async) {\n            return new RoughCanvasAsync(canvas, config);\n        }\n        return new RoughCanvas(canvas, config);\n    },\n    svg(svg, config) {\n        if (config && config.async) {\n            return new RoughSVGAsync(svg, config);\n        }\n        return new RoughSVG(svg, config);\n    },\n    createRenderer() {\n        return RoughCanvas.createRenderer();\n    },\n    generator(config, surface) {\n        if (config && config.async) {\n            return new RoughGeneratorAsync(config, surface);\n        }\n        return new RoughGenerator(config, surface);\n    }\n};\n","import rough from 'roughjs'\n\nfunction Drawable () {\n  this.createAndAppend = function (parent) {\n    this.element = document.createElement('canvas')\n    parent.appendChild(this.element)\n    this.context2d = this.element.getContext('2d')\n    this.roughCanvas = rough.canvas(this.element)\n  }\n  this.resize = function (size) {\n    this.element.width = size.width\n    this.element.height = size.height\n  }\n  this.getSize = function () {\n    return {\n      width: this.element.width,\n      height: this.element.height\n    }\n  }\n  this.clear = function () {\n    this.context2d.clearRect(0, 0, this.element.width, this.element.height)\n  }\n\n  this.element = null\n  this.context2d = null\n  this.roughCanvas = null\n}\n\nexport default Drawable\n","var binaryFeatures = {};\r\nbinaryFeatures.useBlobBuilder = (function(){\r\n  try {\r\n    new Blob([]);\r\n    return false;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n})();\r\n\r\nbinaryFeatures.useArrayBufferView = !binaryFeatures.useBlobBuilder && (function(){\r\n  try {\r\n    return (new Blob([new Uint8Array([])])).size === 0;\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n})();\r\n\r\nmodule.exports.binaryFeatures = binaryFeatures;\r\nvar BlobBuilder = module.exports.BlobBuilder;\r\nif (typeof window != 'undefined') {\r\n  BlobBuilder = module.exports.BlobBuilder = window.WebKitBlobBuilder ||\r\n    window.MozBlobBuilder || window.MSBlobBuilder || window.BlobBuilder;\r\n}\r\n\r\nfunction BufferBuilder(){\r\n  this._pieces = [];\r\n  this._parts = [];\r\n}\r\n\r\nBufferBuilder.prototype.append = function(data) {\r\n  if(typeof data === 'number') {\r\n    this._pieces.push(data);\r\n  } else {\r\n    this.flush();\r\n    this._parts.push(data);\r\n  }\r\n};\r\n\r\nBufferBuilder.prototype.flush = function() {\r\n  if (this._pieces.length > 0) {\r\n    var buf = new Uint8Array(this._pieces);\r\n    if(!binaryFeatures.useArrayBufferView) {\r\n      buf = buf.buffer;\r\n    }\r\n    this._parts.push(buf);\r\n    this._pieces = [];\r\n  }\r\n};\r\n\r\nBufferBuilder.prototype.getBuffer = function() {\r\n  this.flush();\r\n  if(binaryFeatures.useBlobBuilder) {\r\n    var builder = new BlobBuilder();\r\n    for(var i = 0, ii = this._parts.length; i < ii; i++) {\r\n      builder.append(this._parts[i]);\r\n    }\r\n    return builder.getBlob();\r\n  } else {\r\n    return new Blob(this._parts);\r\n  }\r\n};\r\n\r\nmodule.exports.BufferBuilder = BufferBuilder;\r\n","var BufferBuilder = require('./bufferbuilder').BufferBuilder;\r\nvar binaryFeatures = require('./bufferbuilder').binaryFeatures;\r\n\r\nvar BinaryPack = {\r\n  unpack: function(data){\r\n    var unpacker = new Unpacker(data);\r\n    return unpacker.unpack();\r\n  },\r\n  pack: function(data){\r\n    var packer = new Packer();\r\n    packer.pack(data);\r\n    var buffer = packer.getBuffer();\r\n    return buffer;\r\n  }\r\n};\r\n\r\nmodule.exports = BinaryPack;\r\n\r\nfunction Unpacker (data){\r\n  // Data is ArrayBuffer\r\n  this.index = 0;\r\n  this.dataBuffer = data;\r\n  this.dataView = new Uint8Array(this.dataBuffer);\r\n  this.length = this.dataBuffer.byteLength;\r\n}\r\n\r\nUnpacker.prototype.unpack = function(){\r\n  var type = this.unpack_uint8();\r\n  if (type < 0x80){\r\n    var positive_fixnum = type;\r\n    return positive_fixnum;\r\n  } else if ((type ^ 0xe0) < 0x20){\r\n    var negative_fixnum = (type ^ 0xe0) - 0x20;\r\n    return negative_fixnum;\r\n  }\r\n  var size;\r\n  if ((size = type ^ 0xa0) <= 0x0f){\r\n    return this.unpack_raw(size);\r\n  } else if ((size = type ^ 0xb0) <= 0x0f){\r\n    return this.unpack_string(size);\r\n  } else if ((size = type ^ 0x90) <= 0x0f){\r\n    return this.unpack_array(size);\r\n  } else if ((size = type ^ 0x80) <= 0x0f){\r\n    return this.unpack_map(size);\r\n  }\r\n  switch(type){\r\n    case 0xc0:\r\n      return null;\r\n    case 0xc1:\r\n      return undefined;\r\n    case 0xc2:\r\n      return false;\r\n    case 0xc3:\r\n      return true;\r\n    case 0xca:\r\n      return this.unpack_float();\r\n    case 0xcb:\r\n      return this.unpack_double();\r\n    case 0xcc:\r\n      return this.unpack_uint8();\r\n    case 0xcd:\r\n      return this.unpack_uint16();\r\n    case 0xce:\r\n      return this.unpack_uint32();\r\n    case 0xcf:\r\n      return this.unpack_uint64();\r\n    case 0xd0:\r\n      return this.unpack_int8();\r\n    case 0xd1:\r\n      return this.unpack_int16();\r\n    case 0xd2:\r\n      return this.unpack_int32();\r\n    case 0xd3:\r\n      return this.unpack_int64();\r\n    case 0xd4:\r\n      return undefined;\r\n    case 0xd5:\r\n      return undefined;\r\n    case 0xd6:\r\n      return undefined;\r\n    case 0xd7:\r\n      return undefined;\r\n    case 0xd8:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_string(size);\r\n    case 0xd9:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_string(size);\r\n    case 0xda:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_raw(size);\r\n    case 0xdb:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_raw(size);\r\n    case 0xdc:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_array(size);\r\n    case 0xdd:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_array(size);\r\n    case 0xde:\r\n      size = this.unpack_uint16();\r\n      return this.unpack_map(size);\r\n    case 0xdf:\r\n      size = this.unpack_uint32();\r\n      return this.unpack_map(size);\r\n  }\r\n}\r\n\r\nUnpacker.prototype.unpack_uint8 = function(){\r\n  var byte = this.dataView[this.index] & 0xff;\r\n  this.index++;\r\n  return byte;\r\n};\r\n\r\nUnpacker.prototype.unpack_uint16 = function(){\r\n  var bytes = this.read(2);\r\n  var uint16 =\r\n    ((bytes[0] & 0xff) * 256) + (bytes[1] & 0xff);\r\n  this.index += 2;\r\n  return uint16;\r\n}\r\n\r\nUnpacker.prototype.unpack_uint32 = function(){\r\n  var bytes = this.read(4);\r\n  var uint32 =\r\n     ((bytes[0]  * 256 +\r\n       bytes[1]) * 256 +\r\n       bytes[2]) * 256 +\r\n       bytes[3];\r\n  this.index += 4;\r\n  return uint32;\r\n}\r\n\r\nUnpacker.prototype.unpack_uint64 = function(){\r\n  var bytes = this.read(8);\r\n  var uint64 =\r\n   ((((((bytes[0]  * 256 +\r\n       bytes[1]) * 256 +\r\n       bytes[2]) * 256 +\r\n       bytes[3]) * 256 +\r\n       bytes[4]) * 256 +\r\n       bytes[5]) * 256 +\r\n       bytes[6]) * 256 +\r\n       bytes[7];\r\n  this.index += 8;\r\n  return uint64;\r\n}\r\n\r\n\r\nUnpacker.prototype.unpack_int8 = function(){\r\n  var uint8 = this.unpack_uint8();\r\n  return (uint8 < 0x80 ) ? uint8 : uint8 - (1 << 8);\r\n};\r\n\r\nUnpacker.prototype.unpack_int16 = function(){\r\n  var uint16 = this.unpack_uint16();\r\n  return (uint16 < 0x8000 ) ? uint16 : uint16 - (1 << 16);\r\n}\r\n\r\nUnpacker.prototype.unpack_int32 = function(){\r\n  var uint32 = this.unpack_uint32();\r\n  return (uint32 < Math.pow(2, 31) ) ? uint32 :\r\n    uint32 - Math.pow(2, 32);\r\n}\r\n\r\nUnpacker.prototype.unpack_int64 = function(){\r\n  var uint64 = this.unpack_uint64();\r\n  return (uint64 < Math.pow(2, 63) ) ? uint64 :\r\n    uint64 - Math.pow(2, 64);\r\n}\r\n\r\nUnpacker.prototype.unpack_raw = function(size){\r\n  if ( this.length < this.index + size){\r\n    throw new Error('BinaryPackFailure: index is out of range'\r\n      + ' ' + this.index + ' ' + size + ' ' + this.length);\r\n  }\r\n  var buf = this.dataBuffer.slice(this.index, this.index + size);\r\n  this.index += size;\r\n\r\n    //buf = util.bufferToString(buf);\r\n\r\n  return buf;\r\n}\r\n\r\nUnpacker.prototype.unpack_string = function(size){\r\n  var bytes = this.read(size);\r\n  var i = 0, str = '', c, code;\r\n  while(i < size){\r\n    c = bytes[i];\r\n    if ( c < 128){\r\n      str += String.fromCharCode(c);\r\n      i++;\r\n    } else if ((c ^ 0xc0) < 32){\r\n      code = ((c ^ 0xc0) << 6) | (bytes[i+1] & 63);\r\n      str += String.fromCharCode(code);\r\n      i += 2;\r\n    } else {\r\n      code = ((c & 15) << 12) | ((bytes[i+1] & 63) << 6) |\r\n        (bytes[i+2] & 63);\r\n      str += String.fromCharCode(code);\r\n      i += 3;\r\n    }\r\n  }\r\n  this.index += size;\r\n  return str;\r\n}\r\n\r\nUnpacker.prototype.unpack_array = function(size){\r\n  var objects = new Array(size);\r\n  for(var i = 0; i < size ; i++){\r\n    objects[i] = this.unpack();\r\n  }\r\n  return objects;\r\n}\r\n\r\nUnpacker.prototype.unpack_map = function(size){\r\n  var map = {};\r\n  for(var i = 0; i < size ; i++){\r\n    var key  = this.unpack();\r\n    var value = this.unpack();\r\n    map[key] = value;\r\n  }\r\n  return map;\r\n}\r\n\r\nUnpacker.prototype.unpack_float = function(){\r\n  var uint32 = this.unpack_uint32();\r\n  var sign = uint32 >> 31;\r\n  var exp  = ((uint32 >> 23) & 0xff) - 127;\r\n  var fraction = ( uint32 & 0x7fffff ) | 0x800000;\r\n  return (sign == 0 ? 1 : -1) *\r\n    fraction * Math.pow(2, exp - 23);\r\n}\r\n\r\nUnpacker.prototype.unpack_double = function(){\r\n  var h32 = this.unpack_uint32();\r\n  var l32 = this.unpack_uint32();\r\n  var sign = h32 >> 31;\r\n  var exp  = ((h32 >> 20) & 0x7ff) - 1023;\r\n  var hfrac = ( h32 & 0xfffff ) | 0x100000;\r\n  var frac = hfrac * Math.pow(2, exp - 20) +\r\n    l32   * Math.pow(2, exp - 52);\r\n  return (sign == 0 ? 1 : -1) * frac;\r\n}\r\n\r\nUnpacker.prototype.read = function(length){\r\n  var j = this.index;\r\n  if (j + length <= this.length) {\r\n    return this.dataView.subarray(j, j + length);\r\n  } else {\r\n    throw new Error('BinaryPackFailure: read index out of range');\r\n  }\r\n}\r\n\r\nfunction Packer(){\r\n  this.bufferBuilder = new BufferBuilder();\r\n}\r\n\r\nPacker.prototype.getBuffer = function(){\r\n  return this.bufferBuilder.getBuffer();\r\n}\r\n\r\nPacker.prototype.pack = function(value){\r\n  var type = typeof(value);\r\n  if (type == 'string'){\r\n    this.pack_string(value);\r\n  } else if (type == 'number'){\r\n    if (Math.floor(value) === value){\r\n      this.pack_integer(value);\r\n    } else{\r\n      this.pack_double(value);\r\n    }\r\n  } else if (type == 'boolean'){\r\n    if (value === true){\r\n      this.bufferBuilder.append(0xc3);\r\n    } else if (value === false){\r\n      this.bufferBuilder.append(0xc2);\r\n    }\r\n  } else if (type == 'undefined'){\r\n    this.bufferBuilder.append(0xc0);\r\n  } else if (type == 'object'){\r\n    if (value === null){\r\n      this.bufferBuilder.append(0xc0);\r\n    } else {\r\n      var constructor = value.constructor;\r\n      if (constructor == Array){\r\n        this.pack_array(value);\r\n      } else if (constructor == Blob || constructor == File) {\r\n        this.pack_bin(value);\r\n      } else if (constructor == ArrayBuffer) {\r\n        if(binaryFeatures.useArrayBufferView) {\r\n          this.pack_bin(new Uint8Array(value));\r\n        } else {\r\n          this.pack_bin(value);\r\n        }\r\n      } else if ('BYTES_PER_ELEMENT' in value){\r\n        if(binaryFeatures.useArrayBufferView) {\r\n          this.pack_bin(new Uint8Array(value.buffer));\r\n        } else {\r\n          this.pack_bin(value.buffer);\r\n        }\r\n      } else if (constructor == Object){\r\n        this.pack_object(value);\r\n      } else if (constructor == Date){\r\n        this.pack_string(value.toString());\r\n      } else if (typeof value.toBinaryPack == 'function'){\r\n        this.bufferBuilder.append(value.toBinaryPack());\r\n      } else {\r\n        throw new Error('Type \"' + constructor.toString() + '\" not yet supported');\r\n      }\r\n    }\r\n  } else {\r\n    throw new Error('Type \"' + type + '\" not yet supported');\r\n  }\r\n  this.bufferBuilder.flush();\r\n}\r\n\r\n\r\nPacker.prototype.pack_bin = function(blob){\r\n  var length = blob.length || blob.byteLength || blob.size;\r\n  if (length <= 0x0f){\r\n    this.pack_uint8(0xa0 + length);\r\n  } else if (length <= 0xffff){\r\n    this.bufferBuilder.append(0xda) ;\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff){\r\n    this.bufferBuilder.append(0xdb);\r\n    this.pack_uint32(length);\r\n  } else{\r\n    throw new Error('Invalid length');\r\n  }\r\n  this.bufferBuilder.append(blob);\r\n}\r\n\r\nPacker.prototype.pack_string = function(str){\r\n  var length = utf8Length(str);\r\n\r\n  if (length <= 0x0f){\r\n    this.pack_uint8(0xb0 + length);\r\n  } else if (length <= 0xffff){\r\n    this.bufferBuilder.append(0xd8) ;\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff){\r\n    this.bufferBuilder.append(0xd9);\r\n    this.pack_uint32(length);\r\n  } else{\r\n    throw new Error('Invalid length');\r\n  }\r\n  this.bufferBuilder.append(str);\r\n}\r\n\r\nPacker.prototype.pack_array = function(ary){\r\n  var length = ary.length;\r\n  if (length <= 0x0f){\r\n    this.pack_uint8(0x90 + length);\r\n  } else if (length <= 0xffff){\r\n    this.bufferBuilder.append(0xdc)\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff){\r\n    this.bufferBuilder.append(0xdd);\r\n    this.pack_uint32(length);\r\n  } else{\r\n    throw new Error('Invalid length');\r\n  }\r\n  for(var i = 0; i < length ; i++){\r\n    this.pack(ary[i]);\r\n  }\r\n}\r\n\r\nPacker.prototype.pack_integer = function(num){\r\n  if ( -0x20 <= num && num <= 0x7f){\r\n    this.bufferBuilder.append(num & 0xff);\r\n  } else if (0x00 <= num && num <= 0xff){\r\n    this.bufferBuilder.append(0xcc);\r\n    this.pack_uint8(num);\r\n  } else if (-0x80 <= num && num <= 0x7f){\r\n    this.bufferBuilder.append(0xd0);\r\n    this.pack_int8(num);\r\n  } else if ( 0x0000 <= num && num <= 0xffff){\r\n    this.bufferBuilder.append(0xcd);\r\n    this.pack_uint16(num);\r\n  } else if (-0x8000 <= num && num <= 0x7fff){\r\n    this.bufferBuilder.append(0xd1);\r\n    this.pack_int16(num);\r\n  } else if ( 0x00000000 <= num && num <= 0xffffffff){\r\n    this.bufferBuilder.append(0xce);\r\n    this.pack_uint32(num);\r\n  } else if (-0x80000000 <= num && num <= 0x7fffffff){\r\n    this.bufferBuilder.append(0xd2);\r\n    this.pack_int32(num);\r\n  } else if (-0x8000000000000000 <= num && num <= 0x7FFFFFFFFFFFFFFF){\r\n    this.bufferBuilder.append(0xd3);\r\n    this.pack_int64(num);\r\n  } else if (0x0000000000000000 <= num && num <= 0xFFFFFFFFFFFFFFFF){\r\n    this.bufferBuilder.append(0xcf);\r\n    this.pack_uint64(num);\r\n  } else{\r\n    throw new Error('Invalid integer');\r\n  }\r\n}\r\n\r\nPacker.prototype.pack_double = function(num){\r\n  var sign = 0;\r\n  if (num < 0){\r\n    sign = 1;\r\n    num = -num;\r\n  }\r\n  var exp  = Math.floor(Math.log(num) / Math.LN2);\r\n  var frac0 = num / Math.pow(2, exp) - 1;\r\n  var frac1 = Math.floor(frac0 * Math.pow(2, 52));\r\n  var b32   = Math.pow(2, 32);\r\n  var h32 = (sign << 31) | ((exp+1023) << 20) |\r\n      (frac1 / b32) & 0x0fffff;\r\n  var l32 = frac1 % b32;\r\n  this.bufferBuilder.append(0xcb);\r\n  this.pack_int32(h32);\r\n  this.pack_int32(l32);\r\n}\r\n\r\nPacker.prototype.pack_object = function(obj){\r\n  var keys = Object.keys(obj);\r\n  var length = keys.length;\r\n  if (length <= 0x0f){\r\n    this.pack_uint8(0x80 + length);\r\n  } else if (length <= 0xffff){\r\n    this.bufferBuilder.append(0xde);\r\n    this.pack_uint16(length);\r\n  } else if (length <= 0xffffffff){\r\n    this.bufferBuilder.append(0xdf);\r\n    this.pack_uint32(length);\r\n  } else{\r\n    throw new Error('Invalid length');\r\n  }\r\n  for(var prop in obj){\r\n    if (obj.hasOwnProperty(prop)){\r\n      this.pack(prop);\r\n      this.pack(obj[prop]);\r\n    }\r\n  }\r\n}\r\n\r\nPacker.prototype.pack_uint8 = function(num){\r\n  this.bufferBuilder.append(num);\r\n}\r\n\r\nPacker.prototype.pack_uint16 = function(num){\r\n  this.bufferBuilder.append(num >> 8);\r\n  this.bufferBuilder.append(num & 0xff);\r\n}\r\n\r\nPacker.prototype.pack_uint32 = function(num){\r\n  var n = num & 0xffffffff;\r\n  this.bufferBuilder.append((n & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((n & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((n & 0x0000ff00) >>>  8);\r\n  this.bufferBuilder.append((n & 0x000000ff));\r\n}\r\n\r\nPacker.prototype.pack_uint64 = function(num){\r\n  var high = num / Math.pow(2, 32);\r\n  var low  = num % Math.pow(2, 32);\r\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((high & 0x0000ff00) >>>  8);\r\n  this.bufferBuilder.append((high & 0x000000ff));\r\n  this.bufferBuilder.append((low  & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((low  & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((low  & 0x0000ff00) >>>  8);\r\n  this.bufferBuilder.append((low  & 0x000000ff));\r\n}\r\n\r\nPacker.prototype.pack_int8 = function(num){\r\n  this.bufferBuilder.append(num & 0xff);\r\n}\r\n\r\nPacker.prototype.pack_int16 = function(num){\r\n  this.bufferBuilder.append((num & 0xff00) >> 8);\r\n  this.bufferBuilder.append(num & 0xff);\r\n}\r\n\r\nPacker.prototype.pack_int32 = function(num){\r\n  this.bufferBuilder.append((num >>> 24) & 0xff);\r\n  this.bufferBuilder.append((num & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((num & 0x0000ff00) >>> 8);\r\n  this.bufferBuilder.append((num & 0x000000ff));\r\n}\r\n\r\nPacker.prototype.pack_int64 = function(num){\r\n  var high = Math.floor(num / Math.pow(2, 32));\r\n  var low  = num % Math.pow(2, 32);\r\n  this.bufferBuilder.append((high & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((high & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((high & 0x0000ff00) >>>  8);\r\n  this.bufferBuilder.append((high & 0x000000ff));\r\n  this.bufferBuilder.append((low  & 0xff000000) >>> 24);\r\n  this.bufferBuilder.append((low  & 0x00ff0000) >>> 16);\r\n  this.bufferBuilder.append((low  & 0x0000ff00) >>>  8);\r\n  this.bufferBuilder.append((low  & 0x000000ff));\r\n}\r\n\r\nfunction _utf8Replace(m){\r\n  var code = m.charCodeAt(0);\r\n\r\n  if(code <= 0x7ff) return '00';\r\n  if(code <= 0xffff) return '000';\r\n  if(code <= 0x1fffff) return '0000';\r\n  if(code <= 0x3ffffff) return '00000';\r\n  return '000000';\r\n}\r\n\r\nfunction utf8Length(str){\r\n  if (str.length > 600) {\r\n    // Blob method faster for large strings\r\n    return (new Blob([str])).size;\r\n  } else {\r\n    return str.replace(/[^\\u0000-\\u007F]/g, _utf8Replace).length;\r\n  }\r\n}\r\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar logDisabled_ = true;\nvar deprecationWarnings_ = true;\n\n/**\n * Extract browser version out of the provided user agent string.\n *\n * @param {!string} uastring userAgent string.\n * @param {!string} expr Regular expression used as match criteria.\n * @param {!number} pos position in the version string to be returned.\n * @return {!number} browser version.\n */\nfunction extractVersion(uastring, expr, pos) {\n  var match = uastring.match(expr);\n  return match && match.length >= pos && parseInt(match[pos], 10);\n}\n\n// Wraps the peerconnection event eventNameToWrap in a function\n// which returns the modified event object (or false to prevent\n// the event).\nfunction wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n  if (!window.RTCPeerConnection) {\n    return;\n  }\n  var proto = window.RTCPeerConnection.prototype;\n  var nativeAddEventListener = proto.addEventListener;\n  proto.addEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap) {\n      return nativeAddEventListener.apply(this, arguments);\n    }\n    var wrappedCallback = function(e) {\n      var modifiedEvent = wrapper(e);\n      if (modifiedEvent) {\n        cb(modifiedEvent);\n      }\n    };\n    this._eventMap = this._eventMap || {};\n    this._eventMap[cb] = wrappedCallback;\n    return nativeAddEventListener.apply(this, [nativeEventName,\n      wrappedCallback]);\n  };\n\n  var nativeRemoveEventListener = proto.removeEventListener;\n  proto.removeEventListener = function(nativeEventName, cb) {\n    if (nativeEventName !== eventNameToWrap || !this._eventMap\n        || !this._eventMap[cb]) {\n      return nativeRemoveEventListener.apply(this, arguments);\n    }\n    var unwrappedCb = this._eventMap[cb];\n    delete this._eventMap[cb];\n    return nativeRemoveEventListener.apply(this, [nativeEventName,\n      unwrappedCb]);\n  };\n\n  Object.defineProperty(proto, 'on' + eventNameToWrap, {\n    get: function() {\n      return this['_on' + eventNameToWrap];\n    },\n    set: function(cb) {\n      if (this['_on' + eventNameToWrap]) {\n        this.removeEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap]);\n        delete this['_on' + eventNameToWrap];\n      }\n      if (cb) {\n        this.addEventListener(eventNameToWrap,\n            this['_on' + eventNameToWrap] = cb);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n}\n\n// Utility methods.\nmodule.exports = {\n  extractVersion: extractVersion,\n  wrapPeerConnectionEvent: wrapPeerConnectionEvent,\n  disableLog: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return (bool) ? 'adapter.js logging disabled' :\n        'adapter.js logging enabled';\n  },\n\n  /**\n   * Disable or enable deprecation warnings\n   * @param {!boolean} bool set to true to disable warnings.\n   */\n  disableWarnings: function(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + typeof bool +\n          '. Please use a boolean.');\n    }\n    deprecationWarnings_ = !bool;\n    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n  },\n\n  log: function() {\n    if (typeof window === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  },\n\n  /**\n   * Shows a deprecation warning suggesting the modern and spec-compatible API.\n   */\n  deprecated: function(oldMethod, newMethod) {\n    if (!deprecationWarnings_) {\n      return;\n    }\n    console.warn(oldMethod + ' is deprecated, please use ' + newMethod +\n        ' instead.');\n  },\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  detectBrowser: function(window) {\n    var navigator = window && window.navigator;\n\n    // Returned result object.\n    var result = {};\n    result.browser = null;\n    result.version = null;\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    if (navigator.mozGetUserMedia) { // Firefox.\n      result.browser = 'firefox';\n      result.version = extractVersion(navigator.userAgent,\n          /Firefox\\/(\\d+)\\./, 1);\n    } else if (navigator.webkitGetUserMedia) {\n      // Chrome, Chromium, Webview, Opera.\n      // Version matches Chrome/WebRTC version.\n      result.browser = 'chrome';\n      result.version = extractVersion(navigator.userAgent,\n          /Chrom(e|ium)\\/(\\d+)\\./, 2);\n    } else if (navigator.mediaDevices &&\n        navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) { // Edge.\n      result.browser = 'edge';\n      result.version = extractVersion(navigator.userAgent,\n          /Edge\\/(\\d+).(\\d+)$/, 2);\n    } else if (window.RTCPeerConnection &&\n        navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) { // Safari.\n      result.browser = 'safari';\n      result.version = extractVersion(navigator.userAgent,\n          /AppleWebKit\\/(\\d+)\\./, 1);\n    } else { // Default fallthrough: not supported.\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar utils = require('../utils.js');\nvar logging = utils.log;\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n\n  var constraintsToChrome_ = function(c) {\n    if (typeof c !== 'object' || c.mandatory || c.optional) {\n      return c;\n    }\n    var cc = {};\n    Object.keys(c).forEach(function(key) {\n      if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n        return;\n      }\n      var r = (typeof c[key] === 'object') ? c[key] : {ideal: c[key]};\n      if (r.exact !== undefined && typeof r.exact === 'number') {\n        r.min = r.max = r.exact;\n      }\n      var oldname_ = function(prefix, name) {\n        if (prefix) {\n          return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n        }\n        return (name === 'deviceId') ? 'sourceId' : name;\n      };\n      if (r.ideal !== undefined) {\n        cc.optional = cc.optional || [];\n        var oc = {};\n        if (typeof r.ideal === 'number') {\n          oc[oldname_('min', key)] = r.ideal;\n          cc.optional.push(oc);\n          oc = {};\n          oc[oldname_('max', key)] = r.ideal;\n          cc.optional.push(oc);\n        } else {\n          oc[oldname_('', key)] = r.ideal;\n          cc.optional.push(oc);\n        }\n      }\n      if (r.exact !== undefined && typeof r.exact !== 'number') {\n        cc.mandatory = cc.mandatory || {};\n        cc.mandatory[oldname_('', key)] = r.exact;\n      } else {\n        ['min', 'max'].forEach(function(mix) {\n          if (r[mix] !== undefined) {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_(mix, key)] = r[mix];\n          }\n        });\n      }\n    });\n    if (c.advanced) {\n      cc.optional = (cc.optional || []).concat(c.advanced);\n    }\n    return cc;\n  };\n\n  var shimConstraints_ = function(constraints, func) {\n    if (browserDetails.version >= 61) {\n      return func(constraints);\n    }\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (constraints && typeof constraints.audio === 'object') {\n      var remap = function(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n      constraints = JSON.parse(JSON.stringify(constraints));\n      remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n      remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n      constraints.audio = constraintsToChrome_(constraints.audio);\n    }\n    if (constraints && typeof constraints.video === 'object') {\n      // Shim facingMode for mobile & surface pro.\n      var face = constraints.video.facingMode;\n      face = face && ((typeof face === 'object') ? face : {ideal: face});\n      var getSupportedFacingModeLies = browserDetails.version < 66;\n\n      if ((face && (face.exact === 'user' || face.exact === 'environment' ||\n                    face.ideal === 'user' || face.ideal === 'environment')) &&\n          !(navigator.mediaDevices.getSupportedConstraints &&\n            navigator.mediaDevices.getSupportedConstraints().facingMode &&\n            !getSupportedFacingModeLies)) {\n        delete constraints.video.facingMode;\n        var matches;\n        if (face.exact === 'environment' || face.ideal === 'environment') {\n          matches = ['back', 'rear'];\n        } else if (face.exact === 'user' || face.ideal === 'user') {\n          matches = ['front'];\n        }\n        if (matches) {\n          // Look for matches in label, or use last cam for back (typical).\n          return navigator.mediaDevices.enumerateDevices()\n          .then(function(devices) {\n            devices = devices.filter(function(d) {\n              return d.kind === 'videoinput';\n            });\n            var dev = devices.find(function(d) {\n              return matches.some(function(match) {\n                return d.label.toLowerCase().indexOf(match) !== -1;\n              });\n            });\n            if (!dev && devices.length && matches.indexOf('back') !== -1) {\n              dev = devices[devices.length - 1]; // more likely the back cam\n            }\n            if (dev) {\n              constraints.video.deviceId = face.exact ? {exact: dev.deviceId} :\n                                                        {ideal: dev.deviceId};\n            }\n            constraints.video = constraintsToChrome_(constraints.video);\n            logging('chrome: ' + JSON.stringify(constraints));\n            return func(constraints);\n          });\n        }\n      }\n      constraints.video = constraintsToChrome_(constraints.video);\n    }\n    logging('chrome: ' + JSON.stringify(constraints));\n    return func(constraints);\n  };\n\n  var shimError_ = function(e) {\n    if (browserDetails.version >= 64) {\n      return e;\n    }\n    return {\n      name: {\n        PermissionDeniedError: 'NotAllowedError',\n        PermissionDismissedError: 'NotAllowedError',\n        InvalidStateError: 'NotAllowedError',\n        DevicesNotFoundError: 'NotFoundError',\n        ConstraintNotSatisfiedError: 'OverconstrainedError',\n        TrackStartError: 'NotReadableError',\n        MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n        MediaDeviceKillSwitchOn: 'NotAllowedError',\n        TabCaptureError: 'AbortError',\n        ScreenCaptureError: 'AbortError',\n        DeviceCaptureError: 'AbortError'\n      }[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint || e.constraintName,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    shimConstraints_(constraints, function(c) {\n      navigator.webkitGetUserMedia(c, onSuccess, function(e) {\n        if (onError) {\n          onError(shimError_(e));\n        }\n      });\n    });\n  };\n\n  navigator.getUserMedia = getUserMedia_;\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  };\n\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {\n      getUserMedia: getUserMediaPromise_,\n      enumerateDevices: function() {\n        return new Promise(function(resolve) {\n          var kinds = {audio: 'audioinput', video: 'videoinput'};\n          return window.MediaStreamTrack.getSources(function(devices) {\n            resolve(devices.map(function(device) {\n              return {label: device.label,\n                kind: kinds[device.kind],\n                deviceId: device.id,\n                groupId: ''};\n            }));\n          });\n        });\n      },\n      getSupportedConstraints: function() {\n        return {\n          deviceId: true, echoCancellation: true, facingMode: true,\n          frameRate: true, height: true, width: true\n        };\n      }\n    };\n  }\n\n  // A shim for getUserMedia method on the mediaDevices object.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (!navigator.mediaDevices.getUserMedia) {\n    navigator.mediaDevices.getUserMedia = function(constraints) {\n      return getUserMediaPromise_(constraints);\n    };\n  } else {\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(cs) {\n      return shimConstraints_(cs, function(c) {\n        return origGetUserMedia(c).then(function(stream) {\n          if (c.audio && !stream.getAudioTracks().length ||\n              c.video && !stream.getVideoTracks().length) {\n            stream.getTracks().forEach(function(track) {\n              track.stop();\n            });\n            throw new DOMException('', 'NotFoundError');\n          }\n          return stream;\n        }, function(e) {\n          return Promise.reject(shimError_(e));\n        });\n      });\n    };\n  }\n\n  // Dummy devicechange event methods.\n  // TODO(KaptenJansson) remove once implemented in Chrome stable.\n  if (typeof navigator.mediaDevices.addEventListener === 'undefined') {\n    navigator.mediaDevices.addEventListener = function() {\n      logging('Dummy mediaDevices.addEventListener called.');\n    };\n  }\n  if (typeof navigator.mediaDevices.removeEventListener === 'undefined') {\n    navigator.mediaDevices.removeEventListener = function() {\n      logging('Dummy mediaDevices.removeEventListener called.');\n    };\n  }\n};\n","\n/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\nvar utils = require('../utils.js');\nvar logging = utils.log;\n\n/* iterates the stats graph recursively. */\nfunction walkStats(stats, base, resultSet) {\n  if (!base || resultSet.has(base.id)) {\n    return;\n  }\n  resultSet.set(base.id, base);\n  Object.keys(base).forEach(function(name) {\n    if (name.endsWith('Id')) {\n      walkStats(stats, stats.get(base[name]), resultSet);\n    } else if (name.endsWith('Ids')) {\n      base[name].forEach(function(id) {\n        walkStats(stats, stats.get(id), resultSet);\n      });\n    }\n  });\n}\n\n/* filter getStats for a sender/receiver track. */\nfunction filterStats(result, track, outbound) {\n  var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n  var filteredResult = new Map();\n  if (track === null) {\n    return filteredResult;\n  }\n  var trackStats = [];\n  result.forEach(function(value) {\n    if (value.type === 'track' &&\n        value.trackIdentifier === track.id) {\n      trackStats.push(value);\n    }\n  });\n  trackStats.forEach(function(trackStat) {\n    result.forEach(function(stats) {\n      if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n        walkStats(result, stats, filteredResult);\n      }\n    });\n  });\n  return filteredResult;\n}\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimMediaStream: function(window) {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  },\n\n  shimOnTrack: function(window) {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n          }\n          this.addEventListener('track', this._ontrack = f);\n        },\n        enumerable: true,\n        configurable: true\n      });\n      var origSetRemoteDescription =\n          window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n        var pc = this;\n        if (!pc._ontrackpoly) {\n          pc._ontrackpoly = function(e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function(te) {\n              var receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = pc.getReceivers().find(function(r) {\n                  return r.track && r.track.id === te.track.id;\n                });\n              } else {\n                receiver = {track: te.track};\n              }\n\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = {receiver: receiver};\n              event.streams = [e.stream];\n              pc.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function(track) {\n              var receiver;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = pc.getReceivers().find(function(r) {\n                  return r.track && r.track.id === track.id;\n                });\n              } else {\n                receiver = {track: track};\n              }\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = {receiver: receiver};\n              event.streams = [e.stream];\n              pc.dispatchEvent(event);\n            });\n          };\n          pc.addEventListener('addstream', pc._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n    } else {\n      // even if RTCRtpTransceiver is in window, it is only used and\n      // emitted in unified-plan. Unfortunately this means we need\n      // to unconditionally wrap the event.\n      utils.wrapPeerConnectionEvent(window, 'track', function(e) {\n        if (!e.transceiver) {\n          Object.defineProperty(e, 'transceiver',\n            {value: {receiver: e.receiver}});\n        }\n        return e;\n      });\n    }\n  },\n\n  shimGetSendersWithDtmf: function(window) {\n    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        !('getSenders' in window.RTCPeerConnection.prototype) &&\n        'createDTMFSender' in window.RTCPeerConnection.prototype) {\n      var shimSenderWithDtmf = function(pc, track) {\n        return {\n          track: track,\n          get dtmf() {\n            if (this._dtmf === undefined) {\n              if (track.kind === 'audio') {\n                this._dtmf = pc.createDTMFSender(track);\n              } else {\n                this._dtmf = null;\n              }\n            }\n            return this._dtmf;\n          },\n          _pc: pc\n        };\n      };\n\n      // augment addTrack when getSenders is not available.\n      if (!window.RTCPeerConnection.prototype.getSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function() {\n          this._senders = this._senders || [];\n          return this._senders.slice(); // return a copy of the internal state.\n        };\n        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n        window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n          var pc = this;\n          var sender = origAddTrack.apply(pc, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(pc, track);\n            pc._senders.push(sender);\n          }\n          return sender;\n        };\n\n        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n        window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n          var pc = this;\n          origRemoveTrack.apply(pc, arguments);\n          var idx = pc._senders.indexOf(sender);\n          if (idx !== -1) {\n            pc._senders.splice(idx, 1);\n          }\n        };\n      }\n      var origAddStream = window.RTCPeerConnection.prototype.addStream;\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origAddStream.apply(pc, [stream]);\n        stream.getTracks().forEach(function(track) {\n          pc._senders.push(shimSenderWithDtmf(pc, track));\n        });\n      };\n\n      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        var pc = this;\n        pc._senders = pc._senders || [];\n        origRemoveStream.apply(pc, [stream]);\n\n        stream.getTracks().forEach(function(track) {\n          var sender = pc._senders.find(function(s) {\n            return s.track === track;\n          });\n          if (sender) {\n            pc._senders.splice(pc._senders.indexOf(sender), 1); // remove sender\n          }\n        });\n      };\n    } else if (typeof window === 'object' && window.RTCPeerConnection &&\n               'getSenders' in window.RTCPeerConnection.prototype &&\n               'createDTMFSender' in window.RTCPeerConnection.prototype &&\n               window.RTCRtpSender &&\n               !('dtmf' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      window.RTCPeerConnection.prototype.getSenders = function() {\n        var pc = this;\n        var senders = origGetSenders.apply(pc, []);\n        senders.forEach(function(sender) {\n          sender._pc = pc;\n        });\n        return senders;\n      };\n\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n        get: function() {\n          if (this._dtmf === undefined) {\n            if (this.track.kind === 'audio') {\n              this._dtmf = this._pc.createDTMFSender(this.track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        }\n      });\n    }\n  },\n\n  shimSenderReceiverGetStats: function(window) {\n    if (!(typeof window === 'object' && window.RTCPeerConnection &&\n        window.RTCRtpSender && window.RTCRtpReceiver)) {\n      return;\n    }\n\n    // shim sender stats.\n    if (!('getStats' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      if (origGetSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function() {\n          var pc = this;\n          var senders = origGetSenders.apply(pc, []);\n          senders.forEach(function(sender) {\n            sender._pc = pc;\n          });\n          return senders;\n        };\n      }\n\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      if (origAddTrack) {\n        window.RTCPeerConnection.prototype.addTrack = function() {\n          var sender = origAddTrack.apply(this, arguments);\n          sender._pc = this;\n          return sender;\n        };\n      }\n      window.RTCRtpSender.prototype.getStats = function() {\n        var sender = this;\n        return this._pc.getStats().then(function(result) {\n          /* Note: this will include stats of all senders that\n           *   send a track with the same id as sender.track as\n           *   it is not possible to identify the RTCRtpSender.\n           */\n          return filterStats(result, sender.track, true);\n        });\n      };\n    }\n\n    // shim receiver stats.\n    if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n      var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n      if (origGetReceivers) {\n        window.RTCPeerConnection.prototype.getReceivers = function() {\n          var pc = this;\n          var receivers = origGetReceivers.apply(pc, []);\n          receivers.forEach(function(receiver) {\n            receiver._pc = pc;\n          });\n          return receivers;\n        };\n      }\n      utils.wrapPeerConnectionEvent(window, 'track', function(e) {\n        e.receiver._pc = e.srcElement;\n        return e;\n      });\n      window.RTCRtpReceiver.prototype.getStats = function() {\n        var receiver = this;\n        return this._pc.getStats().then(function(result) {\n          return filterStats(result, receiver.track, false);\n        });\n      };\n    }\n\n    if (!('getStats' in window.RTCRtpSender.prototype &&\n        'getStats' in window.RTCRtpReceiver.prototype)) {\n      return;\n    }\n\n    // shim RTCPeerConnection.getStats(track).\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function() {\n      var pc = this;\n      if (arguments.length > 0 &&\n          arguments[0] instanceof window.MediaStreamTrack) {\n        var track = arguments[0];\n        var sender;\n        var receiver;\n        var err;\n        pc.getSenders().forEach(function(s) {\n          if (s.track === track) {\n            if (sender) {\n              err = true;\n            } else {\n              sender = s;\n            }\n          }\n        });\n        pc.getReceivers().forEach(function(r) {\n          if (r.track === track) {\n            if (receiver) {\n              err = true;\n            } else {\n              receiver = r;\n            }\n          }\n          return r.track === track;\n        });\n        if (err || (sender && receiver)) {\n          return Promise.reject(new DOMException(\n            'There are more than one sender or receiver for the track.',\n            'InvalidAccessError'));\n        } else if (sender) {\n          return sender.getStats();\n        } else if (receiver) {\n          return receiver.getStats();\n        }\n        return Promise.reject(new DOMException(\n          'There is no sender or receiver for the track.',\n          'InvalidAccessError'));\n      }\n      return origGetStats.apply(pc, arguments);\n    };\n  },\n\n  shimSourceObject: function(window) {\n    var URL = window && window.URL;\n\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this._srcObject;\n          },\n          set: function(stream) {\n            var self = this;\n            // Use _srcObject as a private property for this shim\n            this._srcObject = stream;\n            if (this.src) {\n              URL.revokeObjectURL(this.src);\n            }\n\n            if (!stream) {\n              this.src = '';\n              return undefined;\n            }\n            this.src = URL.createObjectURL(stream);\n            // We need to recreate the blob url when a track is added or\n            // removed. Doing it manually since we want to avoid a recursion.\n            stream.addEventListener('addtrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n            stream.addEventListener('removetrack', function() {\n              if (self.src) {\n                URL.revokeObjectURL(self.src);\n              }\n              self.src = URL.createObjectURL(stream);\n            });\n          }\n        });\n      }\n    }\n  },\n\n  shimAddTrackRemoveTrackWithNative: function(window) {\n    // shim addTrack/removeTrack with native variants in order to make\n    // the interactions with legacy getLocalStreams behave as in other browsers.\n    // Keeps a mapping stream.id => [stream, rtpsenders...]\n    window.RTCPeerConnection.prototype.getLocalStreams = function() {\n      var pc = this;\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams).map(function(streamId) {\n        return pc._shimmedLocalStreams[streamId][0];\n      });\n    };\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      var sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\n      var pc = this;\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      stream.getTracks().forEach(function(track) {\n        var alreadyExists = pc.getSenders().find(function(s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.',\n              'InvalidAccessError');\n        }\n      });\n      var existingSenders = pc.getSenders();\n      origAddStream.apply(this, arguments);\n      var newSenders = pc.getSenders().filter(function(newSender) {\n        return existingSenders.indexOf(newSender) === -1;\n      });\n      this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n    var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n    window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n      var pc = this;\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(function(streamId) {\n          var idx = pc._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            pc._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (pc._shimmedLocalStreams[streamId].length === 1) {\n            delete pc._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n  },\n\n  shimAddTrackRemoveTrack: function(window) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n    var browserDetails = utils.detectBrowser(window);\n    // shim addTrack and removeTrack.\n    if (window.RTCPeerConnection.prototype.addTrack &&\n        browserDetails.version >= 65) {\n      return this.shimAddTrackRemoveTrackWithNative(window);\n    }\n\n    // also shim pc.getLocalStreams when addTrack is shimmed\n    // to return the original streams.\n    var origGetLocalStreams = window.RTCPeerConnection.prototype\n        .getLocalStreams;\n    window.RTCPeerConnection.prototype.getLocalStreams = function() {\n      var pc = this;\n      var nativeStreams = origGetLocalStreams.apply(this);\n      pc._reverseStreams = pc._reverseStreams || {};\n      return nativeStreams.map(function(stream) {\n        return pc._reverseStreams[stream.id];\n      });\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function(stream) {\n      var pc = this;\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n\n      stream.getTracks().forEach(function(track) {\n        var alreadyExists = pc.getSenders().find(function(s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.',\n              'InvalidAccessError');\n        }\n      });\n      // Add identity mapping for consistency with addTrack.\n      // Unless this is being used with a stream from addTrack.\n      if (!pc._reverseStreams[stream.id]) {\n        var newStream = new window.MediaStream(stream.getTracks());\n        pc._streams[stream.id] = newStream;\n        pc._reverseStreams[newStream.id] = stream;\n        stream = newStream;\n      }\n      origAddStream.apply(pc, [stream]);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var pc = this;\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n\n      origRemoveStream.apply(pc, [(pc._streams[stream.id] || stream)]);\n      delete pc._reverseStreams[(pc._streams[stream.id] ?\n          pc._streams[stream.id].id : stream.id)];\n      delete pc._streams[stream.id];\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n      var pc = this;\n      if (pc.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      var streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 ||\n          !streams[0].getTracks().find(function(t) {\n            return t === track;\n          })) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException(\n          'The adapter.js addTrack polyfill only supports a single ' +\n          ' stream which is associated with the specified track.',\n          'NotSupportedError');\n      }\n\n      var alreadyExists = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.',\n            'InvalidAccessError');\n      }\n\n      pc._streams = pc._streams || {};\n      pc._reverseStreams = pc._reverseStreams || {};\n      var oldStream = pc._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(function() {\n          pc.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        var newStream = new window.MediaStream([track]);\n        pc._streams[stream.id] = newStream;\n        pc._reverseStreams[newStream.id] = stream;\n        pc.addStream(newStream);\n      }\n      return pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n    };\n\n    // replace the internal stream id with the external one and\n    // vice versa.\n    function replaceInternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(internalStream.id, 'g'),\n            externalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    function replaceExternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function(internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(externalStream.id, 'g'),\n            internalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    ['createOffer', 'createAnswer'].forEach(function(method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      window.RTCPeerConnection.prototype[method] = function() {\n        var pc = this;\n        var args = arguments;\n        var isLegacyCall = arguments.length &&\n            typeof arguments[0] === 'function';\n        if (isLegacyCall) {\n          return nativeMethod.apply(pc, [\n            function(description) {\n              var desc = replaceInternalStreamId(pc, description);\n              args[0].apply(null, [desc]);\n            },\n            function(err) {\n              if (args[1]) {\n                args[1].apply(null, err);\n              }\n            }, arguments[2]\n          ]);\n        }\n        return nativeMethod.apply(pc, arguments)\n        .then(function(description) {\n          return replaceInternalStreamId(pc, description);\n        });\n      };\n    });\n\n    var origSetLocalDescription =\n        window.RTCPeerConnection.prototype.setLocalDescription;\n    window.RTCPeerConnection.prototype.setLocalDescription = function() {\n      var pc = this;\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(pc, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(pc, arguments[0]);\n      return origSetLocalDescription.apply(pc, arguments);\n    };\n\n    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n    var origLocalDescription = Object.getOwnPropertyDescriptor(\n        window.RTCPeerConnection.prototype, 'localDescription');\n    Object.defineProperty(window.RTCPeerConnection.prototype,\n        'localDescription', {\n          get: function() {\n            var pc = this;\n            var description = origLocalDescription.get.apply(this);\n            if (description.type === '') {\n              return description;\n            }\n            return replaceInternalStreamId(pc, description);\n          }\n        });\n\n    window.RTCPeerConnection.prototype.removeTrack = function(sender) {\n      var pc = this;\n      if (pc.signalingState === 'closed') {\n        throw new DOMException(\n          'The RTCPeerConnection\\'s signalingState is \\'closed\\'.',\n          'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' +\n            'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      var isLocal = sender._pc === pc;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.',\n            'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      pc._streams = pc._streams || {};\n      var stream;\n      Object.keys(pc._streams).forEach(function(streamid) {\n        var hasTrack = pc._streams[streamid].getTracks().find(function(track) {\n          return sender.track === track;\n        });\n        if (hasTrack) {\n          stream = pc._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          pc.removeStream(pc._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        pc.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n  },\n\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        // Translate iceTransportPolicy to iceTransports,\n        // see https://code.google.com/p/webrtc/issues/detail?id=4869\n        // this was fixed in M56 along with unprefixing RTCPeerConnection.\n        logging('PeerConnection');\n        if (pcConfig && pcConfig.iceTransportPolicy) {\n          pcConfig.iceTransports = pcConfig.iceTransportPolicy;\n        }\n\n        return new window.webkitRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype =\n          window.webkitRTCPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      if (window.webkitRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return window.webkitRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n    }\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function(selector,\n        successCallback, errorCallback) {\n      var pc = this;\n      var args = arguments;\n\n      // If selector is a function then we are in the old style stats so just\n      // pass back the original getStats format to avoid breaking old users.\n      if (arguments.length > 0 && typeof selector === 'function') {\n        return origGetStats.apply(this, arguments);\n      }\n\n      // When spec-style getStats is supported, return those when called with\n      // either no arguments or the selector argument is null.\n      if (origGetStats.length === 0 && (arguments.length === 0 ||\n          typeof arguments[0] !== 'function')) {\n        return origGetStats.apply(this, []);\n      }\n\n      var fixChromeStats_ = function(response) {\n        var standardReport = {};\n        var reports = response.result();\n        reports.forEach(function(report) {\n          var standardStats = {\n            id: report.id,\n            timestamp: report.timestamp,\n            type: {\n              localcandidate: 'local-candidate',\n              remotecandidate: 'remote-candidate'\n            }[report.type] || report.type\n          };\n          report.names().forEach(function(name) {\n            standardStats[name] = report.stat(name);\n          });\n          standardReport[standardStats.id] = standardStats;\n        });\n\n        return standardReport;\n      };\n\n      // shim getStats with maplike support\n      var makeMapStats = function(stats) {\n        return new Map(Object.keys(stats).map(function(key) {\n          return [key, stats[key]];\n        }));\n      };\n\n      if (arguments.length >= 2) {\n        var successCallbackWrapper_ = function(response) {\n          args[1](makeMapStats(fixChromeStats_(response)));\n        };\n\n        return origGetStats.apply(this, [successCallbackWrapper_,\n          arguments[0]]);\n      }\n\n      // promise-support\n      return new Promise(function(resolve, reject) {\n        origGetStats.apply(pc, [\n          function(response) {\n            resolve(makeMapStats(fixChromeStats_(response)));\n          }, reject]);\n      }).then(successCallback, errorCallback);\n    };\n\n    // add promise support -- natively available in Chrome 51\n    if (browserDetails.version < 51) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n          .forEach(function(method) {\n            var nativeMethod = window.RTCPeerConnection.prototype[method];\n            window.RTCPeerConnection.prototype[method] = function() {\n              var args = arguments;\n              var pc = this;\n              var promise = new Promise(function(resolve, reject) {\n                nativeMethod.apply(pc, [args[0], resolve, reject]);\n              });\n              if (args.length < 2) {\n                return promise;\n              }\n              return promise.then(function() {\n                args[1].apply(null, []);\n              },\n              function(err) {\n                if (args.length >= 3) {\n                  args[2].apply(null, [err]);\n                }\n              });\n            };\n          });\n    }\n\n    // promise support for createOffer and createAnswer. Available (without\n    // bugs) since M52: crbug/619289\n    if (browserDetails.version < 52) {\n      ['createOffer', 'createAnswer'].forEach(function(method) {\n        var nativeMethod = window.RTCPeerConnection.prototype[method];\n        window.RTCPeerConnection.prototype[method] = function() {\n          var pc = this;\n          if (arguments.length < 1 || (arguments.length === 1 &&\n              typeof arguments[0] === 'object')) {\n            var opts = arguments.length === 1 ? arguments[0] : undefined;\n            return new Promise(function(resolve, reject) {\n              nativeMethod.apply(pc, [resolve, reject, opts]);\n            });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\n          window.RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  },\n\n  fixNegotiationNeeded: function(window) {\n    utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function(e) {\n      var pc = e.target;\n      if (pc.signalingState !== 'stable') {\n        return;\n      }\n      return e;\n    });\n  },\n\n  shimGetDisplayMedia: function(window, getSourceId) {\n    if (!window.navigator || !window.navigator.mediaDevices ||\n        'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    // getSourceId is a function that returns a promise resolving with\n    // the sourceId of the screen/window/tab to be shared.\n    if (typeof getSourceId !== 'function') {\n      console.error('shimGetDisplayMedia: getSourceId argument is not ' +\n          'a function');\n      return;\n    }\n    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {\n      return getSourceId(constraints)\n        .then(function(sourceId) {\n          var widthSpecified = constraints.video && constraints.video.width;\n          var heightSpecified = constraints.video && constraints.video.height;\n          var frameRateSpecified = constraints.video &&\n            constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3\n            }\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n    };\n    window.navigator.getDisplayMedia = function(constraints) {\n      utils.deprecated('navigator.getDisplayMedia',\n          'navigator.mediaDevices.getDisplayMedia');\n      return window.navigator.mediaDevices.getDisplayMedia(constraints);\n    };\n  }\n};\n","/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nmodule.exports = function(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n};\n"," /* eslint-env node */\n'use strict';\n\n// SDP helpers.\nvar SDPUtils = {};\n\n// Generate an alphanumeric identifier for cname or mids.\n// TODO: use UUIDs instead? https://gist.github.com/jed/982883\nSDPUtils.generateIdentifier = function() {\n  return Math.random().toString(36).substr(2, 10);\n};\n\n// The RTCP CNAME used by all peerconnections from the same JS.\nSDPUtils.localCName = SDPUtils.generateIdentifier();\n\n// Splits SDP into lines, dealing with both CRLF and LF.\nSDPUtils.splitLines = function(blob) {\n  return blob.trim().split('\\n').map(function(line) {\n    return line.trim();\n  });\n};\n// Splits SDP into sessionpart and mediasections. Ensures CRLF.\nSDPUtils.splitSections = function(blob) {\n  var parts = blob.split('\\nm=');\n  return parts.map(function(part, index) {\n    return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n  });\n};\n\n// returns the session description.\nSDPUtils.getDescription = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  return sections && sections[0];\n};\n\n// returns the individual media sections.\nSDPUtils.getMediaSections = function(blob) {\n  var sections = SDPUtils.splitSections(blob);\n  sections.shift();\n  return sections;\n};\n\n// Returns lines that start with a certain prefix.\nSDPUtils.matchPrefix = function(blob, prefix) {\n  return SDPUtils.splitLines(blob).filter(function(line) {\n    return line.indexOf(prefix) === 0;\n  });\n};\n\n// Parses an ICE candidate line. Sample input:\n// candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n// rport 55996\"\nSDPUtils.parseCandidate = function(line) {\n  var parts;\n  // Parse both variants.\n  if (line.indexOf('a=candidate:') === 0) {\n    parts = line.substring(12).split(' ');\n  } else {\n    parts = line.substring(10).split(' ');\n  }\n\n  var candidate = {\n    foundation: parts[0],\n    component: parseInt(parts[1], 10),\n    protocol: parts[2].toLowerCase(),\n    priority: parseInt(parts[3], 10),\n    ip: parts[4],\n    address: parts[4], // address is an alias for ip.\n    port: parseInt(parts[5], 10),\n    // skip parts[6] == 'typ'\n    type: parts[7]\n  };\n\n  for (var i = 8; i < parts.length; i += 2) {\n    switch (parts[i]) {\n      case 'raddr':\n        candidate.relatedAddress = parts[i + 1];\n        break;\n      case 'rport':\n        candidate.relatedPort = parseInt(parts[i + 1], 10);\n        break;\n      case 'tcptype':\n        candidate.tcpType = parts[i + 1];\n        break;\n      case 'ufrag':\n        candidate.ufrag = parts[i + 1]; // for backward compability.\n        candidate.usernameFragment = parts[i + 1];\n        break;\n      default: // extension handling, in particular ufrag\n        candidate[parts[i]] = parts[i + 1];\n        break;\n    }\n  }\n  return candidate;\n};\n\n// Translates a candidate object into SDP candidate attribute.\nSDPUtils.writeCandidate = function(candidate) {\n  var sdp = [];\n  sdp.push(candidate.foundation);\n  sdp.push(candidate.component);\n  sdp.push(candidate.protocol.toUpperCase());\n  sdp.push(candidate.priority);\n  sdp.push(candidate.address || candidate.ip);\n  sdp.push(candidate.port);\n\n  var type = candidate.type;\n  sdp.push('typ');\n  sdp.push(type);\n  if (type !== 'host' && candidate.relatedAddress &&\n      candidate.relatedPort) {\n    sdp.push('raddr');\n    sdp.push(candidate.relatedAddress);\n    sdp.push('rport');\n    sdp.push(candidate.relatedPort);\n  }\n  if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n    sdp.push('tcptype');\n    sdp.push(candidate.tcpType);\n  }\n  if (candidate.usernameFragment || candidate.ufrag) {\n    sdp.push('ufrag');\n    sdp.push(candidate.usernameFragment || candidate.ufrag);\n  }\n  return 'candidate:' + sdp.join(' ');\n};\n\n// Parses an ice-options line, returns an array of option tags.\n// a=ice-options:foo bar\nSDPUtils.parseIceOptions = function(line) {\n  return line.substr(14).split(' ');\n};\n\n// Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n// a=rtpmap:111 opus/48000/2\nSDPUtils.parseRtpMap = function(line) {\n  var parts = line.substr(9).split(' ');\n  var parsed = {\n    payloadType: parseInt(parts.shift(), 10) // was: id\n  };\n\n  parts = parts[0].split('/');\n\n  parsed.name = parts[0];\n  parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n  parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n  // legacy alias, got renamed back to channels in ORTC.\n  parsed.numChannels = parsed.channels;\n  return parsed;\n};\n\n// Generate an a=rtpmap line from RTCRtpCodecCapability or\n// RTCRtpCodecParameters.\nSDPUtils.writeRtpMap = function(codec) {\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  var channels = codec.channels || codec.numChannels || 1;\n  return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate +\n      (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n};\n\n// Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n// a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n// a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\nSDPUtils.parseExtmap = function(line) {\n  var parts = line.substr(9).split(' ');\n  return {\n    id: parseInt(parts[0], 10),\n    direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n    uri: parts[1]\n  };\n};\n\n// Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n// RTCRtpHeaderExtension.\nSDPUtils.writeExtmap = function(headerExtension) {\n  return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) +\n      (headerExtension.direction && headerExtension.direction !== 'sendrecv'\n          ? '/' + headerExtension.direction\n          : '') +\n      ' ' + headerExtension.uri + '\\r\\n';\n};\n\n// Parses an ftmp line, returns dictionary. Sample input:\n// a=fmtp:96 vbr=on;cng=on\n// Also deals with vbr=on; cng=on\nSDPUtils.parseFmtp = function(line) {\n  var parsed = {};\n  var kv;\n  var parts = line.substr(line.indexOf(' ') + 1).split(';');\n  for (var j = 0; j < parts.length; j++) {\n    kv = parts[j].trim().split('=');\n    parsed[kv[0].trim()] = kv[1];\n  }\n  return parsed;\n};\n\n// Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeFmtp = function(codec) {\n  var line = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.parameters && Object.keys(codec.parameters).length) {\n    var params = [];\n    Object.keys(codec.parameters).forEach(function(param) {\n      if (codec.parameters[param]) {\n        params.push(param + '=' + codec.parameters[param]);\n      } else {\n        params.push(param);\n      }\n    });\n    line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n  }\n  return line;\n};\n\n// Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n// a=rtcp-fb:98 nack rpsi\nSDPUtils.parseRtcpFb = function(line) {\n  var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n  return {\n    type: parts.shift(),\n    parameter: parts.join(' ')\n  };\n};\n// Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\nSDPUtils.writeRtcpFb = function(codec) {\n  var lines = '';\n  var pt = codec.payloadType;\n  if (codec.preferredPayloadType !== undefined) {\n    pt = codec.preferredPayloadType;\n  }\n  if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n    // FIXME: special handling for trr-int?\n    codec.rtcpFeedback.forEach(function(fb) {\n      lines += 'a=rtcp-fb:' + pt + ' ' + fb.type +\n      (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') +\n          '\\r\\n';\n    });\n  }\n  return lines;\n};\n\n// Parses an RFC 5576 ssrc media attribute. Sample input:\n// a=ssrc:3735928559 cname:something\nSDPUtils.parseSsrcMedia = function(line) {\n  var sp = line.indexOf(' ');\n  var parts = {\n    ssrc: parseInt(line.substr(7, sp - 7), 10)\n  };\n  var colon = line.indexOf(':', sp);\n  if (colon > -1) {\n    parts.attribute = line.substr(sp + 1, colon - sp - 1);\n    parts.value = line.substr(colon + 1);\n  } else {\n    parts.attribute = line.substr(sp + 1);\n  }\n  return parts;\n};\n\nSDPUtils.parseSsrcGroup = function(line) {\n  var parts = line.substr(13).split(' ');\n  return {\n    semantics: parts.shift(),\n    ssrcs: parts.map(function(ssrc) {\n      return parseInt(ssrc, 10);\n    })\n  };\n};\n\n// Extracts the MID (RFC 5888) from a media section.\n// returns the MID or undefined if no mid line was found.\nSDPUtils.getMid = function(mediaSection) {\n  var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n  if (mid) {\n    return mid.substr(6);\n  }\n};\n\nSDPUtils.parseFingerprint = function(line) {\n  var parts = line.substr(14).split(' ');\n  return {\n    algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n    value: parts[1]\n  };\n};\n\n// Extracts DTLS parameters from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the fingerprint line as input. See also getIceParameters.\nSDPUtils.getDtlsParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n      'a=fingerprint:');\n  // Note: a=setup line is ignored since we use the 'auto' role.\n  // Note2: 'algorithm' is not case sensitive except in Edge.\n  return {\n    role: 'auto',\n    fingerprints: lines.map(SDPUtils.parseFingerprint)\n  };\n};\n\n// Serializes DTLS parameters to SDP.\nSDPUtils.writeDtlsParameters = function(params, setupType) {\n  var sdp = 'a=setup:' + setupType + '\\r\\n';\n  params.fingerprints.forEach(function(fp) {\n    sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n  });\n  return sdp;\n};\n// Parses ICE information from SDP media section or sessionpart.\n// FIXME: for consistency with other functions this should only\n//   get the ice-ufrag and ice-pwd lines as input.\nSDPUtils.getIceParameters = function(mediaSection, sessionpart) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  // Search in session part, too.\n  lines = lines.concat(SDPUtils.splitLines(sessionpart));\n  var iceParameters = {\n    usernameFragment: lines.filter(function(line) {\n      return line.indexOf('a=ice-ufrag:') === 0;\n    })[0].substr(12),\n    password: lines.filter(function(line) {\n      return line.indexOf('a=ice-pwd:') === 0;\n    })[0].substr(10)\n  };\n  return iceParameters;\n};\n\n// Serializes ICE parameters to SDP.\nSDPUtils.writeIceParameters = function(params) {\n  return 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' +\n      'a=ice-pwd:' + params.password + '\\r\\n';\n};\n\n// Parses the SDP media section and returns RTCRtpParameters.\nSDPUtils.parseRtpParameters = function(mediaSection) {\n  var description = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: [],\n    rtcp: []\n  };\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  for (var i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n    var pt = mline[i];\n    var rtpmapline = SDPUtils.matchPrefix(\n        mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n    if (rtpmapline) {\n      var codec = SDPUtils.parseRtpMap(rtpmapline);\n      var fmtps = SDPUtils.matchPrefix(\n          mediaSection, 'a=fmtp:' + pt + ' ');\n      // Only the first a=fmtp:<pt> is considered.\n      codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n      codec.rtcpFeedback = SDPUtils.matchPrefix(\n          mediaSection, 'a=rtcp-fb:' + pt + ' ')\n        .map(SDPUtils.parseRtcpFb);\n      description.codecs.push(codec);\n      // parse FEC mechanisms from rtpmap lines.\n      switch (codec.name.toUpperCase()) {\n        case 'RED':\n        case 'ULPFEC':\n          description.fecMechanisms.push(codec.name.toUpperCase());\n          break;\n        default: // only RED and ULPFEC are recognized as FEC mechanisms.\n          break;\n      }\n    }\n  }\n  SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function(line) {\n    description.headerExtensions.push(SDPUtils.parseExtmap(line));\n  });\n  // FIXME: parse rtcp.\n  return description;\n};\n\n// Generates parts of the SDP media section describing the capabilities /\n// parameters.\nSDPUtils.writeRtpDescription = function(kind, caps) {\n  var sdp = '';\n\n  // Build the mline.\n  sdp += 'm=' + kind + ' ';\n  sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n  sdp += ' UDP/TLS/RTP/SAVPF ';\n  sdp += caps.codecs.map(function(codec) {\n    if (codec.preferredPayloadType !== undefined) {\n      return codec.preferredPayloadType;\n    }\n    return codec.payloadType;\n  }).join(' ') + '\\r\\n';\n\n  sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n  sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n  // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n  caps.codecs.forEach(function(codec) {\n    sdp += SDPUtils.writeRtpMap(codec);\n    sdp += SDPUtils.writeFmtp(codec);\n    sdp += SDPUtils.writeRtcpFb(codec);\n  });\n  var maxptime = 0;\n  caps.codecs.forEach(function(codec) {\n    if (codec.maxptime > maxptime) {\n      maxptime = codec.maxptime;\n    }\n  });\n  if (maxptime > 0) {\n    sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n  }\n  sdp += 'a=rtcp-mux\\r\\n';\n\n  if (caps.headerExtensions) {\n    caps.headerExtensions.forEach(function(extension) {\n      sdp += SDPUtils.writeExtmap(extension);\n    });\n  }\n  // FIXME: write fecMechanisms.\n  return sdp;\n};\n\n// Parses the SDP media section and returns an array of\n// RTCRtpEncodingParameters.\nSDPUtils.parseRtpEncodingParameters = function(mediaSection) {\n  var encodingParameters = [];\n  var description = SDPUtils.parseRtpParameters(mediaSection);\n  var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n  var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n  // filter a=ssrc:... cname:, ignore PlanB-msid\n  var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(parts) {\n    return parts.attribute === 'cname';\n  });\n  var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n  var secondarySsrc;\n\n  var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n  .map(function(line) {\n    var parts = line.substr(17).split(' ');\n    return parts.map(function(part) {\n      return parseInt(part, 10);\n    });\n  });\n  if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n    secondarySsrc = flows[0][1];\n  }\n\n  description.codecs.forEach(function(codec) {\n    if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n      var encParam = {\n        ssrc: primarySsrc,\n        codecPayloadType: parseInt(codec.parameters.apt, 10)\n      };\n      if (primarySsrc && secondarySsrc) {\n        encParam.rtx = {ssrc: secondarySsrc};\n      }\n      encodingParameters.push(encParam);\n      if (hasRed) {\n        encParam = JSON.parse(JSON.stringify(encParam));\n        encParam.fec = {\n          ssrc: primarySsrc,\n          mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n        };\n        encodingParameters.push(encParam);\n      }\n    }\n  });\n  if (encodingParameters.length === 0 && primarySsrc) {\n    encodingParameters.push({\n      ssrc: primarySsrc\n    });\n  }\n\n  // we support both b=AS and b=TIAS but interpret AS as TIAS.\n  var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n  if (bandwidth.length) {\n    if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n      bandwidth = parseInt(bandwidth[0].substr(7), 10);\n    } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n      // use formula from JSEP to convert b=AS to TIAS value.\n      bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95\n          - (50 * 40 * 8);\n    } else {\n      bandwidth = undefined;\n    }\n    encodingParameters.forEach(function(params) {\n      params.maxBitrate = bandwidth;\n    });\n  }\n  return encodingParameters;\n};\n\n// parses http://draft.ortc.org/#rtcrtcpparameters*\nSDPUtils.parseRtcpParameters = function(mediaSection) {\n  var rtcpParameters = {};\n\n  // Gets the first SSRC. Note tha with RTX there might be multiple\n  // SSRCs.\n  var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n      .map(function(line) {\n        return SDPUtils.parseSsrcMedia(line);\n      })\n      .filter(function(obj) {\n        return obj.attribute === 'cname';\n      })[0];\n  if (remoteSsrc) {\n    rtcpParameters.cname = remoteSsrc.value;\n    rtcpParameters.ssrc = remoteSsrc.ssrc;\n  }\n\n  // Edge uses the compound attribute instead of reducedSize\n  // compound is !reducedSize\n  var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n  rtcpParameters.reducedSize = rsize.length > 0;\n  rtcpParameters.compound = rsize.length === 0;\n\n  // parses the rtcp-mux attrіbute.\n  // Note that Edge does not support unmuxed RTCP.\n  var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n  rtcpParameters.mux = mux.length > 0;\n\n  return rtcpParameters;\n};\n\n// parses either a=msid: or a=ssrc:... msid lines and returns\n// the id of the MediaStream and MediaStreamTrack.\nSDPUtils.parseMsid = function(mediaSection) {\n  var parts;\n  var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n  if (spec.length === 1) {\n    parts = spec[0].substr(7).split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n  var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n  .map(function(line) {\n    return SDPUtils.parseSsrcMedia(line);\n  })\n  .filter(function(msidParts) {\n    return msidParts.attribute === 'msid';\n  });\n  if (planB.length > 0) {\n    parts = planB[0].value.split(' ');\n    return {stream: parts[0], track: parts[1]};\n  }\n};\n\n// Generate a session ID for SDP.\n// https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n// recommends using a cryptographically random +ve 64-bit value\n// but right now this should be acceptable and within the right range\nSDPUtils.generateSessionId = function() {\n  return Math.random().toString().substr(2, 21);\n};\n\n// Write boilder plate for start of SDP\n// sessId argument is optional - if not supplied it will\n// be generated randomly\n// sessVersion is optional and defaults to 2\n// sessUser is optional and defaults to 'thisisadapterortc'\nSDPUtils.writeSessionBoilerplate = function(sessId, sessVer, sessUser) {\n  var sessionId;\n  var version = sessVer !== undefined ? sessVer : 2;\n  if (sessId) {\n    sessionId = sessId;\n  } else {\n    sessionId = SDPUtils.generateSessionId();\n  }\n  var user = sessUser || 'thisisadapterortc';\n  // FIXME: sess-id should be an NTP timestamp.\n  return 'v=0\\r\\n' +\n      'o=' + user + ' ' + sessionId + ' ' + version +\n        ' IN IP4 127.0.0.1\\r\\n' +\n      's=-\\r\\n' +\n      't=0 0\\r\\n';\n};\n\nSDPUtils.writeMediaSection = function(transceiver, caps, type, stream) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.direction) {\n    sdp += 'a=' + transceiver.direction + '\\r\\n';\n  } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    // spec.\n    var msid = 'msid:' + stream.id + ' ' +\n        transceiver.rtpSender.track.id + '\\r\\n';\n    sdp += 'a=' + msid;\n\n    // for Chrome.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n};\n\n// Gets the direction from the mediaSection or the sessionpart.\nSDPUtils.getDirection = function(mediaSection, sessionpart) {\n  // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n  var lines = SDPUtils.splitLines(mediaSection);\n  for (var i = 0; i < lines.length; i++) {\n    switch (lines[i]) {\n      case 'a=sendrecv':\n      case 'a=sendonly':\n      case 'a=recvonly':\n      case 'a=inactive':\n        return lines[i].substr(2);\n      default:\n        // FIXME: What should happen here?\n    }\n  }\n  if (sessionpart) {\n    return SDPUtils.getDirection(sessionpart);\n  }\n  return 'sendrecv';\n};\n\nSDPUtils.getKind = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var mline = lines[0].split(' ');\n  return mline[0].substr(2);\n};\n\nSDPUtils.isRejected = function(mediaSection) {\n  return mediaSection.split(' ', 2)[1] === '0';\n};\n\nSDPUtils.parseMLine = function(mediaSection) {\n  var lines = SDPUtils.splitLines(mediaSection);\n  var parts = lines[0].substr(2).split(' ');\n  return {\n    kind: parts[0],\n    port: parseInt(parts[1], 10),\n    protocol: parts[2],\n    fmt: parts.slice(3).join(' ')\n  };\n};\n\nSDPUtils.parseOLine = function(mediaSection) {\n  var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n  var parts = line.substr(2).split(' ');\n  return {\n    username: parts[0],\n    sessionId: parts[1],\n    sessionVersion: parseInt(parts[2], 10),\n    netType: parts[3],\n    addressType: parts[4],\n    address: parts[5]\n  };\n};\n\n// a very naive interpretation of a valid SDP.\nSDPUtils.isValidSDP = function(blob) {\n  if (typeof blob !== 'string' || blob.length === 0) {\n    return false;\n  }\n  var lines = SDPUtils.splitLines(blob);\n  for (var i = 0; i < lines.length; i++) {\n    if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n      return false;\n    }\n    // TODO: check the modifier a bit more.\n  }\n  return true;\n};\n\n// Expose public methods.\nif (typeof module === 'object') {\n  module.exports = SDPUtils;\n}\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\n\nfunction fixStatsType(stat) {\n  return {\n    inboundrtp: 'inbound-rtp',\n    outboundrtp: 'outbound-rtp',\n    candidatepair: 'candidate-pair',\n    localcandidate: 'local-candidate',\n    remotecandidate: 'remote-candidate'\n  }[stat.type] || stat.type;\n}\n\nfunction writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n  var sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n  // Map ICE parameters (ufrag, pwd) to SDP.\n  sdp += SDPUtils.writeIceParameters(\n      transceiver.iceGatherer.getLocalParameters());\n\n  // Map DTLS parameters to SDP.\n  sdp += SDPUtils.writeDtlsParameters(\n      transceiver.dtlsTransport.getLocalParameters(),\n      type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n  sdp += 'a=mid:' + transceiver.mid + '\\r\\n';\n\n  if (transceiver.rtpSender && transceiver.rtpReceiver) {\n    sdp += 'a=sendrecv\\r\\n';\n  } else if (transceiver.rtpSender) {\n    sdp += 'a=sendonly\\r\\n';\n  } else if (transceiver.rtpReceiver) {\n    sdp += 'a=recvonly\\r\\n';\n  } else {\n    sdp += 'a=inactive\\r\\n';\n  }\n\n  if (transceiver.rtpSender) {\n    var trackId = transceiver.rtpSender._initialTrackId ||\n        transceiver.rtpSender.track.id;\n    transceiver.rtpSender._initialTrackId = trackId;\n    // spec.\n    var msid = 'msid:' + (stream ? stream.id : '-') + ' ' +\n        trackId + '\\r\\n';\n    sdp += 'a=' + msid;\n    // for Chrome. Legacy should no longer be required.\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n        ' ' + msid;\n\n    // RTX\n    if (transceiver.sendEncodingParameters[0].rtx) {\n      sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n          ' ' + msid;\n      sdp += 'a=ssrc-group:FID ' +\n          transceiver.sendEncodingParameters[0].ssrc + ' ' +\n          transceiver.sendEncodingParameters[0].rtx.ssrc +\n          '\\r\\n';\n    }\n  }\n  // FIXME: this should be written by writeRtpDescription.\n  sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].ssrc +\n      ' cname:' + SDPUtils.localCName + '\\r\\n';\n  if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n    sdp += 'a=ssrc:' + transceiver.sendEncodingParameters[0].rtx.ssrc +\n        ' cname:' + SDPUtils.localCName + '\\r\\n';\n  }\n  return sdp;\n}\n\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nfunction filterIceServers(iceServers, edgeVersion) {\n  var hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(function(server) {\n    if (server && (server.urls || server.url)) {\n      var urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n      }\n      var isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(function(url) {\n        var validTurn = url.indexOf('turn:') === 0 &&\n            url.indexOf('transport=udp') !== -1 &&\n            url.indexOf('turn:[') === -1 &&\n            !hasTurn;\n\n        if (validTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n            url.indexOf('?transport=udp') === -1;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n\n// Determines the intersection of local and remote capabilities.\nfunction getCommonCapabilities(localCapabilities, remoteCapabilities) {\n  var commonCapabilities = {\n    codecs: [],\n    headerExtensions: [],\n    fecMechanisms: []\n  };\n\n  var findCodecByPayloadType = function(pt, codecs) {\n    pt = parseInt(pt, 10);\n    for (var i = 0; i < codecs.length; i++) {\n      if (codecs[i].payloadType === pt ||\n          codecs[i].preferredPayloadType === pt) {\n        return codecs[i];\n      }\n    }\n  };\n\n  var rtxCapabilityMatches = function(lRtx, rRtx, lCodecs, rCodecs) {\n    var lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n    var rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n    return lCodec && rCodec &&\n        lCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n  };\n\n  localCapabilities.codecs.forEach(function(lCodec) {\n    for (var i = 0; i < remoteCapabilities.codecs.length; i++) {\n      var rCodec = remoteCapabilities.codecs[i];\n      if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n          lCodec.clockRate === rCodec.clockRate) {\n        if (lCodec.name.toLowerCase() === 'rtx' &&\n            lCodec.parameters && rCodec.parameters.apt) {\n          // for RTX we need to find the local rtx that has a apt\n          // which points to the same local codec as the remote one.\n          if (!rtxCapabilityMatches(lCodec, rCodec,\n              localCapabilities.codecs, remoteCapabilities.codecs)) {\n            continue;\n          }\n        }\n        rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n        // number of channels is the highest common number of channels\n        rCodec.numChannels = Math.min(lCodec.numChannels,\n            rCodec.numChannels);\n        // push rCodec so we reply with offerer payload type\n        commonCapabilities.codecs.push(rCodec);\n\n        // determine common feedback mechanisms\n        rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter(function(fb) {\n          for (var j = 0; j < lCodec.rtcpFeedback.length; j++) {\n            if (lCodec.rtcpFeedback[j].type === fb.type &&\n                lCodec.rtcpFeedback[j].parameter === fb.parameter) {\n              return true;\n            }\n          }\n          return false;\n        });\n        // FIXME: also need to determine .parameters\n        //  see https://github.com/openpeer/ortc/issues/569\n        break;\n      }\n    }\n  });\n\n  localCapabilities.headerExtensions.forEach(function(lHeaderExtension) {\n    for (var i = 0; i < remoteCapabilities.headerExtensions.length;\n         i++) {\n      var rHeaderExtension = remoteCapabilities.headerExtensions[i];\n      if (lHeaderExtension.uri === rHeaderExtension.uri) {\n        commonCapabilities.headerExtensions.push(rHeaderExtension);\n        break;\n      }\n    }\n  });\n\n  // FIXME: fecMechanisms\n  return commonCapabilities;\n}\n\n// is action=setLocalDescription with type allowed in signalingState\nfunction isActionAllowedInSignalingState(action, type, signalingState) {\n  return {\n    offer: {\n      setLocalDescription: ['stable', 'have-local-offer'],\n      setRemoteDescription: ['stable', 'have-remote-offer']\n    },\n    answer: {\n      setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n      setRemoteDescription: ['have-local-offer', 'have-remote-pranswer']\n    }\n  }[type][action].indexOf(signalingState) !== -1;\n}\n\nfunction maybeAddCandidate(iceTransport, candidate) {\n  // Edge's internal representation adds some fields therefore\n  // not all fieldѕ are taken into account.\n  var alreadyAdded = iceTransport.getRemoteCandidates()\n      .find(function(remoteCandidate) {\n        return candidate.foundation === remoteCandidate.foundation &&\n            candidate.ip === remoteCandidate.ip &&\n            candidate.port === remoteCandidate.port &&\n            candidate.priority === remoteCandidate.priority &&\n            candidate.protocol === remoteCandidate.protocol &&\n            candidate.type === remoteCandidate.type;\n      });\n  if (!alreadyAdded) {\n    iceTransport.addRemoteCandidate(candidate);\n  }\n  return !alreadyAdded;\n}\n\n\nfunction makeError(name, description) {\n  var e = new Error(description);\n  e.name = name;\n  // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n  e.code = {\n    NotSupportedError: 9,\n    InvalidStateError: 11,\n    InvalidAccessError: 15,\n    TypeError: undefined,\n    OperationError: undefined\n  }[name];\n  return e;\n}\n\nmodule.exports = function(window, edgeVersion) {\n  // https://w3c.github.io/mediacapture-main/#mediastream\n  // Helper function to add the track to the stream and\n  // dispatch the event ourselves.\n  function addTrackToStreamAndFireEvent(track, stream) {\n    stream.addTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n        {track: track}));\n  }\n\n  function removeTrackFromStreamAndFireEvent(track, stream) {\n    stream.removeTrack(track);\n    stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n        {track: track}));\n  }\n\n  function fireAddTrack(pc, track, receiver, streams) {\n    var trackEvent = new Event('track');\n    trackEvent.track = track;\n    trackEvent.receiver = receiver;\n    trackEvent.transceiver = {receiver: receiver};\n    trackEvent.streams = streams;\n    window.setTimeout(function() {\n      pc._dispatchEvent('track', trackEvent);\n    });\n  }\n\n  var RTCPeerConnection = function(config) {\n    var pc = this;\n\n    var _eventTarget = document.createDocumentFragment();\n    ['addEventListener', 'removeEventListener', 'dispatchEvent']\n        .forEach(function(method) {\n          pc[method] = _eventTarget[method].bind(_eventTarget);\n        });\n\n    this.canTrickleIceCandidates = null;\n\n    this.needNegotiation = false;\n\n    this.localStreams = [];\n    this.remoteStreams = [];\n\n    this._localDescription = null;\n    this._remoteDescription = null;\n\n    this.signalingState = 'stable';\n    this.iceConnectionState = 'new';\n    this.connectionState = 'new';\n    this.iceGatheringState = 'new';\n\n    config = JSON.parse(JSON.stringify(config || {}));\n\n    this.usingBundle = config.bundlePolicy === 'max-bundle';\n    if (config.rtcpMuxPolicy === 'negotiate') {\n      throw(makeError('NotSupportedError',\n          'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n    } else if (!config.rtcpMuxPolicy) {\n      config.rtcpMuxPolicy = 'require';\n    }\n\n    switch (config.iceTransportPolicy) {\n      case 'all':\n      case 'relay':\n        break;\n      default:\n        config.iceTransportPolicy = 'all';\n        break;\n    }\n\n    switch (config.bundlePolicy) {\n      case 'balanced':\n      case 'max-compat':\n      case 'max-bundle':\n        break;\n      default:\n        config.bundlePolicy = 'balanced';\n        break;\n    }\n\n    config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n    this._iceGatherers = [];\n    if (config.iceCandidatePoolSize) {\n      for (var i = config.iceCandidatePoolSize; i > 0; i--) {\n        this._iceGatherers.push(new window.RTCIceGatherer({\n          iceServers: config.iceServers,\n          gatherPolicy: config.iceTransportPolicy\n        }));\n      }\n    } else {\n      config.iceCandidatePoolSize = 0;\n    }\n\n    this._config = config;\n\n    // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n    // everything that is needed to describe a SDP m-line.\n    this.transceivers = [];\n\n    this._sdpSessionId = SDPUtils.generateSessionId();\n    this._sdpSessionVersion = 0;\n\n    this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n    this._isClosed = false;\n  };\n\n  Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n    configurable: true,\n    get: function() {\n      return this._localDescription;\n    }\n  });\n  Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n    configurable: true,\n    get: function() {\n      return this._remoteDescription;\n    }\n  });\n\n  // set up event handlers on prototype\n  RTCPeerConnection.prototype.onicecandidate = null;\n  RTCPeerConnection.prototype.onaddstream = null;\n  RTCPeerConnection.prototype.ontrack = null;\n  RTCPeerConnection.prototype.onremovestream = null;\n  RTCPeerConnection.prototype.onsignalingstatechange = null;\n  RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n  RTCPeerConnection.prototype.onconnectionstatechange = null;\n  RTCPeerConnection.prototype.onicegatheringstatechange = null;\n  RTCPeerConnection.prototype.onnegotiationneeded = null;\n  RTCPeerConnection.prototype.ondatachannel = null;\n\n  RTCPeerConnection.prototype._dispatchEvent = function(name, event) {\n    if (this._isClosed) {\n      return;\n    }\n    this.dispatchEvent(event);\n    if (typeof this['on' + name] === 'function') {\n      this['on' + name](event);\n    }\n  };\n\n  RTCPeerConnection.prototype._emitGatheringStateChange = function() {\n    var event = new Event('icegatheringstatechange');\n    this._dispatchEvent('icegatheringstatechange', event);\n  };\n\n  RTCPeerConnection.prototype.getConfiguration = function() {\n    return this._config;\n  };\n\n  RTCPeerConnection.prototype.getLocalStreams = function() {\n    return this.localStreams;\n  };\n\n  RTCPeerConnection.prototype.getRemoteStreams = function() {\n    return this.remoteStreams;\n  };\n\n  // internal helper to create a transceiver object.\n  // (which is not yet the same as the WebRTC 1.0 transceiver)\n  RTCPeerConnection.prototype._createTransceiver = function(kind, doNotAdd) {\n    var hasBundleTransport = this.transceivers.length > 0;\n    var transceiver = {\n      track: null,\n      iceGatherer: null,\n      iceTransport: null,\n      dtlsTransport: null,\n      localCapabilities: null,\n      remoteCapabilities: null,\n      rtpSender: null,\n      rtpReceiver: null,\n      kind: kind,\n      mid: null,\n      sendEncodingParameters: null,\n      recvEncodingParameters: null,\n      stream: null,\n      associatedRemoteMediaStreams: [],\n      wantReceive: true\n    };\n    if (this.usingBundle && hasBundleTransport) {\n      transceiver.iceTransport = this.transceivers[0].iceTransport;\n      transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n    } else {\n      var transports = this._createIceAndDtlsTransports();\n      transceiver.iceTransport = transports.iceTransport;\n      transceiver.dtlsTransport = transports.dtlsTransport;\n    }\n    if (!doNotAdd) {\n      this.transceivers.push(transceiver);\n    }\n    return transceiver;\n  };\n\n  RTCPeerConnection.prototype.addTrack = function(track, stream) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call addTrack on a closed peerconnection.');\n    }\n\n    var alreadyExists = this.transceivers.find(function(s) {\n      return s.track === track;\n    });\n\n    if (alreadyExists) {\n      throw makeError('InvalidAccessError', 'Track already exists.');\n    }\n\n    var transceiver;\n    for (var i = 0; i < this.transceivers.length; i++) {\n      if (!this.transceivers[i].track &&\n          this.transceivers[i].kind === track.kind) {\n        transceiver = this.transceivers[i];\n      }\n    }\n    if (!transceiver) {\n      transceiver = this._createTransceiver(track.kind);\n    }\n\n    this._maybeFireNegotiationNeeded();\n\n    if (this.localStreams.indexOf(stream) === -1) {\n      this.localStreams.push(stream);\n    }\n\n    transceiver.track = track;\n    transceiver.stream = stream;\n    transceiver.rtpSender = new window.RTCRtpSender(track,\n        transceiver.dtlsTransport);\n    return transceiver.rtpSender;\n  };\n\n  RTCPeerConnection.prototype.addStream = function(stream) {\n    var pc = this;\n    if (edgeVersion >= 15025) {\n      stream.getTracks().forEach(function(track) {\n        pc.addTrack(track, stream);\n      });\n    } else {\n      // Clone is necessary for local demos mostly, attaching directly\n      // to two different senders does not work (build 10547).\n      // Fixed in 15025 (or earlier)\n      var clonedStream = stream.clone();\n      stream.getTracks().forEach(function(track, idx) {\n        var clonedTrack = clonedStream.getTracks()[idx];\n        track.addEventListener('enabled', function(event) {\n          clonedTrack.enabled = event.enabled;\n        });\n      });\n      clonedStream.getTracks().forEach(function(track) {\n        pc.addTrack(track, clonedStream);\n      });\n    }\n  };\n\n  RTCPeerConnection.prototype.removeTrack = function(sender) {\n    if (this._isClosed) {\n      throw makeError('InvalidStateError',\n          'Attempted to call removeTrack on a closed peerconnection.');\n    }\n\n    if (!(sender instanceof window.RTCRtpSender)) {\n      throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n          'does not implement interface RTCRtpSender.');\n    }\n\n    var transceiver = this.transceivers.find(function(t) {\n      return t.rtpSender === sender;\n    });\n\n    if (!transceiver) {\n      throw makeError('InvalidAccessError',\n          'Sender was not created by this connection.');\n    }\n    var stream = transceiver.stream;\n\n    transceiver.rtpSender.stop();\n    transceiver.rtpSender = null;\n    transceiver.track = null;\n    transceiver.stream = null;\n\n    // remove the stream from the set of local streams\n    var localStreams = this.transceivers.map(function(t) {\n      return t.stream;\n    });\n    if (localStreams.indexOf(stream) === -1 &&\n        this.localStreams.indexOf(stream) > -1) {\n      this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n    }\n\n    this._maybeFireNegotiationNeeded();\n  };\n\n  RTCPeerConnection.prototype.removeStream = function(stream) {\n    var pc = this;\n    stream.getTracks().forEach(function(track) {\n      var sender = pc.getSenders().find(function(s) {\n        return s.track === track;\n      });\n      if (sender) {\n        pc.removeTrack(sender);\n      }\n    });\n  };\n\n  RTCPeerConnection.prototype.getSenders = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpSender;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpSender;\n    });\n  };\n\n  RTCPeerConnection.prototype.getReceivers = function() {\n    return this.transceivers.filter(function(transceiver) {\n      return !!transceiver.rtpReceiver;\n    })\n    .map(function(transceiver) {\n      return transceiver.rtpReceiver;\n    });\n  };\n\n\n  RTCPeerConnection.prototype._createIceGatherer = function(sdpMLineIndex,\n      usingBundle) {\n    var pc = this;\n    if (usingBundle && sdpMLineIndex > 0) {\n      return this.transceivers[0].iceGatherer;\n    } else if (this._iceGatherers.length) {\n      return this._iceGatherers.shift();\n    }\n    var iceGatherer = new window.RTCIceGatherer({\n      iceServers: this._config.iceServers,\n      gatherPolicy: this._config.iceTransportPolicy\n    });\n    Object.defineProperty(iceGatherer, 'state',\n        {value: 'new', writable: true}\n    );\n\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n    this.transceivers[sdpMLineIndex].bufferCandidates = function(event) {\n      var end = !event.candidate || Object.keys(event.candidate).length === 0;\n      // polyfill since RTCIceGatherer.state is not implemented in\n      // Edge 10547 yet.\n      iceGatherer.state = end ? 'completed' : 'gathering';\n      if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n        pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n      }\n    };\n    iceGatherer.addEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    return iceGatherer;\n  };\n\n  // start gathering from an RTCIceGatherer.\n  RTCPeerConnection.prototype._gather = function(mid, sdpMLineIndex) {\n    var pc = this;\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer.onlocalcandidate) {\n      return;\n    }\n    var bufferedCandidateEvents =\n      this.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n    this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n    iceGatherer.removeEventListener('localcandidate',\n      this.transceivers[sdpMLineIndex].bufferCandidates);\n    iceGatherer.onlocalcandidate = function(evt) {\n      if (pc.usingBundle && sdpMLineIndex > 0) {\n        // if we know that we use bundle we can drop candidates with\n        // ѕdpMLineIndex > 0. If we don't do this then our state gets\n        // confused since we dispose the extra ice gatherer.\n        return;\n      }\n      var event = new Event('icecandidate');\n      event.candidate = {sdpMid: mid, sdpMLineIndex: sdpMLineIndex};\n\n      var cand = evt.candidate;\n      // Edge emits an empty object for RTCIceCandidateComplete‥\n      var end = !cand || Object.keys(cand).length === 0;\n      if (end) {\n        // polyfill since RTCIceGatherer.state is not implemented in\n        // Edge 10547 yet.\n        if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n          iceGatherer.state = 'completed';\n        }\n      } else {\n        if (iceGatherer.state === 'new') {\n          iceGatherer.state = 'gathering';\n        }\n        // RTCIceCandidate doesn't have a component, needs to be added\n        cand.component = 1;\n        // also the usernameFragment. TODO: update SDP to take both variants.\n        cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n        var serializedCandidate = SDPUtils.writeCandidate(cand);\n        event.candidate = Object.assign(event.candidate,\n            SDPUtils.parseCandidate(serializedCandidate));\n\n        event.candidate.candidate = serializedCandidate;\n        event.candidate.toJSON = function() {\n          return {\n            candidate: event.candidate.candidate,\n            sdpMid: event.candidate.sdpMid,\n            sdpMLineIndex: event.candidate.sdpMLineIndex,\n            usernameFragment: event.candidate.usernameFragment\n          };\n        };\n      }\n\n      // update local description.\n      var sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n      if (!end) {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=' + event.candidate.candidate + '\\r\\n';\n      } else {\n        sections[event.candidate.sdpMLineIndex] +=\n            'a=end-of-candidates\\r\\n';\n      }\n      pc._localDescription.sdp =\n          SDPUtils.getDescription(pc._localDescription.sdp) +\n          sections.join('');\n      var complete = pc.transceivers.every(function(transceiver) {\n        return transceiver.iceGatherer &&\n            transceiver.iceGatherer.state === 'completed';\n      });\n\n      if (pc.iceGatheringState !== 'gathering') {\n        pc.iceGatheringState = 'gathering';\n        pc._emitGatheringStateChange();\n      }\n\n      // Emit candidate. Also emit null candidate when all gatherers are\n      // complete.\n      if (!end) {\n        pc._dispatchEvent('icecandidate', event);\n      }\n      if (complete) {\n        pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n        pc.iceGatheringState = 'complete';\n        pc._emitGatheringStateChange();\n      }\n    };\n\n    // emit already gathered candidates.\n    window.setTimeout(function() {\n      bufferedCandidateEvents.forEach(function(e) {\n        iceGatherer.onlocalcandidate(e);\n      });\n    }, 0);\n  };\n\n  // Create ICE transport and DTLS transport.\n  RTCPeerConnection.prototype._createIceAndDtlsTransports = function() {\n    var pc = this;\n    var iceTransport = new window.RTCIceTransport(null);\n    iceTransport.onicestatechange = function() {\n      pc._updateIceConnectionState();\n      pc._updateConnectionState();\n    };\n\n    var dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n    dtlsTransport.ondtlsstatechange = function() {\n      pc._updateConnectionState();\n    };\n    dtlsTransport.onerror = function() {\n      // onerror does not set state to failed by itself.\n      Object.defineProperty(dtlsTransport, 'state',\n          {value: 'failed', writable: true});\n      pc._updateConnectionState();\n    };\n\n    return {\n      iceTransport: iceTransport,\n      dtlsTransport: dtlsTransport\n    };\n  };\n\n  // Destroy ICE gatherer, ICE transport and DTLS transport.\n  // Without triggering the callbacks.\n  RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function(\n      sdpMLineIndex) {\n    var iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n    if (iceGatherer) {\n      delete iceGatherer.onlocalcandidate;\n      delete this.transceivers[sdpMLineIndex].iceGatherer;\n    }\n    var iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n    if (iceTransport) {\n      delete iceTransport.onicestatechange;\n      delete this.transceivers[sdpMLineIndex].iceTransport;\n    }\n    var dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n    if (dtlsTransport) {\n      delete dtlsTransport.ondtlsstatechange;\n      delete dtlsTransport.onerror;\n      delete this.transceivers[sdpMLineIndex].dtlsTransport;\n    }\n  };\n\n  // Start the RTP Sender and Receiver for a transceiver.\n  RTCPeerConnection.prototype._transceive = function(transceiver,\n      send, recv) {\n    var params = getCommonCapabilities(transceiver.localCapabilities,\n        transceiver.remoteCapabilities);\n    if (send && transceiver.rtpSender) {\n      params.encodings = transceiver.sendEncodingParameters;\n      params.rtcp = {\n        cname: SDPUtils.localCName,\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.recvEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpSender.send(params);\n    }\n    if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n      // remove RTX field in Edge 14942\n      if (transceiver.kind === 'video'\n          && transceiver.recvEncodingParameters\n          && edgeVersion < 15019) {\n        transceiver.recvEncodingParameters.forEach(function(p) {\n          delete p.rtx;\n        });\n      }\n      if (transceiver.recvEncodingParameters.length) {\n        params.encodings = transceiver.recvEncodingParameters;\n      } else {\n        params.encodings = [{}];\n      }\n      params.rtcp = {\n        compound: transceiver.rtcpParameters.compound\n      };\n      if (transceiver.rtcpParameters.cname) {\n        params.rtcp.cname = transceiver.rtcpParameters.cname;\n      }\n      if (transceiver.sendEncodingParameters.length) {\n        params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n      }\n      transceiver.rtpReceiver.receive(params);\n    }\n  };\n\n  RTCPeerConnection.prototype.setLocalDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setLocalDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set local ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var sections;\n    var sessionpart;\n    if (description.type === 'offer') {\n      // VERY limited support for SDP munging. Limited to:\n      // * changing the order of codecs\n      sections = SDPUtils.splitSections(description.sdp);\n      sessionpart = sections.shift();\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var caps = SDPUtils.parseRtpParameters(mediaSection);\n        pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n      });\n\n      pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n        pc._gather(transceiver.mid, sdpMLineIndex);\n      });\n    } else if (description.type === 'answer') {\n      sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n      sessionpart = sections.shift();\n      var isIceLite = SDPUtils.matchPrefix(sessionpart,\n          'a=ice-lite').length > 0;\n      sections.forEach(function(mediaSection, sdpMLineIndex) {\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        var iceGatherer = transceiver.iceGatherer;\n        var iceTransport = transceiver.iceTransport;\n        var dtlsTransport = transceiver.dtlsTransport;\n        var localCapabilities = transceiver.localCapabilities;\n        var remoteCapabilities = transceiver.remoteCapabilities;\n\n        // treat bundle-only as not-rejected.\n        var rejected = SDPUtils.isRejected(mediaSection) &&\n            SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n        if (!rejected && !transceiver.rejected) {\n          var remoteIceParameters = SDPUtils.getIceParameters(\n              mediaSection, sessionpart);\n          var remoteDtlsParameters = SDPUtils.getDtlsParameters(\n              mediaSection, sessionpart);\n          if (isIceLite) {\n            remoteDtlsParameters.role = 'server';\n          }\n\n          if (!pc.usingBundle || sdpMLineIndex === 0) {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n            if (iceTransport.state === 'new') {\n              iceTransport.start(iceGatherer, remoteIceParameters,\n                  isIceLite ? 'controlling' : 'controlled');\n            }\n            if (dtlsTransport.state === 'new') {\n              dtlsTransport.start(remoteDtlsParameters);\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          var params = getCommonCapabilities(localCapabilities,\n              remoteCapabilities);\n\n          // Start the RTCRtpSender. The RTCRtpReceiver for this\n          // transceiver has already been started in setRemoteDescription.\n          pc._transceive(transceiver,\n              params.codecs.length > 0,\n              false);\n        }\n      });\n    }\n\n    pc._localDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-local-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.setRemoteDescription = function(description) {\n    var pc = this;\n\n    // Note: pranswer is not supported.\n    if (['offer', 'answer'].indexOf(description.type) === -1) {\n      return Promise.reject(makeError('TypeError',\n          'Unsupported type \"' + description.type + '\"'));\n    }\n\n    if (!isActionAllowedInSignalingState('setRemoteDescription',\n        description.type, pc.signalingState) || pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not set remote ' + description.type +\n          ' in state ' + pc.signalingState));\n    }\n\n    var streams = {};\n    pc.remoteStreams.forEach(function(stream) {\n      streams[stream.id] = stream;\n    });\n    var receiverList = [];\n    var sections = SDPUtils.splitSections(description.sdp);\n    var sessionpart = sections.shift();\n    var isIceLite = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-lite').length > 0;\n    var usingBundle = SDPUtils.matchPrefix(sessionpart,\n        'a=group:BUNDLE ').length > 0;\n    pc.usingBundle = usingBundle;\n    var iceOptions = SDPUtils.matchPrefix(sessionpart,\n        'a=ice-options:')[0];\n    if (iceOptions) {\n      pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n          .indexOf('trickle') >= 0;\n    } else {\n      pc.canTrickleIceCandidates = false;\n    }\n\n    sections.forEach(function(mediaSection, sdpMLineIndex) {\n      var lines = SDPUtils.splitLines(mediaSection);\n      var kind = SDPUtils.getKind(mediaSection);\n      // treat bundle-only as not-rejected.\n      var rejected = SDPUtils.isRejected(mediaSection) &&\n          SDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n      var protocol = lines[0].substr(2).split(' ')[2];\n\n      var direction = SDPUtils.getDirection(mediaSection, sessionpart);\n      var remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n      var mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n      // Reject datachannels which are not implemented yet.\n      if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n          protocol === 'UDP/DTLS/SCTP'))) {\n        // TODO: this is dangerous in the case where a non-rejected m-line\n        //     becomes rejected.\n        pc.transceivers[sdpMLineIndex] = {\n          mid: mid,\n          kind: kind,\n          protocol: protocol,\n          rejected: true\n        };\n        return;\n      }\n\n      if (!rejected && pc.transceivers[sdpMLineIndex] &&\n          pc.transceivers[sdpMLineIndex].rejected) {\n        // recycle a rejected transceiver.\n        pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n      }\n\n      var transceiver;\n      var iceGatherer;\n      var iceTransport;\n      var dtlsTransport;\n      var rtpReceiver;\n      var sendEncodingParameters;\n      var recvEncodingParameters;\n      var localCapabilities;\n\n      var track;\n      // FIXME: ensure the mediaSection has rtcp-mux set.\n      var remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n      var remoteIceParameters;\n      var remoteDtlsParameters;\n      if (!rejected) {\n        remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n            sessionpart);\n        remoteDtlsParameters.role = 'client';\n      }\n      recvEncodingParameters =\n          SDPUtils.parseRtpEncodingParameters(mediaSection);\n\n      var rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n      var isComplete = SDPUtils.matchPrefix(mediaSection,\n          'a=end-of-candidates', sessionpart).length > 0;\n      var cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n          .map(function(cand) {\n            return SDPUtils.parseCandidate(cand);\n          })\n          .filter(function(cand) {\n            return cand.component === 1;\n          });\n\n      // Check if we can use BUNDLE and dispose transports.\n      if ((description.type === 'offer' || description.type === 'answer') &&\n          !rejected && usingBundle && sdpMLineIndex > 0 &&\n          pc.transceivers[sdpMLineIndex]) {\n        pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n        pc.transceivers[sdpMLineIndex].iceGatherer =\n            pc.transceivers[0].iceGatherer;\n        pc.transceivers[sdpMLineIndex].iceTransport =\n            pc.transceivers[0].iceTransport;\n        pc.transceivers[sdpMLineIndex].dtlsTransport =\n            pc.transceivers[0].dtlsTransport;\n        if (pc.transceivers[sdpMLineIndex].rtpSender) {\n          pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n        if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n          pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n              pc.transceivers[0].dtlsTransport);\n        }\n      }\n      if (description.type === 'offer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex] ||\n            pc._createTransceiver(kind);\n        transceiver.mid = mid;\n\n        if (!transceiver.iceGatherer) {\n          transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n              usingBundle);\n        }\n\n        if (cands.length && transceiver.iceTransport.state === 'new') {\n          if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n            transceiver.iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n        // filter RTX until additional stuff needed for RTX is implemented\n        // in adapter.js\n        if (edgeVersion < 15019) {\n          localCapabilities.codecs = localCapabilities.codecs.filter(\n              function(codec) {\n                return codec.name !== 'rtx';\n              });\n        }\n\n        sendEncodingParameters = transceiver.sendEncodingParameters || [{\n          ssrc: (2 * sdpMLineIndex + 2) * 1001\n        }];\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        var isNewTrack = false;\n        if (direction === 'sendrecv' || direction === 'sendonly') {\n          isNewTrack = !transceiver.rtpReceiver;\n          rtpReceiver = transceiver.rtpReceiver ||\n              new window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n          if (isNewTrack) {\n            var stream;\n            track = rtpReceiver.track;\n            // FIXME: does not work with Plan B.\n            if (remoteMsid && remoteMsid.stream === '-') {\n              // no-op. a stream id of '-' means: no associated stream.\n            } else if (remoteMsid) {\n              if (!streams[remoteMsid.stream]) {\n                streams[remoteMsid.stream] = new window.MediaStream();\n                Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                  get: function() {\n                    return remoteMsid.stream;\n                  }\n                });\n              }\n              Object.defineProperty(track, 'id', {\n                get: function() {\n                  return remoteMsid.track;\n                }\n              });\n              stream = streams[remoteMsid.stream];\n            } else {\n              if (!streams.default) {\n                streams.default = new window.MediaStream();\n              }\n              stream = streams.default;\n            }\n            if (stream) {\n              addTrackToStreamAndFireEvent(track, stream);\n              transceiver.associatedRemoteMediaStreams.push(stream);\n            }\n            receiverList.push([track, rtpReceiver, stream]);\n          }\n        } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n          transceiver.associatedRemoteMediaStreams.forEach(function(s) {\n            var nativeTrack = s.getTracks().find(function(t) {\n              return t.id === transceiver.rtpReceiver.track.id;\n            });\n            if (nativeTrack) {\n              removeTrackFromStreamAndFireEvent(nativeTrack, s);\n            }\n          });\n          transceiver.associatedRemoteMediaStreams = [];\n        }\n\n        transceiver.localCapabilities = localCapabilities;\n        transceiver.remoteCapabilities = remoteCapabilities;\n        transceiver.rtpReceiver = rtpReceiver;\n        transceiver.rtcpParameters = rtcpParameters;\n        transceiver.sendEncodingParameters = sendEncodingParameters;\n        transceiver.recvEncodingParameters = recvEncodingParameters;\n\n        // Start the RTCRtpReceiver now. The RTPSender is started in\n        // setLocalDescription.\n        pc._transceive(pc.transceivers[sdpMLineIndex],\n            false,\n            isNewTrack);\n      } else if (description.type === 'answer' && !rejected) {\n        transceiver = pc.transceivers[sdpMLineIndex];\n        iceGatherer = transceiver.iceGatherer;\n        iceTransport = transceiver.iceTransport;\n        dtlsTransport = transceiver.dtlsTransport;\n        rtpReceiver = transceiver.rtpReceiver;\n        sendEncodingParameters = transceiver.sendEncodingParameters;\n        localCapabilities = transceiver.localCapabilities;\n\n        pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n            recvEncodingParameters;\n        pc.transceivers[sdpMLineIndex].remoteCapabilities =\n            remoteCapabilities;\n        pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n        if (cands.length && iceTransport.state === 'new') {\n          if ((isIceLite || isComplete) &&\n              (!usingBundle || sdpMLineIndex === 0)) {\n            iceTransport.setRemoteCandidates(cands);\n          } else {\n            cands.forEach(function(candidate) {\n              maybeAddCandidate(transceiver.iceTransport, candidate);\n            });\n          }\n        }\n\n        if (!usingBundle || sdpMLineIndex === 0) {\n          if (iceTransport.state === 'new') {\n            iceTransport.start(iceGatherer, remoteIceParameters,\n                'controlling');\n          }\n          if (dtlsTransport.state === 'new') {\n            dtlsTransport.start(remoteDtlsParameters);\n          }\n        }\n\n        // If the offer contained RTX but the answer did not,\n        // remove RTX from sendEncodingParameters.\n        var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n        var hasRtx = commonCapabilities.codecs.filter(function(c) {\n          return c.name.toLowerCase() === 'rtx';\n        }).length;\n        if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n          delete transceiver.sendEncodingParameters[0].rtx;\n        }\n\n        pc._transceive(transceiver,\n            direction === 'sendrecv' || direction === 'recvonly',\n            direction === 'sendrecv' || direction === 'sendonly');\n\n        // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n        if (rtpReceiver &&\n            (direction === 'sendrecv' || direction === 'sendonly')) {\n          track = rtpReceiver.track;\n          if (remoteMsid) {\n            if (!streams[remoteMsid.stream]) {\n              streams[remoteMsid.stream] = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n            receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n          } else {\n            if (!streams.default) {\n              streams.default = new window.MediaStream();\n            }\n            addTrackToStreamAndFireEvent(track, streams.default);\n            receiverList.push([track, rtpReceiver, streams.default]);\n          }\n        } else {\n          // FIXME: actually the receiver should be created later.\n          delete transceiver.rtpReceiver;\n        }\n      }\n    });\n\n    if (pc._dtlsRole === undefined) {\n      pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n    }\n\n    pc._remoteDescription = {\n      type: description.type,\n      sdp: description.sdp\n    };\n    if (description.type === 'offer') {\n      pc._updateSignalingState('have-remote-offer');\n    } else {\n      pc._updateSignalingState('stable');\n    }\n    Object.keys(streams).forEach(function(sid) {\n      var stream = streams[sid];\n      if (stream.getTracks().length) {\n        if (pc.remoteStreams.indexOf(stream) === -1) {\n          pc.remoteStreams.push(stream);\n          var event = new Event('addstream');\n          event.stream = stream;\n          window.setTimeout(function() {\n            pc._dispatchEvent('addstream', event);\n          });\n        }\n\n        receiverList.forEach(function(item) {\n          var track = item[0];\n          var receiver = item[1];\n          if (stream.id !== item[2].id) {\n            return;\n          }\n          fireAddTrack(pc, track, receiver, [stream]);\n        });\n      }\n    });\n    receiverList.forEach(function(item) {\n      if (item[2]) {\n        return;\n      }\n      fireAddTrack(pc, item[0], item[1], []);\n    });\n\n    // check whether addIceCandidate({}) was called within four seconds after\n    // setRemoteDescription.\n    window.setTimeout(function() {\n      if (!(pc && pc.transceivers)) {\n        return;\n      }\n      pc.transceivers.forEach(function(transceiver) {\n        if (transceiver.iceTransport &&\n            transceiver.iceTransport.state === 'new' &&\n            transceiver.iceTransport.getRemoteCandidates().length > 0) {\n          console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n              'an end-of-candidates notification');\n          transceiver.iceTransport.addRemoteCandidate({});\n        }\n      });\n    }, 4000);\n\n    return Promise.resolve();\n  };\n\n  RTCPeerConnection.prototype.close = function() {\n    this.transceivers.forEach(function(transceiver) {\n      /* not yet\n      if (transceiver.iceGatherer) {\n        transceiver.iceGatherer.close();\n      }\n      */\n      if (transceiver.iceTransport) {\n        transceiver.iceTransport.stop();\n      }\n      if (transceiver.dtlsTransport) {\n        transceiver.dtlsTransport.stop();\n      }\n      if (transceiver.rtpSender) {\n        transceiver.rtpSender.stop();\n      }\n      if (transceiver.rtpReceiver) {\n        transceiver.rtpReceiver.stop();\n      }\n    });\n    // FIXME: clean up tracks, local streams, remote streams, etc\n    this._isClosed = true;\n    this._updateSignalingState('closed');\n  };\n\n  // Update the signaling state.\n  RTCPeerConnection.prototype._updateSignalingState = function(newState) {\n    this.signalingState = newState;\n    var event = new Event('signalingstatechange');\n    this._dispatchEvent('signalingstatechange', event);\n  };\n\n  // Determine whether to fire the negotiationneeded event.\n  RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function() {\n    var pc = this;\n    if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n      return;\n    }\n    this.needNegotiation = true;\n    window.setTimeout(function() {\n      if (pc.needNegotiation) {\n        pc.needNegotiation = false;\n        var event = new Event('negotiationneeded');\n        pc._dispatchEvent('negotiationneeded', event);\n      }\n    }, 0);\n  };\n\n  // Update the ice connection state.\n  RTCPeerConnection.prototype._updateIceConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      checking: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n      }\n    });\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.checking > 0) {\n      newState = 'checking';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    } else if (states.completed > 0) {\n      newState = 'completed';\n    }\n\n    if (newState !== this.iceConnectionState) {\n      this.iceConnectionState = newState;\n      var event = new Event('iceconnectionstatechange');\n      this._dispatchEvent('iceconnectionstatechange', event);\n    }\n  };\n\n  // Update the connection state.\n  RTCPeerConnection.prototype._updateConnectionState = function() {\n    var newState;\n    var states = {\n      'new': 0,\n      closed: 0,\n      connecting: 0,\n      connected: 0,\n      completed: 0,\n      disconnected: 0,\n      failed: 0\n    };\n    this.transceivers.forEach(function(transceiver) {\n      if (transceiver.iceTransport && transceiver.dtlsTransport &&\n          !transceiver.rejected) {\n        states[transceiver.iceTransport.state]++;\n        states[transceiver.dtlsTransport.state]++;\n      }\n    });\n    // ICETransport.completed and connected are the same for this purpose.\n    states.connected += states.completed;\n\n    newState = 'new';\n    if (states.failed > 0) {\n      newState = 'failed';\n    } else if (states.connecting > 0) {\n      newState = 'connecting';\n    } else if (states.disconnected > 0) {\n      newState = 'disconnected';\n    } else if (states.new > 0) {\n      newState = 'new';\n    } else if (states.connected > 0) {\n      newState = 'connected';\n    }\n\n    if (newState !== this.connectionState) {\n      this.connectionState = newState;\n      var event = new Event('connectionstatechange');\n      this._dispatchEvent('connectionstatechange', event);\n    }\n  };\n\n  RTCPeerConnection.prototype.createOffer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createOffer after close'));\n    }\n\n    var numAudioTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'audio';\n    }).length;\n    var numVideoTracks = pc.transceivers.filter(function(t) {\n      return t.kind === 'video';\n    }).length;\n\n    // Determine number of audio and video tracks we need to send/recv.\n    var offerOptions = arguments[0];\n    if (offerOptions) {\n      // Reject Chrome legacy constraints.\n      if (offerOptions.mandatory || offerOptions.optional) {\n        throw new TypeError(\n            'Legacy mandatory/optional constraints not supported.');\n      }\n      if (offerOptions.offerToReceiveAudio !== undefined) {\n        if (offerOptions.offerToReceiveAudio === true) {\n          numAudioTracks = 1;\n        } else if (offerOptions.offerToReceiveAudio === false) {\n          numAudioTracks = 0;\n        } else {\n          numAudioTracks = offerOptions.offerToReceiveAudio;\n        }\n      }\n      if (offerOptions.offerToReceiveVideo !== undefined) {\n        if (offerOptions.offerToReceiveVideo === true) {\n          numVideoTracks = 1;\n        } else if (offerOptions.offerToReceiveVideo === false) {\n          numVideoTracks = 0;\n        } else {\n          numVideoTracks = offerOptions.offerToReceiveVideo;\n        }\n      }\n    }\n\n    pc.transceivers.forEach(function(transceiver) {\n      if (transceiver.kind === 'audio') {\n        numAudioTracks--;\n        if (numAudioTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      } else if (transceiver.kind === 'video') {\n        numVideoTracks--;\n        if (numVideoTracks < 0) {\n          transceiver.wantReceive = false;\n        }\n      }\n    });\n\n    // Create M-lines for recvonly streams.\n    while (numAudioTracks > 0 || numVideoTracks > 0) {\n      if (numAudioTracks > 0) {\n        pc._createTransceiver('audio');\n        numAudioTracks--;\n      }\n      if (numVideoTracks > 0) {\n        pc._createTransceiver('video');\n        numVideoTracks--;\n      }\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      // For each track, create an ice gatherer, ice transport,\n      // dtls transport, potentially rtpsender and rtpreceiver.\n      var track = transceiver.track;\n      var kind = transceiver.kind;\n      var mid = transceiver.mid || SDPUtils.generateIdentifier();\n      transceiver.mid = mid;\n\n      if (!transceiver.iceGatherer) {\n        transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n            pc.usingBundle);\n      }\n\n      var localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n      // filter RTX until additional stuff needed for RTX is implemented\n      // in adapter.js\n      if (edgeVersion < 15019) {\n        localCapabilities.codecs = localCapabilities.codecs.filter(\n            function(codec) {\n              return codec.name !== 'rtx';\n            });\n      }\n      localCapabilities.codecs.forEach(function(codec) {\n        // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n        // by adding level-asymmetry-allowed=1\n        if (codec.name === 'H264' &&\n            codec.parameters['level-asymmetry-allowed'] === undefined) {\n          codec.parameters['level-asymmetry-allowed'] = '1';\n        }\n\n        // for subsequent offers, we might have to re-use the payload\n        // type of the last offer.\n        if (transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.codecs) {\n          transceiver.remoteCapabilities.codecs.forEach(function(remoteCodec) {\n            if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n                codec.clockRate === remoteCodec.clockRate) {\n              codec.preferredPayloadType = remoteCodec.payloadType;\n            }\n          });\n        }\n      });\n      localCapabilities.headerExtensions.forEach(function(hdrExt) {\n        var remoteExtensions = transceiver.remoteCapabilities &&\n            transceiver.remoteCapabilities.headerExtensions || [];\n        remoteExtensions.forEach(function(rHdrExt) {\n          if (hdrExt.uri === rHdrExt.uri) {\n            hdrExt.id = rHdrExt.id;\n          }\n        });\n      });\n\n      // generate an ssrc now, to be used later in rtpSender.send\n      var sendEncodingParameters = transceiver.sendEncodingParameters || [{\n        ssrc: (2 * sdpMLineIndex + 1) * 1001\n      }];\n      if (track) {\n        // add RTX\n        if (edgeVersion >= 15019 && kind === 'video' &&\n            !sendEncodingParameters[0].rtx) {\n          sendEncodingParameters[0].rtx = {\n            ssrc: sendEncodingParameters[0].ssrc + 1\n          };\n        }\n      }\n\n      if (transceiver.wantReceive) {\n        transceiver.rtpReceiver = new window.RTCRtpReceiver(\n            transceiver.dtlsTransport, kind);\n      }\n\n      transceiver.localCapabilities = localCapabilities;\n      transceiver.sendEncodingParameters = sendEncodingParameters;\n    });\n\n    // always offer BUNDLE and dispose on return if not supported.\n    if (pc._config.bundlePolicy !== 'max-compat') {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n          'offer', transceiver.stream, pc._dtlsRole);\n      sdp += 'a=rtcp-rsize\\r\\n';\n\n      if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n          (sdpMLineIndex === 0 || !pc.usingBundle)) {\n        transceiver.iceGatherer.getLocalCandidates().forEach(function(cand) {\n          cand.component = 1;\n          sdp += 'a=' + SDPUtils.writeCandidate(cand) + '\\r\\n';\n        });\n\n        if (transceiver.iceGatherer.state === 'completed') {\n          sdp += 'a=end-of-candidates\\r\\n';\n        }\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'offer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.createAnswer = function() {\n    var pc = this;\n\n    if (pc._isClosed) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer after close'));\n    }\n\n    if (!(pc.signalingState === 'have-remote-offer' ||\n        pc.signalingState === 'have-local-pranswer')) {\n      return Promise.reject(makeError('InvalidStateError',\n          'Can not call createAnswer in signalingState ' + pc.signalingState));\n    }\n\n    var sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n        pc._sdpSessionVersion++);\n    if (pc.usingBundle) {\n      sdp += 'a=group:BUNDLE ' + pc.transceivers.map(function(t) {\n        return t.mid;\n      }).join(' ') + '\\r\\n';\n    }\n    sdp += 'a=ice-options:trickle\\r\\n';\n\n    var mediaSectionsInOffer = SDPUtils.getMediaSections(\n        pc._remoteDescription.sdp).length;\n    pc.transceivers.forEach(function(transceiver, sdpMLineIndex) {\n      if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n        return;\n      }\n      if (transceiver.rejected) {\n        if (transceiver.kind === 'application') {\n          if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n            sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n          } else {\n            sdp += 'm=application 0 ' + transceiver.protocol +\n                ' webrtc-datachannel\\r\\n';\n          }\n        } else if (transceiver.kind === 'audio') {\n          sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n              'a=rtpmap:0 PCMU/8000\\r\\n';\n        } else if (transceiver.kind === 'video') {\n          sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n              'a=rtpmap:120 VP8/90000\\r\\n';\n        }\n        sdp += 'c=IN IP4 0.0.0.0\\r\\n' +\n            'a=inactive\\r\\n' +\n            'a=mid:' + transceiver.mid + '\\r\\n';\n        return;\n      }\n\n      // FIXME: look at direction.\n      if (transceiver.stream) {\n        var localTrack;\n        if (transceiver.kind === 'audio') {\n          localTrack = transceiver.stream.getAudioTracks()[0];\n        } else if (transceiver.kind === 'video') {\n          localTrack = transceiver.stream.getVideoTracks()[0];\n        }\n        if (localTrack) {\n          // add RTX\n          if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n              !transceiver.sendEncodingParameters[0].rtx) {\n            transceiver.sendEncodingParameters[0].rtx = {\n              ssrc: transceiver.sendEncodingParameters[0].ssrc + 1\n            };\n          }\n        }\n      }\n\n      // Calculate intersection of capabilities.\n      var commonCapabilities = getCommonCapabilities(\n          transceiver.localCapabilities,\n          transceiver.remoteCapabilities);\n\n      var hasRtx = commonCapabilities.codecs.filter(function(c) {\n        return c.name.toLowerCase() === 'rtx';\n      }).length;\n      if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n        delete transceiver.sendEncodingParameters[0].rtx;\n      }\n\n      sdp += writeMediaSection(transceiver, commonCapabilities,\n          'answer', transceiver.stream, pc._dtlsRole);\n      if (transceiver.rtcpParameters &&\n          transceiver.rtcpParameters.reducedSize) {\n        sdp += 'a=rtcp-rsize\\r\\n';\n      }\n    });\n\n    var desc = new window.RTCSessionDescription({\n      type: 'answer',\n      sdp: sdp\n    });\n    return Promise.resolve(desc);\n  };\n\n  RTCPeerConnection.prototype.addIceCandidate = function(candidate) {\n    var pc = this;\n    var sections;\n    if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n        candidate.sdpMid)) {\n      return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n    }\n\n    // TODO: needs to go into ops queue.\n    return new Promise(function(resolve, reject) {\n      if (!pc._remoteDescription) {\n        return reject(makeError('InvalidStateError',\n            'Can not add ICE candidate without a remote description'));\n      } else if (!candidate || candidate.candidate === '') {\n        for (var j = 0; j < pc.transceivers.length; j++) {\n          if (pc.transceivers[j].rejected) {\n            continue;\n          }\n          pc.transceivers[j].iceTransport.addRemoteCandidate({});\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[j] += 'a=end-of-candidates\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n          if (pc.usingBundle) {\n            break;\n          }\n        }\n      } else {\n        var sdpMLineIndex = candidate.sdpMLineIndex;\n        if (candidate.sdpMid) {\n          for (var i = 0; i < pc.transceivers.length; i++) {\n            if (pc.transceivers[i].mid === candidate.sdpMid) {\n              sdpMLineIndex = i;\n              break;\n            }\n          }\n        }\n        var transceiver = pc.transceivers[sdpMLineIndex];\n        if (transceiver) {\n          if (transceiver.rejected) {\n            return resolve();\n          }\n          var cand = Object.keys(candidate.candidate).length > 0 ?\n              SDPUtils.parseCandidate(candidate.candidate) : {};\n          // Ignore Chrome's invalid candidates since Edge does not like them.\n          if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n            return resolve();\n          }\n          // Ignore RTCP candidates, we assume RTCP-MUX.\n          if (cand.component && cand.component !== 1) {\n            return resolve();\n          }\n          // when using bundle, avoid adding candidates to the wrong\n          // ice transport. And avoid adding candidates added in the SDP.\n          if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n              transceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n            if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n\n          // update the remoteDescription.\n          var candidateString = candidate.candidate.trim();\n          if (candidateString.indexOf('a=') === 0) {\n            candidateString = candidateString.substr(2);\n          }\n          sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n          sections[sdpMLineIndex] += 'a=' +\n              (cand.type ? candidateString : 'end-of-candidates')\n              + '\\r\\n';\n          pc._remoteDescription.sdp =\n              SDPUtils.getDescription(pc._remoteDescription.sdp) +\n              sections.join('');\n        } else {\n          return reject(makeError('OperationError',\n              'Can not add ICE candidate'));\n        }\n      }\n      resolve();\n    });\n  };\n\n  RTCPeerConnection.prototype.getStats = function(selector) {\n    if (selector && selector instanceof window.MediaStreamTrack) {\n      var senderOrReceiver = null;\n      this.transceivers.forEach(function(transceiver) {\n        if (transceiver.rtpSender &&\n            transceiver.rtpSender.track === selector) {\n          senderOrReceiver = transceiver.rtpSender;\n        } else if (transceiver.rtpReceiver &&\n            transceiver.rtpReceiver.track === selector) {\n          senderOrReceiver = transceiver.rtpReceiver;\n        }\n      });\n      if (!senderOrReceiver) {\n        throw makeError('InvalidAccessError', 'Invalid selector.');\n      }\n      return senderOrReceiver.getStats();\n    }\n\n    var promises = [];\n    this.transceivers.forEach(function(transceiver) {\n      ['rtpSender', 'rtpReceiver', 'iceGatherer', 'iceTransport',\n          'dtlsTransport'].forEach(function(method) {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n    });\n    return Promise.all(promises).then(function(allStats) {\n      var results = new Map();\n      allStats.forEach(function(stats) {\n        stats.forEach(function(stat) {\n          results.set(stat.id, stat);\n        });\n      });\n      return results;\n    });\n  };\n\n  // fix low-level stat names and return Map instead of object.\n  var ortcObjects = ['RTCRtpSender', 'RTCRtpReceiver', 'RTCIceGatherer',\n    'RTCIceTransport', 'RTCDtlsTransport'];\n  ortcObjects.forEach(function(ortcObjectName) {\n    var obj = window[ortcObjectName];\n    if (obj && obj.prototype && obj.prototype.getStats) {\n      var nativeGetstats = obj.prototype.getStats;\n      obj.prototype.getStats = function() {\n        return nativeGetstats.apply(this)\n        .then(function(nativeStats) {\n          var mapStats = new Map();\n          Object.keys(nativeStats).forEach(function(id) {\n            nativeStats[id].type = fixStatsType(nativeStats[id]);\n            mapStats.set(id, nativeStats[id]);\n          });\n          return mapStats;\n        });\n      };\n    }\n  });\n\n  // legacy callback shims. Should be moved to adapter.js some days.\n  var methods = ['createOffer', 'createAnswer'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[0] === 'function' ||\n          typeof args[1] === 'function') { // legacy\n        return nativeMethod.apply(this, [arguments[2]])\n        .then(function(description) {\n          if (typeof args[0] === 'function') {\n            args[0].apply(null, [description]);\n          }\n        }, function(error) {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n  methods.forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function' ||\n          typeof args[2] === 'function') { // legacy\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        }, function(error) {\n          if (typeof args[2] === 'function') {\n            args[2].apply(null, [error]);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  // getStats is special. It doesn't have a spec legacy method yet we support\n  // getStats(something, cb) without error callbacks.\n  ['getStats'].forEach(function(method) {\n    var nativeMethod = RTCPeerConnection.prototype[method];\n    RTCPeerConnection.prototype[method] = function() {\n      var args = arguments;\n      if (typeof args[1] === 'function') {\n        return nativeMethod.apply(this, arguments)\n        .then(function() {\n          if (typeof args[1] === 'function') {\n            args[1].apply(null);\n          }\n        });\n      }\n      return nativeMethod.apply(this, arguments);\n    };\n  });\n\n  return RTCPeerConnection;\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var navigator = window && window.navigator;\n\n  var shimError_ = function(e) {\n    return {\n      name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n      message: e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name;\n      }\n    };\n  };\n\n  // getUserMedia error shim.\n  var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n      bind(navigator.mediaDevices);\n  navigator.mediaDevices.getUserMedia = function(c) {\n    return origGetUserMedia(c).catch(function(e) {\n      return Promise.reject(shimError_(e));\n    });\n  };\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\nvar filterIceServers = require('./filtericeservers');\nvar shimRTCPeerConnection = require('rtcpeerconnection-shim');\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    if (window.RTCIceGatherer) {\n      if (!window.RTCIceCandidate) {\n        window.RTCIceCandidate = function(args) {\n          return args;\n        };\n      }\n      if (!window.RTCSessionDescription) {\n        window.RTCSessionDescription = function(args) {\n          return args;\n        };\n      }\n      // this adds an additional event listener to MediaStrackTrack that signals\n      // when a tracks enabled property was changed. Workaround for a bug in\n      // addStream, see below. No longer required in 15025+\n      if (browserDetails.version < 15025) {\n        var origMSTEnabled = Object.getOwnPropertyDescriptor(\n            window.MediaStreamTrack.prototype, 'enabled');\n        Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n          set: function(value) {\n            origMSTEnabled.set.call(this, value);\n            var ev = new Event('enabled');\n            ev.enabled = value;\n            this.dispatchEvent(ev);\n          }\n        });\n      }\n    }\n\n    // ORTC defines the DTMF sender a bit different.\n    // https://github.com/w3c/ortc/issues/714\n    if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n        get: function() {\n          if (this._dtmf === undefined) {\n            if (this.track.kind === 'audio') {\n              this._dtmf = new window.RTCDtmfSender(this);\n            } else if (this.track.kind === 'video') {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        }\n      });\n    }\n    // Edge currently only implements the RTCDtmfSender, not the\n    // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n    if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n      window.RTCDTMFSender = window.RTCDtmfSender;\n    }\n\n    var RTCPeerConnectionShim = shimRTCPeerConnection(window,\n        browserDetails.version);\n    window.RTCPeerConnection = function(config) {\n      if (config && config.iceServers) {\n        config.iceServers = filterIceServers(config.iceServers);\n      }\n      return new RTCPeerConnectionShim(config);\n    };\n    window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n  },\n  shimReplaceTrack: function(window) {\n    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n    if (window.RTCRtpSender &&\n        !('replaceTrack' in window.RTCRtpSender.prototype)) {\n      window.RTCRtpSender.prototype.replaceTrack =\n          window.RTCRtpSender.prototype.setTrack;\n    }\n  },\n  shimGetDisplayMedia: function(window, preferredMediaSource) {\n    if (!('getDisplayMedia' in window.navigator) ||\n        !window.navigator.mediaDevices ||\n        'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    var origGetDisplayMedia = window.navigator.getDisplayMedia;\n    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {\n      return origGetDisplayMedia.call(window.navigator, constraints);\n    };\n    window.navigator.getDisplayMedia = function(constraints) {\n      utils.deprecated('navigator.getDisplayMedia',\n          'navigator.mediaDevices.getDisplayMedia');\n      return origGetDisplayMedia.call(window.navigator, constraints);\n    };\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\nvar logging = utils.log;\n\n// Expose public methods.\nmodule.exports = function(window) {\n  var browserDetails = utils.detectBrowser(window);\n  var navigator = window && window.navigator;\n  var MediaStreamTrack = window && window.MediaStreamTrack;\n\n  var shimError_ = function(e) {\n    return {\n      name: {\n        InternalError: 'NotReadableError',\n        NotSupportedError: 'TypeError',\n        PermissionDeniedError: 'NotAllowedError',\n        SecurityError: 'NotAllowedError'\n      }[e.name] || e.name,\n      message: {\n        'The operation is insecure.': 'The request is not allowed by the ' +\n        'user agent or the platform in the current context.'\n      }[e.message] || e.message,\n      constraint: e.constraint,\n      toString: function() {\n        return this.name + (this.message && ': ') + this.message;\n      }\n    };\n  };\n\n  // getUserMedia constraints shim.\n  var getUserMedia_ = function(constraints, onSuccess, onError) {\n    var constraintsToFF37_ = function(c) {\n      if (typeof c !== 'object' || c.require) {\n        return c;\n      }\n      var require = [];\n      Object.keys(c).forEach(function(key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = c[key] = (typeof c[key] === 'object') ?\n            c[key] : {ideal: c[key]};\n        if (r.min !== undefined ||\n            r.max !== undefined || r.exact !== undefined) {\n          require.push(key);\n        }\n        if (r.exact !== undefined) {\n          if (typeof r.exact === 'number') {\n            r. min = r.max = r.exact;\n          } else {\n            c[key] = r.exact;\n          }\n          delete r.exact;\n        }\n        if (r.ideal !== undefined) {\n          c.advanced = c.advanced || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[key] = {min: r.ideal, max: r.ideal};\n          } else {\n            oc[key] = r.ideal;\n          }\n          c.advanced.push(oc);\n          delete r.ideal;\n          if (!Object.keys(r).length) {\n            delete c[key];\n          }\n        }\n      });\n      if (require.length) {\n        c.require = require;\n      }\n      return c;\n    };\n    constraints = JSON.parse(JSON.stringify(constraints));\n    if (browserDetails.version < 38) {\n      logging('spec: ' + JSON.stringify(constraints));\n      if (constraints.audio) {\n        constraints.audio = constraintsToFF37_(constraints.audio);\n      }\n      if (constraints.video) {\n        constraints.video = constraintsToFF37_(constraints.video);\n      }\n      logging('ff37: ' + JSON.stringify(constraints));\n    }\n    return navigator.mozGetUserMedia(constraints, onSuccess, function(e) {\n      onError(shimError_(e));\n    });\n  };\n\n  // Returns the result of getUserMedia as a Promise.\n  var getUserMediaPromise_ = function(constraints) {\n    return new Promise(function(resolve, reject) {\n      getUserMedia_(constraints, resolve, reject);\n    });\n  };\n\n  // Shim for mediaDevices on older versions.\n  if (!navigator.mediaDevices) {\n    navigator.mediaDevices = {getUserMedia: getUserMediaPromise_,\n      addEventListener: function() { },\n      removeEventListener: function() { }\n    };\n  }\n  navigator.mediaDevices.enumerateDevices =\n      navigator.mediaDevices.enumerateDevices || function() {\n        return new Promise(function(resolve) {\n          var infos = [\n            {kind: 'audioinput', deviceId: 'default', label: '', groupId: ''},\n            {kind: 'videoinput', deviceId: 'default', label: '', groupId: ''}\n          ];\n          resolve(infos);\n        });\n      };\n\n  if (browserDetails.version < 41) {\n    // Work around http://bugzil.la/1169665\n    var orgEnumerateDevices =\n        navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);\n    navigator.mediaDevices.enumerateDevices = function() {\n      return orgEnumerateDevices().then(undefined, function(e) {\n        if (e.name === 'NotFoundError') {\n          return [];\n        }\n        throw e;\n      });\n    };\n  }\n  if (browserDetails.version < 49) {\n    var origGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      return origGetUserMedia(c).then(function(stream) {\n        // Work around https://bugzil.la/802326\n        if (c.audio && !stream.getAudioTracks().length ||\n            c.video && !stream.getVideoTracks().length) {\n          stream.getTracks().forEach(function(track) {\n            track.stop();\n          });\n          throw new DOMException('The object can not be found here.',\n                                 'NotFoundError');\n        }\n        return stream;\n      }, function(e) {\n        return Promise.reject(shimError_(e));\n      });\n    };\n  }\n  if (!(browserDetails.version > 55 &&\n      'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n    var remap = function(obj, a, b) {\n      if (a in obj && !(b in obj)) {\n        obj[b] = obj[a];\n        delete obj[a];\n      }\n    };\n\n    var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.\n        bind(navigator.mediaDevices);\n    navigator.mediaDevices.getUserMedia = function(c) {\n      if (typeof c === 'object' && typeof c.audio === 'object') {\n        c = JSON.parse(JSON.stringify(c));\n        remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n        remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n      }\n      return nativeGetUserMedia(c);\n    };\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n      var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n      MediaStreamTrack.prototype.getSettings = function() {\n        var obj = nativeGetSettings.apply(this, arguments);\n        remap(obj, 'mozAutoGainControl', 'autoGainControl');\n        remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n        return obj;\n      };\n    }\n\n    if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n      var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n      MediaStreamTrack.prototype.applyConstraints = function(c) {\n        if (this.kind === 'audio' && typeof c === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c, 'autoGainControl', 'mozAutoGainControl');\n          remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeApplyConstraints.apply(this, [c]);\n      };\n    }\n  }\n  navigator.getUserMedia = function(constraints, onSuccess, onError) {\n    if (browserDetails.version < 44) {\n      return getUserMedia_(constraints, onSuccess, onError);\n    }\n    // Replace Firefox 44+'s deprecation warning with unprefixed version.\n    utils.deprecated('navigator.getUserMedia',\n        'navigator.mediaDevices.getUserMedia');\n    navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n  };\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar utils = require('../utils');\n\nmodule.exports = {\n  shimGetUserMedia: require('./getusermedia'),\n  shimOnTrack: function(window) {\n    if (typeof window === 'object' && window.RTCPeerConnection && !('ontrack' in\n        window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function() {\n          return this._ontrack;\n        },\n        set: function(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n            this.removeEventListener('addstream', this._ontrackpoly);\n          }\n          this.addEventListener('track', this._ontrack = f);\n          this.addEventListener('addstream', this._ontrackpoly = function(e) {\n            e.stream.getTracks().forEach(function(track) {\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = {track: track};\n              event.transceiver = {receiver: event.receiver};\n              event.streams = [e.stream];\n              this.dispatchEvent(event);\n            }.bind(this));\n          }.bind(this));\n        },\n        enumerable: true,\n        configurable: true\n      });\n    }\n    if (typeof window === 'object' && window.RTCTrackEvent &&\n        ('receiver' in window.RTCTrackEvent.prototype) &&\n        !('transceiver' in window.RTCTrackEvent.prototype)) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function() {\n          return {receiver: this.receiver};\n        }\n      });\n    }\n  },\n\n  shimSourceObject: function(window) {\n    // Firefox has supported mozSrcObject since FF22, unprefixed in 42.\n    if (typeof window === 'object') {\n      if (window.HTMLMediaElement &&\n        !('srcObject' in window.HTMLMediaElement.prototype)) {\n        // Shim the srcObject property, once, when HTMLMediaElement is found.\n        Object.defineProperty(window.HTMLMediaElement.prototype, 'srcObject', {\n          get: function() {\n            return this.mozSrcObject;\n          },\n          set: function(stream) {\n            this.mozSrcObject = stream;\n          }\n        });\n      }\n    }\n  },\n\n  shimPeerConnection: function(window) {\n    var browserDetails = utils.detectBrowser(window);\n\n    if (typeof window !== 'object' || !(window.RTCPeerConnection ||\n        window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    // The RTCPeerConnection object.\n    if (!window.RTCPeerConnection) {\n      window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n        if (browserDetails.version < 38) {\n          // .urls is not supported in FF < 38.\n          // create RTCIceServers with a single url.\n          if (pcConfig && pcConfig.iceServers) {\n            var newIceServers = [];\n            for (var i = 0; i < pcConfig.iceServers.length; i++) {\n              var server = pcConfig.iceServers[i];\n              if (server.hasOwnProperty('urls')) {\n                for (var j = 0; j < server.urls.length; j++) {\n                  var newServer = {\n                    url: server.urls[j]\n                  };\n                  if (server.urls[j].indexOf('turn') === 0) {\n                    newServer.username = server.username;\n                    newServer.credential = server.credential;\n                  }\n                  newIceServers.push(newServer);\n                }\n              } else {\n                newIceServers.push(pcConfig.iceServers[i]);\n              }\n            }\n            pcConfig.iceServers = newIceServers;\n          }\n        }\n        return new window.mozRTCPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype =\n          window.mozRTCPeerConnection.prototype;\n\n      // wrap static methods. Currently just generateCertificate.\n      if (window.mozRTCPeerConnection.generateCertificate) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function() {\n            return window.mozRTCPeerConnection.generateCertificate;\n          }\n        });\n      }\n\n      window.RTCSessionDescription = window.mozRTCSessionDescription;\n      window.RTCIceCandidate = window.mozRTCIceCandidate;\n    }\n\n    // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n    ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate']\n        .forEach(function(method) {\n          var nativeMethod = window.RTCPeerConnection.prototype[method];\n          window.RTCPeerConnection.prototype[method] = function() {\n            arguments[0] = new ((method === 'addIceCandidate') ?\n                window.RTCIceCandidate :\n                window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          };\n        });\n\n    // support for addIceCandidate(null or undefined)\n    var nativeAddIceCandidate =\n        window.RTCPeerConnection.prototype.addIceCandidate;\n    window.RTCPeerConnection.prototype.addIceCandidate = function() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n\n    // shim getStats with maplike support\n    var makeMapStats = function(stats) {\n      var map = new Map();\n      Object.keys(stats).forEach(function(key) {\n        map.set(key, stats[key]);\n        map[key] = stats[key];\n      });\n      return map;\n    };\n\n    var modernStatsTypes = {\n      inboundrtp: 'inbound-rtp',\n      outboundrtp: 'outbound-rtp',\n      candidatepair: 'candidate-pair',\n      localcandidate: 'local-candidate',\n      remotecandidate: 'remote-candidate'\n    };\n\n    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function(\n      selector,\n      onSucc,\n      onErr\n    ) {\n      return nativeGetStats.apply(this, [selector || null])\n        .then(function(stats) {\n          if (browserDetails.version < 48) {\n            stats = makeMapStats(stats);\n          }\n          if (browserDetails.version < 53 && !onSucc) {\n            // Shim only promise getStats with spec-hyphens in type names\n            // Leave callback version alone; misc old uses of forEach before Map\n            try {\n              stats.forEach(function(stat) {\n                stat.type = modernStatsTypes[stat.type] || stat.type;\n              });\n            } catch (e) {\n              if (e.name !== 'TypeError') {\n                throw e;\n              }\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n              stats.forEach(function(stat, i) {\n                stats.set(i, Object.assign({}, stat, {\n                  type: modernStatsTypes[stat.type] || stat.type\n                }));\n              });\n            }\n          }\n          return stats;\n        })\n        .then(onSucc, onErr);\n    };\n  },\n\n  shimSenderGetStats: function(window) {\n    if (!(typeof window === 'object' && window.RTCPeerConnection &&\n        window.RTCRtpSender)) {\n      return;\n    }\n    if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n      return;\n    }\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function() {\n        var pc = this;\n        var senders = origGetSenders.apply(pc, []);\n        senders.forEach(function(sender) {\n          sender._pc = pc;\n        });\n        return senders;\n      };\n    }\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function() {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function() {\n      return this.track ? this._pc.getStats(this.track) :\n          Promise.resolve(new Map());\n    };\n  },\n\n  shimReceiverGetStats: function(window) {\n    if (!(typeof window === 'object' && window.RTCPeerConnection &&\n        window.RTCRtpSender)) {\n      return;\n    }\n    if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n      return;\n    }\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function() {\n        var pc = this;\n        var receivers = origGetReceivers.apply(pc, []);\n        receivers.forEach(function(receiver) {\n          receiver._pc = pc;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function(e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function() {\n      return this._pc.getStats(this.track);\n    };\n  },\n\n  shimRemoveStream: function(window) {\n    if (!window.RTCPeerConnection ||\n        'removeStream' in window.RTCPeerConnection.prototype) {\n      return;\n    }\n    window.RTCPeerConnection.prototype.removeStream = function(stream) {\n      var pc = this;\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(function(sender) {\n        if (sender.track && stream.getTracks().indexOf(sender.track) !== -1) {\n          pc.removeTrack(sender);\n        }\n      });\n    };\n  },\n\n  shimRTCDataChannel: function(window) {\n    // rename DataChannel to RTCDataChannel (native fix in FF60):\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n    if (window.DataChannel && !window.RTCDataChannel) {\n      window.RTCDataChannel = window.DataChannel;\n    }\n  },\n\n  shimGetDisplayMedia: function(window, preferredMediaSource) {\n    if (!window.navigator || !window.navigator.mediaDevices ||\n        'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    window.navigator.mediaDevices.getDisplayMedia = function(constraints) {\n      if (!(constraints && constraints.video)) {\n        var err = new DOMException('getDisplayMedia without video ' +\n            'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = {mediaSource: preferredMediaSource};\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n    window.navigator.getDisplayMedia = function(constraints) {\n      utils.deprecated('navigator.getDisplayMedia',\n          'navigator.mediaDevices.getDisplayMedia');\n      return window.navigator.mediaDevices.getDisplayMedia(constraints);\n    };\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n'use strict';\nvar utils = require('../utils');\n\nmodule.exports = {\n  shimLocalStreamsAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getLocalStreams = function() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n    }\n    if (!('getStreamById' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getStreamById = function(id) {\n        var result = null;\n        if (this._localStreams) {\n          this._localStreams.forEach(function(stream) {\n            if (stream.id === id) {\n              result = stream;\n            }\n          });\n        }\n        if (this._remoteStreams) {\n          this._remoteStreams.forEach(function(stream) {\n            if (stream.id === id) {\n              result = stream;\n            }\n          });\n        }\n        return result;\n      };\n    }\n    if (!('addStream' in window.RTCPeerConnection.prototype)) {\n      var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addStream = function(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        if (this._localStreams.indexOf(stream) === -1) {\n          this._localStreams.push(stream);\n        }\n        var pc = this;\n        stream.getTracks().forEach(function(track) {\n          _addTrack.call(pc, track, stream);\n        });\n      };\n\n      window.RTCPeerConnection.prototype.addTrack = function(track, stream) {\n        if (stream) {\n          if (!this._localStreams) {\n            this._localStreams = [stream];\n          } else if (this._localStreams.indexOf(stream) === -1) {\n            this._localStreams.push(stream);\n          }\n        }\n        return _addTrack.call(this, track, stream);\n      };\n    }\n    if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.removeStream = function(stream) {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        var index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        var pc = this;\n        var tracks = stream.getTracks();\n        this.getSenders().forEach(function(sender) {\n          if (tracks.indexOf(sender.track) !== -1) {\n            pc.removeTrack(sender);\n          }\n        });\n      };\n    }\n  },\n  shimRemoteStreamsAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getRemoteStreams = function() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n    }\n    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n        get: function() {\n          return this._onaddstream;\n        },\n        set: function(f) {\n          if (this._onaddstream) {\n            this.removeEventListener('addstream', this._onaddstream);\n          }\n          this.addEventListener('addstream', this._onaddstream = f);\n        }\n      });\n      var origSetRemoteDescription =\n          window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n        var pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function(e) {\n            e.streams.forEach(function(stream) {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              var event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n    }\n  },\n  shimCallbacksAPI: function(window) {\n    if (typeof window !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    var prototype = window.RTCPeerConnection.prototype;\n    var createOffer = prototype.createOffer;\n    var createAnswer = prototype.createAnswer;\n    var setLocalDescription = prototype.setLocalDescription;\n    var setRemoteDescription = prototype.setRemoteDescription;\n    var addIceCandidate = prototype.addIceCandidate;\n\n    prototype.createOffer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    prototype.createAnswer = function(successCallback, failureCallback) {\n      var options = (arguments.length >= 2) ? arguments[2] : arguments[0];\n      var promise = createAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    var withCallback = function(description, successCallback, failureCallback) {\n      var promise = setLocalDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setLocalDescription = withCallback;\n\n    withCallback = function(description, successCallback, failureCallback) {\n      var promise = setRemoteDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setRemoteDescription = withCallback;\n\n    withCallback = function(candidate, successCallback, failureCallback) {\n      var promise = addIceCandidate.apply(this, [candidate]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.addIceCandidate = withCallback;\n  },\n  shimGetUserMedia: function(window) {\n    var navigator = window && window.navigator;\n\n    if (!navigator.getUserMedia) {\n      if (navigator.webkitGetUserMedia) {\n        navigator.getUserMedia = navigator.webkitGetUserMedia.bind(navigator);\n      } else if (navigator.mediaDevices &&\n          navigator.mediaDevices.getUserMedia) {\n        navigator.getUserMedia = function(constraints, cb, errcb) {\n          navigator.mediaDevices.getUserMedia(constraints)\n          .then(cb, errcb);\n        }.bind(navigator);\n      }\n    }\n  },\n  shimRTCIceServerUrls: function(window) {\n    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n    var OrigPeerConnection = window.RTCPeerConnection;\n    window.RTCPeerConnection = function(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        var newIceServers = [];\n        for (var i = 0; i < pcConfig.iceServers.length; i++) {\n          var server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') &&\n              server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n    // wrap static methods. Currently just generateCertificate.\n    if ('generateCertificate' in window.RTCPeerConnection) {\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n  },\n  shimTrackEventTransceiver: function(window) {\n    // Add event.transceiver member over deprecated event.receiver\n    if (typeof window === 'object' && window.RTCPeerConnection &&\n        ('receiver' in window.RTCTrackEvent.prototype) &&\n        // can't check 'transceiver' in window.RTCTrackEvent.prototype, as it is\n        // defined for some reason even when window.RTCTransceiver is not.\n        !window.RTCTransceiver) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function() {\n          return {receiver: this.receiver};\n        }\n      });\n    }\n  },\n\n  shimCreateOfferLegacy: function(window) {\n    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n    window.RTCPeerConnection.prototype.createOffer = function(offerOptions) {\n      var pc = this;\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n        }\n        var audioTransceiver = pc.getTransceivers().find(function(transceiver) {\n          return transceiver.sender.track &&\n              transceiver.sender.track.kind === 'audio';\n        });\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true &&\n            !audioTransceiver) {\n          pc.addTransceiver('audio');\n        }\n\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n        }\n        var videoTransceiver = pc.getTransceivers().find(function(transceiver) {\n          return transceiver.sender.track &&\n              transceiver.sender.track.kind === 'video';\n        });\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            videoTransceiver.setDirection('sendonly');\n          } else if (videoTransceiver.direction === 'recvonly') {\n            videoTransceiver.setDirection('inactive');\n          }\n        } else if (offerOptions.offerToReceiveVideo === true &&\n            !videoTransceiver) {\n          pc.addTransceiver('video');\n        }\n      }\n      return origCreateOffer.apply(pc, arguments);\n    };\n  }\n};\n","/*\n *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n'use strict';\n\nvar SDPUtils = require('sdp');\nvar utils = require('./utils');\n\nmodule.exports = {\n  shimRTCIceCandidate: function(window) {\n    // foundation is arbitrarily chosen as an indicator for full support for\n    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n    if (!window.RTCIceCandidate || (window.RTCIceCandidate && 'foundation' in\n        window.RTCIceCandidate.prototype)) {\n      return;\n    }\n\n    var NativeRTCIceCandidate = window.RTCIceCandidate;\n    window.RTCIceCandidate = function(args) {\n      // Remove the a= which shouldn't be part of the candidate string.\n      if (typeof args === 'object' && args.candidate &&\n          args.candidate.indexOf('a=') === 0) {\n        args = JSON.parse(JSON.stringify(args));\n        args.candidate = args.candidate.substr(2);\n      }\n\n      if (args.candidate && args.candidate.length) {\n        // Augment the native candidate with the parsed fields.\n        var nativeCandidate = new NativeRTCIceCandidate(args);\n        var parsedCandidate = SDPUtils.parseCandidate(args.candidate);\n        var augmentedCandidate = Object.assign(nativeCandidate,\n            parsedCandidate);\n\n        // Add a serializer that does not serialize the extra attributes.\n        augmentedCandidate.toJSON = function() {\n          return {\n            candidate: augmentedCandidate.candidate,\n            sdpMid: augmentedCandidate.sdpMid,\n            sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n            usernameFragment: augmentedCandidate.usernameFragment,\n          };\n        };\n        return augmentedCandidate;\n      }\n      return new NativeRTCIceCandidate(args);\n    };\n    window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n    // Hook up the augmented candidate in onicecandidate and\n    // addEventListener('icecandidate', ...)\n    utils.wrapPeerConnectionEvent(window, 'icecandidate', function(e) {\n      if (e.candidate) {\n        Object.defineProperty(e, 'candidate', {\n          value: new window.RTCIceCandidate(e.candidate),\n          writable: 'false'\n        });\n      }\n      return e;\n    });\n  },\n\n  // shimCreateObjectURL must be called before shimSourceObject to avoid loop.\n\n  shimCreateObjectURL: function(window) {\n    var URL = window && window.URL;\n\n    if (!(typeof window === 'object' && window.HTMLMediaElement &&\n          'srcObject' in window.HTMLMediaElement.prototype &&\n        URL.createObjectURL && URL.revokeObjectURL)) {\n      // Only shim CreateObjectURL using srcObject if srcObject exists.\n      return undefined;\n    }\n\n    var nativeCreateObjectURL = URL.createObjectURL.bind(URL);\n    var nativeRevokeObjectURL = URL.revokeObjectURL.bind(URL);\n    var streams = new Map(), newId = 0;\n\n    URL.createObjectURL = function(stream) {\n      if ('getTracks' in stream) {\n        var url = 'polyblob:' + (++newId);\n        streams.set(url, stream);\n        utils.deprecated('URL.createObjectURL(stream)',\n            'elem.srcObject = stream');\n        return url;\n      }\n      return nativeCreateObjectURL(stream);\n    };\n    URL.revokeObjectURL = function(url) {\n      nativeRevokeObjectURL(url);\n      streams.delete(url);\n    };\n\n    var dsc = Object.getOwnPropertyDescriptor(window.HTMLMediaElement.prototype,\n                                              'src');\n    Object.defineProperty(window.HTMLMediaElement.prototype, 'src', {\n      get: function() {\n        return dsc.get.apply(this);\n      },\n      set: function(url) {\n        this.srcObject = streams.get(url) || null;\n        return dsc.set.apply(this, [url]);\n      }\n    });\n\n    var nativeSetAttribute = window.HTMLMediaElement.prototype.setAttribute;\n    window.HTMLMediaElement.prototype.setAttribute = function() {\n      if (arguments.length === 2 &&\n          ('' + arguments[0]).toLowerCase() === 'src') {\n        this.srcObject = streams.get(arguments[1]) || null;\n      }\n      return nativeSetAttribute.apply(this, arguments);\n    };\n  },\n\n  shimMaxMessageSize: function(window) {\n    if (window.RTCSctpTransport || !window.RTCPeerConnection) {\n      return;\n    }\n    var browserDetails = utils.detectBrowser(window);\n\n    if (!('sctp' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n        get: function() {\n          return typeof this._sctp === 'undefined' ? null : this._sctp;\n        }\n      });\n    }\n\n    var sctpInDescription = function(description) {\n      var sections = SDPUtils.splitSections(description.sdp);\n      sections.shift();\n      return sections.some(function(mediaSection) {\n        var mLine = SDPUtils.parseMLine(mediaSection);\n        return mLine && mLine.kind === 'application'\n            && mLine.protocol.indexOf('SCTP') !== -1;\n      });\n    };\n\n    var getRemoteFirefoxVersion = function(description) {\n      // TODO: Is there a better solution for detecting Firefox?\n      var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n      if (match === null || match.length < 2) {\n        return -1;\n      }\n      var version = parseInt(match[1], 10);\n      // Test for NaN (yes, this is ugly)\n      return version !== version ? -1 : version;\n    };\n\n    var getCanSendMaxMessageSize = function(remoteIsFirefox) {\n      // Every implementation we know can send at least 64 KiB.\n      // Note: Although Chrome is technically able to send up to 256 KiB, the\n      //       data does not reach the other peer reliably.\n      //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n      var canSendMaxMessageSize = 65536;\n      if (browserDetails.browser === 'firefox') {\n        if (browserDetails.version < 57) {\n          if (remoteIsFirefox === -1) {\n            // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n            // fragmentation.\n            canSendMaxMessageSize = 16384;\n          } else {\n            // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n            // messages. Thus, supporting ~2 GiB when sending.\n            canSendMaxMessageSize = 2147483637;\n          }\n        } else if (browserDetails.version < 60) {\n          // Currently, all FF >= 57 will reset the remote maximum message size\n          // to the default value when a data channel is created at a later\n          // stage. :(\n          // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n          canSendMaxMessageSize =\n            browserDetails.version === 57 ? 65535 : 65536;\n        } else {\n          // FF >= 60 supports sending ~2 GiB\n          canSendMaxMessageSize = 2147483637;\n        }\n      }\n      return canSendMaxMessageSize;\n    };\n\n    var getMaxMessageSize = function(description, remoteIsFirefox) {\n      // Note: 65536 bytes is the default value from the SDP spec. Also,\n      //       every implementation we know supports receiving 65536 bytes.\n      var maxMessageSize = 65536;\n\n      // FF 57 has a slightly incorrect default remote max message size, so\n      // we need to adjust it here to avoid a failure when sending.\n      // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n      if (browserDetails.browser === 'firefox'\n           && browserDetails.version === 57) {\n        maxMessageSize = 65535;\n      }\n\n      var match = SDPUtils.matchPrefix(description.sdp, 'a=max-message-size:');\n      if (match.length > 0) {\n        maxMessageSize = parseInt(match[0].substr(19), 10);\n      } else if (browserDetails.browser === 'firefox' &&\n                  remoteIsFirefox !== -1) {\n        // If the maximum message size is not present in the remote SDP and\n        // both local and remote are Firefox, the remote peer can receive\n        // ~2 GiB.\n        maxMessageSize = 2147483637;\n      }\n      return maxMessageSize;\n    };\n\n    var origSetRemoteDescription =\n        window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function() {\n      var pc = this;\n      pc._sctp = null;\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        var maxMessageSize;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        var sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get: function() {\n            return maxMessageSize;\n          }\n        });\n        pc._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(pc, arguments);\n    };\n  },\n\n  shimSendThrowTypeError: function(window) {\n    if (!(window.RTCPeerConnection &&\n        'createDataChannel' in window.RTCPeerConnection.prototype)) {\n      return;\n    }\n\n    // Note: Although Firefox >= 57 has a native implementation, the maximum\n    //       message size can be reset for all data channels at a later stage.\n    //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n    function wrapDcSend(dc, pc) {\n      var origDataChannelSend = dc.send;\n      dc.send = function() {\n        var data = arguments[0];\n        var length = data.length || data.size || data.byteLength;\n        if (dc.readyState === 'open' &&\n            pc.sctp && length > pc.sctp.maxMessageSize) {\n          throw new TypeError('Message too large (can send a maximum of ' +\n            pc.sctp.maxMessageSize + ' bytes)');\n        }\n        return origDataChannelSend.apply(dc, arguments);\n      };\n    }\n    var origCreateDataChannel =\n      window.RTCPeerConnection.prototype.createDataChannel;\n    window.RTCPeerConnection.prototype.createDataChannel = function() {\n      var pc = this;\n      var dataChannel = origCreateDataChannel.apply(pc, arguments);\n      wrapDcSend(dataChannel, pc);\n      return dataChannel;\n    };\n    utils.wrapPeerConnectionEvent(window, 'datachannel', function(e) {\n      wrapDcSend(e.channel, e.target);\n      return e;\n    });\n  }\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\nvar utils = require('./utils');\n// Shimming starts here.\nmodule.exports = function(dependencies, opts) {\n  var window = dependencies && dependencies.window;\n\n  var options = {\n    shimChrome: true,\n    shimFirefox: true,\n    shimEdge: true,\n    shimSafari: true,\n  };\n\n  for (var key in opts) {\n    if (hasOwnProperty.call(opts, key)) {\n      options[key] = opts[key];\n    }\n  }\n\n  // Utils.\n  var logging = utils.log;\n  var browserDetails = utils.detectBrowser(window);\n\n  // Uncomment the line below if you want logging to occur, including logging\n  // for the switch statement below. Can also be turned on in the browser via\n  // adapter.disableLog(false), but then logging from the switch statement below\n  // will not appear.\n  // require('./utils').disableLog(false);\n\n  // Browser shims.\n  var chromeShim = require('./chrome/chrome_shim') || null;\n  var edgeShim = require('./edge/edge_shim') || null;\n  var firefoxShim = require('./firefox/firefox_shim') || null;\n  var safariShim = require('./safari/safari_shim') || null;\n  var commonShim = require('./common_shim') || null;\n\n  // Export to the adapter global object visible in the browser.\n  var adapter = {\n    browserDetails: browserDetails,\n    commonShim: commonShim,\n    extractVersion: utils.extractVersion,\n    disableLog: utils.disableLog,\n    disableWarnings: utils.disableWarnings\n  };\n\n  // Shim browser if found.\n  switch (browserDetails.browser) {\n    case 'chrome':\n      if (!chromeShim || !chromeShim.shimPeerConnection ||\n          !options.shimChrome) {\n        logging('Chrome shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming chrome.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = chromeShim;\n      commonShim.shimCreateObjectURL(window);\n\n      chromeShim.shimGetUserMedia(window);\n      chromeShim.shimMediaStream(window);\n      chromeShim.shimSourceObject(window);\n      chromeShim.shimPeerConnection(window);\n      chromeShim.shimOnTrack(window);\n      chromeShim.shimAddTrackRemoveTrack(window);\n      chromeShim.shimGetSendersWithDtmf(window);\n      chromeShim.shimSenderReceiverGetStats(window);\n      chromeShim.fixNegotiationNeeded(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'firefox':\n      if (!firefoxShim || !firefoxShim.shimPeerConnection ||\n          !options.shimFirefox) {\n        logging('Firefox shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming firefox.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = firefoxShim;\n      commonShim.shimCreateObjectURL(window);\n\n      firefoxShim.shimGetUserMedia(window);\n      firefoxShim.shimSourceObject(window);\n      firefoxShim.shimPeerConnection(window);\n      firefoxShim.shimOnTrack(window);\n      firefoxShim.shimRemoveStream(window);\n      firefoxShim.shimSenderGetStats(window);\n      firefoxShim.shimReceiverGetStats(window);\n      firefoxShim.shimRTCDataChannel(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'edge':\n      if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n        logging('MS edge shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming edge.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = edgeShim;\n      commonShim.shimCreateObjectURL(window);\n\n      edgeShim.shimGetUserMedia(window);\n      edgeShim.shimPeerConnection(window);\n      edgeShim.shimReplaceTrack(window);\n      edgeShim.shimGetDisplayMedia(window);\n\n      // the edge shim implements the full RTCIceCandidate object.\n\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    case 'safari':\n      if (!safariShim || !options.shimSafari) {\n        logging('Safari shim is not included in this adapter release.');\n        return adapter;\n      }\n      logging('adapter.js shimming safari.');\n      // Export to the adapter global object visible in the browser.\n      adapter.browserShim = safariShim;\n      commonShim.shimCreateObjectURL(window);\n\n      safariShim.shimRTCIceServerUrls(window);\n      safariShim.shimCreateOfferLegacy(window);\n      safariShim.shimCallbacksAPI(window);\n      safariShim.shimLocalStreamsAPI(window);\n      safariShim.shimRemoteStreamsAPI(window);\n      safariShim.shimTrackEventTransceiver(window);\n      safariShim.shimGetUserMedia(window);\n\n      commonShim.shimRTCIceCandidate(window);\n      commonShim.shimMaxMessageSize(window);\n      commonShim.shimSendThrowTypeError(window);\n      break;\n    default:\n      logging('Unsupported browser!');\n      break;\n  }\n\n  return adapter;\n};\n","/*\n *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n /* eslint-env node */\n\n'use strict';\n\nvar adapterFactory = require('./adapter_factory.js');\nmodule.exports = adapterFactory({window: global.window});\n","require('webrtc-adapter');\r\n\r\nmodule.exports.RTCSessionDescription = window.RTCSessionDescription ||\r\n\twindow.mozRTCSessionDescription;\r\nmodule.exports.RTCPeerConnection = window.RTCPeerConnection ||\r\n\twindow.mozRTCPeerConnection || window.webkitRTCPeerConnection;\r\nmodule.exports.RTCIceCandidate = window.RTCIceCandidate ||\r\n\twindow.mozRTCIceCandidate;\r\n","var defaultConfig = {'iceServers': [{ 'urls': 'stun:stun.l.google.com:19302' }]};\r\nvar dataCount = 1;\r\n\r\nvar BinaryPack = require(\"js-binarypack\");\r\nvar RTCPeerConnection = require(\"./adapter\").RTCPeerConnection;\r\n\r\nvar util = {\r\n  noop: function() {},\r\n\r\n  CLOUD_HOST: \"0.peerjs.com\",\r\n  CLOUD_PORT: 443,\r\n\r\n  // Browsers that need chunking:\r\n  chunkedBrowsers: { Chrome: 1 },\r\n  chunkedMTU: 16300, // The original 60000 bytes setting does not work when sending data from Firefox to Chrome, which is \"cut off\" after 16384 bytes and delivered individually.\r\n\r\n  // Logging logic\r\n  logLevel: 0,\r\n  setLogLevel: function(level) {\r\n    var debugLevel = parseInt(level, 10);\r\n    if (!isNaN(parseInt(level, 10))) {\r\n      util.logLevel = debugLevel;\r\n    } else {\r\n      // If they are using truthy/falsy values for debug\r\n      util.logLevel = level ? 3 : 0;\r\n    }\r\n    util.log = util.warn = util.error = util.noop;\r\n    if (util.logLevel > 0) {\r\n      util.error = util._printWith(\"ERROR\");\r\n    }\r\n    if (util.logLevel > 1) {\r\n      util.warn = util._printWith(\"WARNING\");\r\n    }\r\n    if (util.logLevel > 2) {\r\n      util.log = util._print;\r\n    }\r\n  },\r\n  setLogFunction: function(fn) {\r\n    if (fn.constructor !== Function) {\r\n      util.warn(\r\n        \"The log function you passed in is not a function. Defaulting to regular logs.\"\r\n      );\r\n    } else {\r\n      util._print = fn;\r\n    }\r\n  },\r\n\r\n  _printWith: function(prefix) {\r\n    return function() {\r\n      var copy = Array.prototype.slice.call(arguments);\r\n      copy.unshift(prefix);\r\n      util._print.apply(util, copy);\r\n    };\r\n  },\r\n  _print: function() {\r\n    var err = false;\r\n    var copy = Array.prototype.slice.call(arguments);\r\n    copy.unshift(\"PeerJS: \");\r\n    for (var i = 0, l = copy.length; i < l; i++) {\r\n      if (copy[i] instanceof Error) {\r\n        copy[i] = \"(\" + copy[i].name + \") \" + copy[i].message;\r\n        err = true;\r\n      }\r\n    }\r\n    err ? console.error.apply(console, copy) : console.log.apply(console, copy);\r\n  },\r\n  //\r\n\r\n  // Returns browser-agnostic default config\r\n  defaultConfig: defaultConfig,\r\n  //\r\n\r\n  // Returns the current browser.\r\n  browser: (function() {\r\n    if (window.mozRTCPeerConnection) {\r\n      return \"Firefox\";\r\n    } else if (window.webkitRTCPeerConnection) {\r\n      return \"Chrome\";\r\n    } else if (window.RTCPeerConnection) {\r\n      return \"Supported\";\r\n    } else {\r\n      return \"Unsupported\";\r\n    }\r\n  })(),\r\n  //\r\n\r\n  // Lists which features are supported\r\n  supports: (function() {\r\n    if (typeof RTCPeerConnection === \"undefined\") {\r\n      return {};\r\n    }\r\n\r\n    var data = true;\r\n    var audioVideo = true;\r\n\r\n    var binaryBlob = false;\r\n    var sctp = false;\r\n    var onnegotiationneeded = !!window.webkitRTCPeerConnection;\r\n\r\n    var pc, dc;\r\n    try {\r\n      pc = new RTCPeerConnection(defaultConfig, {\r\n        optional: [{ RtpDataChannels: true }]\r\n      });\r\n    } catch (e) {\r\n      data = false;\r\n      audioVideo = false;\r\n    }\r\n\r\n    if (data) {\r\n      try {\r\n        dc = pc.createDataChannel(\"_PEERJSTEST\");\r\n      } catch (e) {\r\n        data = false;\r\n      }\r\n    }\r\n\r\n    if (data) {\r\n      // Binary test\r\n      try {\r\n        dc.binaryType = \"blob\";\r\n        binaryBlob = true;\r\n      } catch (e) {}\r\n\r\n      // Reliable test.\r\n      // Unfortunately Chrome is a bit unreliable about whether or not they\r\n      // support reliable.\r\n      var reliablePC = new RTCPeerConnection(defaultConfig, {});\r\n      try {\r\n        var reliableDC = reliablePC.createDataChannel(\r\n          \"_PEERJSRELIABLETEST\",\r\n          {}\r\n        );\r\n        sctp = reliableDC.reliable;\r\n      } catch (e) {}\r\n      reliablePC.close();\r\n    }\r\n\r\n    // FIXME: not really the best check...\r\n    if (audioVideo) {\r\n      audioVideo = !!pc.addStream;\r\n    }\r\n\r\n    // FIXME: this is not great because in theory it doesn't work for\r\n    // av-only browsers (?).\r\n    /*\r\n    if (!onnegotiationneeded && data) {\r\n      // sync default check.\r\n      var negotiationPC = new RTCPeerConnection(defaultConfig, {optional: [{RtpDataChannels: true}]});\r\n      negotiationPC.onnegotiationneeded = function() {\r\n        onnegotiationneeded = true;\r\n        // async check.\r\n        if (util && util.supports) {\r\n          util.supports.onnegotiationneeded = true;\r\n        }\r\n      };\r\n      negotiationPC.createDataChannel('_PEERJSNEGOTIATIONTEST');\r\n\r\n      setTimeout(function() {\r\n        negotiationPC.close();\r\n      }, 1000);\r\n    }\r\n    */\r\n\r\n    if (pc) {\r\n      pc.close();\r\n    }\r\n\r\n    return {\r\n      audioVideo: audioVideo,\r\n      data: data,\r\n      binaryBlob: binaryBlob,\r\n      binary: sctp, // deprecated; sctp implies binary support.\r\n      reliable: sctp, // deprecated; sctp implies reliable data.\r\n      sctp: sctp,\r\n      onnegotiationneeded: onnegotiationneeded\r\n    };\r\n  })(),\r\n  //\r\n\r\n  // Ensure alphanumeric ids\r\n  validateId: function(id) {\r\n    // Allow empty ids\r\n    return !id || /^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(id);\r\n  },\r\n\r\n  validateKey: function(key) {\r\n    // Allow empty keys\r\n    return !key || /^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(key);\r\n  },\r\n\r\n  debug: false,\r\n\r\n  inherits: function(ctor, superCtor) {\r\n    ctor.super_ = superCtor;\r\n    ctor.prototype = Object.create(superCtor.prototype, {\r\n      constructor: {\r\n        value: ctor,\r\n        enumerable: false,\r\n        writable: true,\r\n        configurable: true\r\n      }\r\n    });\r\n  },\r\n  extend: function(dest, source) {\r\n    for (var key in source) {\r\n      if (source.hasOwnProperty(key)) {\r\n        dest[key] = source[key];\r\n      }\r\n    }\r\n    return dest;\r\n  },\r\n  pack: BinaryPack.pack,\r\n  unpack: BinaryPack.unpack,\r\n\r\n  log: function() {\r\n    if (util.debug) {\r\n      var err = false;\r\n      var copy = Array.prototype.slice.call(arguments);\r\n      copy.unshift(\"PeerJS: \");\r\n      for (var i = 0, l = copy.length; i < l; i++) {\r\n        if (copy[i] instanceof Error) {\r\n          copy[i] = \"(\" + copy[i].name + \") \" + copy[i].message;\r\n          err = true;\r\n        }\r\n      }\r\n      err\r\n        ? console.error.apply(console, copy)\r\n        : console.log.apply(console, copy);\r\n    }\r\n  },\r\n\r\n  setZeroTimeout: (function(global) {\r\n    var timeouts = [];\r\n    var messageName = \"zero-timeout-message\";\r\n\r\n    // Like setTimeout, but only takes a function argument.\t There's\r\n    // no time argument (always zero) and no arguments (you have to\r\n    // use a closure).\r\n    function setZeroTimeoutPostMessage(fn) {\r\n      timeouts.push(fn);\r\n      global.postMessage(messageName, \"*\");\r\n    }\r\n\r\n    function handleMessage(event) {\r\n      if (event.source == global && event.data == messageName) {\r\n        if (event.stopPropagation) {\r\n          event.stopPropagation();\r\n        }\r\n        if (timeouts.length) {\r\n          timeouts.shift()();\r\n        }\r\n      }\r\n    }\r\n    if (global.addEventListener) {\r\n      global.addEventListener(\"message\", handleMessage, true);\r\n    } else if (global.attachEvent) {\r\n      global.attachEvent(\"onmessage\", handleMessage);\r\n    }\r\n    return setZeroTimeoutPostMessage;\r\n  })(window),\r\n\r\n  // Binary stuff\r\n\r\n  // chunks a blob.\r\n  chunk: function(bl) {\r\n    var chunks = [];\r\n    var size = bl.size;\r\n    var start = (index = 0);\r\n    var total = Math.ceil(size / util.chunkedMTU);\r\n    while (start < size) {\r\n      var end = Math.min(size, start + util.chunkedMTU);\r\n      var b = bl.slice(start, end);\r\n\r\n      var chunk = {\r\n        __peerData: dataCount,\r\n        n: index,\r\n        data: b,\r\n        total: total\r\n      };\r\n\r\n      chunks.push(chunk);\r\n\r\n      start = end;\r\n      index += 1;\r\n    }\r\n    dataCount += 1;\r\n    return chunks;\r\n  },\r\n\r\n  blobToArrayBuffer: function(blob, cb) {\r\n    var fr = new FileReader();\r\n    fr.onload = function(evt) {\r\n      cb(evt.target.result);\r\n    };\r\n    fr.readAsArrayBuffer(blob);\r\n  },\r\n  blobToBinaryString: function(blob, cb) {\r\n    var fr = new FileReader();\r\n    fr.onload = function(evt) {\r\n      cb(evt.target.result);\r\n    };\r\n    fr.readAsBinaryString(blob);\r\n  },\r\n  binaryStringToArrayBuffer: function(binary) {\r\n    var byteArray = new Uint8Array(binary.length);\r\n    for (var i = 0; i < binary.length; i++) {\r\n      byteArray[i] = binary.charCodeAt(i) & 0xff;\r\n    }\r\n    return byteArray.buffer;\r\n  },\r\n  randomToken: function() {\r\n    return Math.random()\r\n      .toString(36)\r\n      .substr(2);\r\n  },\r\n  //\r\n\r\n  isSecure: function() {\r\n    return location.protocol === \"https:\";\r\n  }\r\n};\r\n\r\nmodule.exports = util;\r\n","'use strict';\n\n/**\n * Representation of a single EventEmitter function.\n *\n * @param {Function} fn Event handler to be called.\n * @param {Mixed} context Context for function execution.\n * @param {Boolean} once Only emit once\n * @api private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Minimal EventEmitter interface that is molded against the Node.js\n * EventEmitter interface.\n *\n * @constructor\n * @api public\n */\nfunction EventEmitter() { /* Nothing to set */ }\n\n/**\n * Holds the assigned EventEmitters by name.\n *\n * @type {Object}\n * @private\n */\nEventEmitter.prototype._events = undefined;\n\n/**\n * Return a list of assigned event listeners.\n *\n * @param {String} event The events that should be listed.\n * @returns {Array}\n * @api public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  if (!this._events || !this._events[event]) return [];\n  if (this._events[event].fn) return [this._events[event].fn];\n\n  for (var i = 0, l = this._events[event].length, ee = new Array(l); i < l; i++) {\n    ee[i] = this._events[event][i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Emit an event to all registered event listeners.\n *\n * @param {String} event The name of the event.\n * @returns {Boolean} Indication if we've emitted an event.\n * @api public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  if (!this._events || !this._events[event]) return false;\n\n  var listeners = this._events[event]\n    , len = arguments.length\n    , args\n    , i;\n\n  if ('function' === typeof listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Register a new EventListener for the given event.\n *\n * @param {String} event Name of the event.\n * @param {Functon} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  var listener = new EE(fn, context || this);\n\n  if (!this._events) this._events = {};\n  if (!this._events[event]) this._events[event] = listener;\n  else {\n    if (!this._events[event].fn) this._events[event].push(listener);\n    else this._events[event] = [\n      this._events[event], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Add an EventListener that's only called once.\n *\n * @param {String} event Name of the event.\n * @param {Function} fn Callback function.\n * @param {Mixed} context The context of the function.\n * @api public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  var listener = new EE(fn, context || this, true);\n\n  if (!this._events) this._events = {};\n  if (!this._events[event]) this._events[event] = listener;\n  else {\n    if (!this._events[event].fn) this._events[event].push(listener);\n    else this._events[event] = [\n      this._events[event], listener\n    ];\n  }\n\n  return this;\n};\n\n/**\n * Remove event listeners.\n *\n * @param {String} event The event we want to remove.\n * @param {Function} fn The listener that we need to find.\n * @param {Boolean} once Only remove once listeners.\n * @api public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, once) {\n  if (!this._events || !this._events[event]) return this;\n\n  var listeners = this._events[event]\n    , events = [];\n\n  if (fn) {\n    if (listeners.fn && (listeners.fn !== fn || (once && !listeners.once))) {\n      events.push(listeners);\n    }\n    if (!listeners.fn) for (var i = 0, length = listeners.length; i < length; i++) {\n      if (listeners[i].fn !== fn || (once && !listeners[i].once)) {\n        events.push(listeners[i]);\n      }\n    }\n  }\n\n  //\n  // Reset the array, or remove it completely if we have no more listeners.\n  //\n  if (events.length) {\n    this._events[event] = events.length === 1 ? events[0] : events;\n  } else {\n    delete this._events[event];\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners or only the listeners for the specified event.\n *\n * @param {String} event The event want to remove all listeners for.\n * @api public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  if (!this._events) return this;\n\n  if (event) delete this._events[event];\n  else this._events = {};\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// This function doesn't apply anymore.\n//\nEventEmitter.prototype.setMaxListeners = function setMaxListeners() {\n  return this;\n};\n\n//\n// Expose the module.\n//\nEventEmitter.EventEmitter = EventEmitter;\nEventEmitter.EventEmitter2 = EventEmitter;\nEventEmitter.EventEmitter3 = EventEmitter;\n\n//\n// Expose the module.\n//\nmodule.exports = EventEmitter;\n","var util = require('./util');\r\nvar EventEmitter = require('eventemitter3');\r\n\r\n/**\r\n * An abstraction on top of WebSockets and XHR streaming to provide fastest\r\n * possible connection for peers.\r\n */\r\nfunction Socket(secure, host, port, path, key, wsport) {\r\n  if (!(this instanceof Socket)) return new Socket(secure, host, port, path, key, wsport);\r\n\r\n  wsport = wsport || port;\r\n\r\n  EventEmitter.call(this);\r\n\r\n  // Disconnected manually.\r\n  this.disconnected = false;\r\n  this._queue = [];\r\n\r\n  var httpProtocol = secure ? 'https://' : 'http://';\r\n  var wsProtocol = secure ? 'wss://' : 'ws://';\r\n  this._httpUrl = httpProtocol + host + ':' + port + path + key;\r\n  this._wsUrl = wsProtocol + host + ':' + wsport + path + 'peerjs?key=' + key;\r\n}\r\n\r\nutil.inherits(Socket, EventEmitter);\r\n\r\n\r\n/** Check in with ID or get one from server. */\r\nSocket.prototype.start = function(id, token) {\r\n  this.id = id;\r\n\r\n  this._httpUrl += '/' + id + '/' + token;\r\n  this._wsUrl += '&id=' + id + '&token=' + token;\r\n\r\n  this._startXhrStream();\r\n  this._startWebSocket();\r\n}\r\n\r\n\r\n/** Start up websocket communications. */\r\nSocket.prototype._startWebSocket = function(id) {\r\n  var self = this;\r\n\r\n  if (this._socket) {\r\n    return;\r\n  }\r\n\r\n  this._socket = new WebSocket(this._wsUrl);\r\n\r\n  this._socket.onmessage = function(event) {\r\n    try {\r\n      var data = JSON.parse(event.data);\r\n    } catch(e) {\r\n      util.log('Invalid server message', event.data);\r\n      return;\r\n    }\r\n    self.emit('message', data);\r\n  };\r\n\r\n  this._socket.onclose = function(event) {\r\n    util.log('Socket closed.');\r\n    self.disconnected = true;\r\n    self.emit('disconnected');\r\n  };\r\n\r\n  // Take care of the queue of connections if necessary and make sure Peer knows\r\n  // socket is open.\r\n  this._socket.onopen = function() {\r\n    if (self._timeout) {\r\n      clearTimeout(self._timeout);\r\n      setTimeout(function(){\r\n        self._http.abort();\r\n        self._http = null;\r\n      }, 5000);\r\n    }\r\n    self._sendQueuedMessages();\r\n    util.log('Socket open');\r\n  };\r\n}\r\n\r\n/** Start XHR streaming. */\r\nSocket.prototype._startXhrStream = function(n) {\r\n  try {\r\n    var self = this;\r\n    this._http = new XMLHttpRequest();\r\n    this._http._index = 1;\r\n    this._http._streamIndex = n || 0;\r\n    this._http.open('post', this._httpUrl + '/id?i=' + this._http._streamIndex, true);\r\n    this._http.onerror = function() {\r\n      // If we get an error, likely something went wrong.\r\n      // Stop streaming.\r\n      clearTimeout(self._timeout);\r\n      self.emit('disconnected');\r\n    }\r\n    this._http.onreadystatechange = function() {\r\n      if (this.readyState == 2 && this.old) {\r\n        this.old.abort();\r\n        delete this.old;\r\n      } else if (this.readyState > 2 && this.status === 200 && this.responseText) {\r\n        self._handleStream(this);\r\n      }\r\n    };\r\n    this._http.send(null);\r\n    this._setHTTPTimeout();\r\n  } catch(e) {\r\n    util.log('XMLHttpRequest not available; defaulting to WebSockets');\r\n  }\r\n}\r\n\r\n\r\n/** Handles onreadystatechange response as a stream. */\r\nSocket.prototype._handleStream = function(http) {\r\n  // 3 and 4 are loading/done state. All others are not relevant.\r\n  var messages = http.responseText.split('\\n');\r\n\r\n  // Check to see if anything needs to be processed on buffer.\r\n  if (http._buffer) {\r\n    while (http._buffer.length > 0) {\r\n      var index = http._buffer.shift();\r\n      var bufferedMessage = messages[index];\r\n      try {\r\n        bufferedMessage = JSON.parse(bufferedMessage);\r\n      } catch(e) {\r\n        http._buffer.shift(index);\r\n        break;\r\n      }\r\n      this.emit('message', bufferedMessage);\r\n    }\r\n  }\r\n\r\n  var message = messages[http._index];\r\n  if (message) {\r\n    http._index += 1;\r\n    // Buffering--this message is incomplete and we'll get to it next time.\r\n    // This checks if the httpResponse ended in a `\\n`, in which case the last\r\n    // element of messages should be the empty string.\r\n    if (http._index === messages.length) {\r\n      if (!http._buffer) {\r\n        http._buffer = [];\r\n      }\r\n      http._buffer.push(http._index - 1);\r\n    } else {\r\n      try {\r\n        message = JSON.parse(message);\r\n      } catch(e) {\r\n        util.log('Invalid server message', message);\r\n        return;\r\n      }\r\n      this.emit('message', message);\r\n    }\r\n  }\r\n}\r\n\r\nSocket.prototype._setHTTPTimeout = function() {\r\n  var self = this;\r\n  this._timeout = setTimeout(function() {\r\n    var old = self._http;\r\n    if (!self._wsOpen()) {\r\n      self._startXhrStream(old._streamIndex + 1);\r\n      self._http.old = old;\r\n    } else {\r\n      old.abort();\r\n    }\r\n  }, 25000);\r\n}\r\n\r\n/** Is the websocket currently open? */\r\nSocket.prototype._wsOpen = function() {\r\n  return this._socket && this._socket.readyState == 1;\r\n}\r\n\r\n/** Send queued messages. */\r\nSocket.prototype._sendQueuedMessages = function() {\r\n  for (var i = 0, ii = this._queue.length; i < ii; i += 1) {\r\n    this.send(this._queue[i]);\r\n  }\r\n}\r\n\r\n/** Exposed send for DC & Peer. */\r\nSocket.prototype.send = function(data) {\r\n  if (this.disconnected) {\r\n    return;\r\n  }\r\n\r\n  // If we didn't get an ID yet, we can't yet send anything so we should queue\r\n  // up these messages.\r\n  if (!this.id) {\r\n    this._queue.push(data);\r\n    return;\r\n  }\r\n\r\n  if (!data.type) {\r\n    this.emit('error', 'Invalid message');\r\n    return;\r\n  }\r\n\r\n  var message = JSON.stringify(data);\r\n  if (this._wsOpen()) {\r\n    this._socket.send(message);\r\n  } else {\r\n    var http = new XMLHttpRequest();\r\n    var url = this._httpUrl + '/' + data.type.toLowerCase();\r\n    http.open('post', url, true);\r\n    http.setRequestHeader('Content-Type', 'application/json');\r\n    http.send(message);\r\n  }\r\n}\r\n\r\nSocket.prototype.close = function() {\r\n  if (!this.disconnected && this._wsOpen()) {\r\n    this._socket.close();\r\n    this.disconnected = true;\r\n  }\r\n}\r\n\r\nmodule.exports = Socket;\r\n","var util = require(\"./util\");\r\nvar RTCPeerConnection = require(\"./adapter\").RTCPeerConnection;\r\nvar RTCSessionDescription = require(\"./adapter\").RTCSessionDescription;\r\nvar RTCIceCandidate = require(\"./adapter\").RTCIceCandidate;\r\n\r\n/**\r\n * Manages all negotiations between Peers.\r\n */\r\nvar Negotiator = {\r\n  pcs: {\r\n    data: {},\r\n    media: {}\r\n  }, // type => {peerId: {pc_id: pc}}.\r\n  //providers: {}, // provider's id => providers (there may be multiple providers/client.\r\n  queue: [] // connections that are delayed due to a PC being in use.\r\n};\r\n\r\nNegotiator._idPrefix = \"pc_\";\r\n\r\n/** Returns a PeerConnection object set up correctly (for data, media). */\r\nNegotiator.startConnection = function(connection, options) {\r\n  var pc = Negotiator._getPeerConnection(connection, options);\r\n\r\n  // Set the connection's PC.\r\n  connection.pc = connection.peerConnection = pc;\r\n\r\n  if (connection.type === \"media\" && options._stream) {\r\n    // Add the stream.\r\n    pc.addStream(options._stream);\r\n  }\r\n\r\n  // What do we need to do now?\r\n  if (options.originator) {\r\n    if (connection.type === \"data\") {\r\n      // Create the datachannel.\r\n      var config = {};\r\n      // Dropping reliable:false support, since it seems to be crashing\r\n      // Chrome.\r\n      /*if (util.supports.sctp && !options.reliable) {\r\n        // If we have canonical reliable support...\r\n        config = {maxRetransmits: 0};\r\n      }*/\r\n      // Fallback to ensure older browsers don't crash.\r\n      if (!util.supports.sctp) {\r\n        config = { reliable: options.reliable };\r\n      }\r\n      var dc = pc.createDataChannel(connection.label, config);\r\n      connection.initialize(dc);\r\n    }\r\n\r\n    Negotiator._makeOffer(connection);\r\n  } else {\r\n    Negotiator.handleSDP(\"OFFER\", connection, options.sdp);\r\n  }\r\n};\r\n\r\nNegotiator._getPeerConnection = function(connection, options) {\r\n  if (!Negotiator.pcs[connection.type]) {\r\n    util.error(\r\n      connection.type +\r\n        \" is not a valid connection type. Maybe you overrode the `type` property somewhere.\"\r\n    );\r\n  }\r\n\r\n  if (!Negotiator.pcs[connection.type][connection.peer]) {\r\n    Negotiator.pcs[connection.type][connection.peer] = {};\r\n  }\r\n  var peerConnections = Negotiator.pcs[connection.type][connection.peer];\r\n\r\n  var pc;\r\n  // Not multiplexing while FF and Chrome have not-great support for it.\r\n  /*if (options.multiplex) {\r\n    ids = Object.keys(peerConnections);\r\n    for (var i = 0, ii = ids.length; i < ii; i += 1) {\r\n      pc = peerConnections[ids[i]];\r\n      if (pc.signalingState === 'stable') {\r\n        break; // We can go ahead and use this PC.\r\n      }\r\n    }\r\n  } else */\r\n  if (options.pc) {\r\n    // Simplest case: PC id already provided for us.\r\n    pc = Negotiator.pcs[connection.type][connection.peer][options.pc];\r\n  }\r\n\r\n  if (!pc || pc.signalingState !== \"stable\") {\r\n    pc = Negotiator._startPeerConnection(connection);\r\n  }\r\n  return pc;\r\n};\r\n\r\n/*\r\nNegotiator._addProvider = function(provider) {\r\n  if ((!provider.id && !provider.disconnected) || !provider.socket.open) {\r\n    // Wait for provider to obtain an ID.\r\n    provider.on('open', function(id) {\r\n      Negotiator._addProvider(provider);\r\n    });\r\n  } else {\r\n    Negotiator.providers[provider.id] = provider;\r\n  }\r\n}*/\r\n\r\n/** Start a PC. */\r\nNegotiator._startPeerConnection = function(connection) {\r\n  util.log(\"Creating RTCPeerConnection.\");\r\n\r\n  var id = Negotiator._idPrefix + util.randomToken();\r\n  var optional = {};\r\n\r\n  if (connection.type === \"data\" && !util.supports.sctp) {\r\n    optional = { optional: [{ RtpDataChannels: true }] };\r\n  } else if (connection.type === \"media\") {\r\n    // Interop req for chrome.\r\n    optional = { optional: [{ DtlsSrtpKeyAgreement: true }] };\r\n  }\r\n\r\n  var pc = new RTCPeerConnection(connection.provider.options.config, optional);\r\n  Negotiator.pcs[connection.type][connection.peer][id] = pc;\r\n\r\n  Negotiator._setupListeners(connection, pc, id);\r\n\r\n  return pc;\r\n};\r\n\r\n/** Set up various WebRTC listeners. */\r\nNegotiator._setupListeners = function(connection, pc, pc_id) {\r\n  var peerId = connection.peer;\r\n  var connectionId = connection.id;\r\n  var provider = connection.provider;\r\n\r\n  // ICE CANDIDATES.\r\n  util.log(\"Listening for ICE candidates.\");\r\n  pc.onicecandidate = function(evt) {\r\n    if (evt.candidate) {\r\n      util.log(\"Received ICE candidates for:\", connection.peer);\r\n      provider.socket.send({\r\n        type: \"CANDIDATE\",\r\n        payload: {\r\n          candidate: evt.candidate,\r\n          type: connection.type,\r\n          connectionId: connection.id\r\n        },\r\n        dst: peerId\r\n      });\r\n    }\r\n  };\r\n\r\n  pc.oniceconnectionstatechange = function() {\r\n    switch (pc.iceConnectionState) {\r\n      case \"failed\":\r\n        util.log(\r\n          \"iceConnectionState is disconnected, closing connections to \" + peerId\r\n        );\r\n        connection.emit(\r\n          \"error\",\r\n          new Error(\"Negotiation of connection to \" + peerId + \" failed.\")\r\n        );\r\n        connection.close();\r\n        break;\r\n      case \"disconnected\":\r\n        util.log(\r\n          \"iceConnectionState is disconnected, closing connections to \" + peerId\r\n        );\r\n        connection.close();\r\n        break;\r\n      case \"completed\":\r\n        pc.onicecandidate = util.noop;\r\n        break;\r\n    }\r\n  };\r\n\r\n  // Fallback for older Chrome impls.\r\n  pc.onicechange = pc.oniceconnectionstatechange;\r\n\r\n  // DATACONNECTION.\r\n  util.log(\"Listening for data channel\");\r\n  // Fired between offer and answer, so options should already be saved\r\n  // in the options hash.\r\n  pc.ondatachannel = function(evt) {\r\n    util.log(\"Received data channel\");\r\n    var dc = evt.channel;\r\n    var connection = provider.getConnection(peerId, connectionId);\r\n    connection.initialize(dc);\r\n  };\r\n\r\n  // MEDIACONNECTION.\r\n  util.log(\"Listening for remote stream\");\r\n  pc.ontrack = function(evt) {\r\n    util.log(\"Received remote stream\");\r\n    var stream = evt.streams[0];\r\n    var connection = provider.getConnection(peerId, connectionId);\r\n    if (connection.type === \"media\") {\r\n      connection.addStream(stream);\r\n    }\r\n  };\r\n};\r\n\r\nNegotiator.cleanup = function(connection) {\r\n  util.log(\"Cleaning up PeerConnection to \" + connection.peer);\r\n\r\n  var pc = connection.pc;\r\n\r\n  if (\r\n    !!pc &&\r\n    ((pc.readyState && pc.readyState !== \"closed\") ||\r\n      pc.signalingState !== \"closed\")\r\n  ) {\r\n    pc.close();\r\n    connection.pc = null;\r\n  }\r\n};\r\n\r\nNegotiator._makeOffer = function(connection) {\r\n  var pc = connection.pc;\r\n  pc.createOffer(\r\n    function(offer) {\r\n      util.log(\"Created offer.\");\r\n\r\n      if (\r\n        !util.supports.sctp &&\r\n        connection.type === \"data\" &&\r\n        connection.reliable\r\n      ) {\r\n        offer.sdp = Reliable.higherBandwidthSDP(offer.sdp);\r\n      }\r\n\r\n      pc.setLocalDescription(\r\n        offer,\r\n        function() {\r\n          util.log(\"Set localDescription: offer\", \"for:\", connection.peer);\r\n          connection.provider.socket.send({\r\n            type: \"OFFER\",\r\n            payload: {\r\n              sdp: offer,\r\n              type: connection.type,\r\n              label: connection.label,\r\n              connectionId: connection.id,\r\n              reliable: connection.reliable,\r\n              serialization: connection.serialization,\r\n              metadata: connection.metadata,\r\n              browser: util.browser\r\n            },\r\n            dst: connection.peer\r\n          });\r\n        },\r\n        function(err) {\r\n          // TODO: investigate why _makeOffer is being called from the answer\r\n          if (\r\n            err !=\r\n            \"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer\"\r\n          ) {\r\n            connection.provider.emitError(\"webrtc\", err);\r\n            util.log(\"Failed to setLocalDescription, \", err);\r\n          }\r\n        }\r\n      );\r\n    },\r\n    function(err) {\r\n      connection.provider.emitError(\"webrtc\", err);\r\n      util.log(\"Failed to createOffer, \", err);\r\n    },\r\n    connection.options.constraints\r\n  );\r\n};\r\n\r\nNegotiator._makeAnswer = function(connection) {\r\n  var pc = connection.pc;\r\n\r\n  pc.createAnswer(\r\n    function(answer) {\r\n      util.log(\"Created answer.\");\r\n\r\n      if (\r\n        !util.supports.sctp &&\r\n        connection.type === \"data\" &&\r\n        connection.reliable\r\n      ) {\r\n        answer.sdp = Reliable.higherBandwidthSDP(answer.sdp);\r\n      }\r\n\r\n      pc.setLocalDescription(\r\n        answer,\r\n        function() {\r\n          util.log(\"Set localDescription: answer\", \"for:\", connection.peer);\r\n          connection.provider.socket.send({\r\n            type: \"ANSWER\",\r\n            payload: {\r\n              sdp: answer,\r\n              type: connection.type,\r\n              connectionId: connection.id,\r\n              browser: util.browser\r\n            },\r\n            dst: connection.peer\r\n          });\r\n        },\r\n        function(err) {\r\n          connection.provider.emitError(\"webrtc\", err);\r\n          util.log(\"Failed to setLocalDescription, \", err);\r\n        }\r\n      );\r\n    },\r\n    function(err) {\r\n      connection.provider.emitError(\"webrtc\", err);\r\n      util.log(\"Failed to create answer, \", err);\r\n    }\r\n  );\r\n};\r\n\r\n/** Handle an SDP. */\r\nNegotiator.handleSDP = function(type, connection, sdp) {\r\n  sdp = new RTCSessionDescription(sdp);\r\n  var pc = connection.pc;\r\n\r\n  util.log(\"Setting remote description\", sdp);\r\n  pc.setRemoteDescription(\r\n    sdp,\r\n    function() {\r\n      util.log(\"Set remoteDescription:\", type, \"for:\", connection.peer);\r\n\r\n      if (type === \"OFFER\") {\r\n        Negotiator._makeAnswer(connection);\r\n      }\r\n    },\r\n    function(err) {\r\n      connection.provider.emitError(\"webrtc\", err);\r\n      util.log(\"Failed to setRemoteDescription, \", err);\r\n    }\r\n  );\r\n};\r\n\r\n/** Handle a candidate. */\r\nNegotiator.handleCandidate = function(connection, ice) {\r\n  var candidate = ice.candidate;\r\n  var sdpMLineIndex = ice.sdpMLineIndex;\r\n  connection.pc.addIceCandidate(\r\n    new RTCIceCandidate({\r\n      sdpMLineIndex: sdpMLineIndex,\r\n      candidate: candidate\r\n    })\r\n  );\r\n  util.log(\"Added ICE candidate for:\", connection.peer);\r\n};\r\n\r\nmodule.exports = Negotiator;\r\n","var util = require('./util');\r\nvar EventEmitter = require('eventemitter3');\r\nvar Negotiator = require('./negotiator');\r\n\r\n/**\r\n * Wraps the streaming interface between two Peers.\r\n */\r\nfunction MediaConnection(peer, provider, options) {\r\n  if (!(this instanceof MediaConnection)) return new MediaConnection(peer, provider, options);\r\n  EventEmitter.call(this);\r\n\r\n  this.options = util.extend({}, options);\r\n\r\n  this.open = false;\r\n  this.type = 'media';\r\n  this.peer = peer;\r\n  this.provider = provider;\r\n  this.metadata = this.options.metadata;\r\n  this.localStream = this.options._stream;\r\n\r\n  this.id = this.options.connectionId || MediaConnection._idPrefix + util.randomToken();\r\n  if (this.localStream) {\r\n    Negotiator.startConnection(\r\n      this,\r\n      {_stream: this.localStream, originator: true}\r\n    );\r\n  }\r\n};\r\n\r\nutil.inherits(MediaConnection, EventEmitter);\r\n\r\nMediaConnection._idPrefix = 'mc_';\r\n\r\nMediaConnection.prototype.addStream = function(remoteStream) {\r\n  util.log('Receiving stream', remoteStream);\r\n\r\n  this.remoteStream = remoteStream;\r\n  this.emit('stream', remoteStream); // Should we call this `open`?\r\n\r\n};\r\n\r\nMediaConnection.prototype.handleMessage = function(message) {\r\n  var payload = message.payload;\r\n\r\n  switch (message.type) {\r\n    case 'ANSWER':\r\n      // Forward to negotiator\r\n      Negotiator.handleSDP(message.type, this, payload.sdp);\r\n      this.open = true;\r\n      break;\r\n    case 'CANDIDATE':\r\n      Negotiator.handleCandidate(this, payload.candidate);\r\n      break;\r\n    default:\r\n      util.warn('Unrecognized message type:', message.type, 'from peer:', this.peer);\r\n      break;\r\n  }\r\n}\r\n\r\nMediaConnection.prototype.answer = function(stream) {\r\n  if (this.localStream) {\r\n    util.warn('Local stream already exists on this MediaConnection. Are you answering a call twice?');\r\n    return;\r\n  }\r\n\r\n  this.options._payload._stream = stream;\r\n\r\n  this.localStream = stream;\r\n  Negotiator.startConnection(\r\n    this,\r\n    this.options._payload\r\n  )\r\n  // Retrieve lost messages stored because PeerConnection not set up.\r\n  var messages = this.provider._getMessages(this.id);\r\n  for (var i = 0, ii = messages.length; i < ii; i += 1) {\r\n    this.handleMessage(messages[i]);\r\n  }\r\n  this.open = true;\r\n};\r\n\r\n/**\r\n * Exposed functionality for users.\r\n */\r\n\r\n/** Allows user to close connection. */\r\nMediaConnection.prototype.close = function() {\r\n  if (!this.open) {\r\n    return;\r\n  }\r\n  this.open = false;\r\n  Negotiator.cleanup(this);\r\n  this.emit('close')\r\n};\r\n\r\nmodule.exports = MediaConnection;\r\n","var BinaryPack = require('js-binarypack');\n\nvar util = {\n  debug: false,\n  \n  inherits: function(ctor, superCtor) {\n    ctor.super_ = superCtor;\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  },\n  extend: function(dest, source) {\n    for(var key in source) {\n      if(source.hasOwnProperty(key)) {\n        dest[key] = source[key];\n      }\n    }\n    return dest;\n  },\n  pack: BinaryPack.pack,\n  unpack: BinaryPack.unpack,\n  \n  log: function () {\n    if (util.debug) {\n      var copy = [];\n      for (var i = 0; i < arguments.length; i++) {\n        copy[i] = arguments[i];\n      }\n      copy.unshift('Reliable: ');\n      console.log.apply(console, copy);\n    }\n  },\n\n  setZeroTimeout: (function(global) {\n    var timeouts = [];\n    var messageName = 'zero-timeout-message';\n\n    // Like setTimeout, but only takes a function argument.\t There's\n    // no time argument (always zero) and no arguments (you have to\n    // use a closure).\n    function setZeroTimeoutPostMessage(fn) {\n      timeouts.push(fn);\n      global.postMessage(messageName, '*');\n    }\t\t\n\n    function handleMessage(event) {\n      if (event.source == global && event.data == messageName) {\n        if (event.stopPropagation) {\n          event.stopPropagation();\n        }\n        if (timeouts.length) {\n          timeouts.shift()();\n        }\n      }\n    }\n    if (global.addEventListener) {\n      global.addEventListener('message', handleMessage, true);\n    } else if (global.attachEvent) {\n      global.attachEvent('onmessage', handleMessage);\n    }\n    return setZeroTimeoutPostMessage;\n  }(this)),\n  \n  blobToArrayBuffer: function(blob, cb){\n    var fr = new FileReader();\n    fr.onload = function(evt) {\n      cb(evt.target.result);\n    };\n    fr.readAsArrayBuffer(blob);\n  },\n  blobToBinaryString: function(blob, cb){\n    var fr = new FileReader();\n    fr.onload = function(evt) {\n      cb(evt.target.result);\n    };\n    fr.readAsBinaryString(blob);\n  },\n  binaryStringToArrayBuffer: function(binary) {\n    var byteArray = new Uint8Array(binary.length);\n    for (var i = 0; i < binary.length; i++) {\n      byteArray[i] = binary.charCodeAt(i) & 0xff;\n    }\n    return byteArray.buffer;\n  },\n  randomToken: function () {\n    return Math.random().toString(36).substr(2);\n  }\n};\n\nmodule.exports = util;\n","var util = require('./util');\n\n/**\n * Reliable transfer for Chrome Canary DataChannel impl.\n * Author: @michellebu\n */\nfunction Reliable(dc, debug) {\n  if (!(this instanceof Reliable)) return new Reliable(dc);\n  this._dc = dc;\n\n  util.debug = debug;\n\n  // Messages sent/received so far.\n  // id: { ack: n, chunks: [...] }\n  this._outgoing = {};\n  // id: { ack: ['ack', id, n], chunks: [...] }\n  this._incoming = {};\n  this._received = {};\n\n  // Window size.\n  this._window = 1000;\n  // MTU.\n  this._mtu = 500;\n  // Interval for setInterval. In ms.\n  this._interval = 0;\n\n  // Messages sent.\n  this._count = 0;\n\n  // Outgoing message queue.\n  this._queue = [];\n\n  this._setupDC();\n};\n\n// Send a message reliably.\nReliable.prototype.send = function(msg) {\n  // Determine if chunking is necessary.\n  var bl = util.pack(msg);\n  if (bl.size < this._mtu) {\n    this._handleSend(['no', bl]);\n    return;\n  }\n\n  this._outgoing[this._count] = {\n    ack: 0,\n    chunks: this._chunk(bl)\n  };\n\n  if (util.debug) {\n    this._outgoing[this._count].timer = new Date();\n  }\n\n  // Send prelim window.\n  this._sendWindowedChunks(this._count);\n  this._count += 1;\n};\n\n// Set up interval for processing queue.\nReliable.prototype._setupInterval = function() {\n  // TODO: fail gracefully.\n\n  var self = this;\n  this._timeout = setInterval(function() {\n    // FIXME: String stuff makes things terribly async.\n    var msg = self._queue.shift();\n    if (msg._multiple) {\n      for (var i = 0, ii = msg.length; i < ii; i += 1) {\n        self._intervalSend(msg[i]);\n      }\n    } else {\n      self._intervalSend(msg);\n    }\n  }, this._interval);\n};\n\nReliable.prototype._intervalSend = function(msg) {\n  var self = this;\n  msg = util.pack(msg);\n  util.blobToBinaryString(msg, function(str) {\n    self._dc.send(str);\n  });\n  if (self._queue.length === 0) {\n    clearTimeout(self._timeout);\n    self._timeout = null;\n    //self._processAcks();\n  }\n};\n\n// Go through ACKs to send missing pieces.\nReliable.prototype._processAcks = function() {\n  for (var id in this._outgoing) {\n    if (this._outgoing.hasOwnProperty(id)) {\n      this._sendWindowedChunks(id);\n    }\n  }\n};\n\n// Handle sending a message.\n// FIXME: Don't wait for interval time for all messages...\nReliable.prototype._handleSend = function(msg) {\n  var push = true;\n  for (var i = 0, ii = this._queue.length; i < ii; i += 1) {\n    var item = this._queue[i];\n    if (item === msg) {\n      push = false;\n    } else if (item._multiple && item.indexOf(msg) !== -1) {\n      push = false;\n    }\n  }\n  if (push) {\n    this._queue.push(msg);\n    if (!this._timeout) {\n      this._setupInterval();\n    }\n  }\n};\n\n// Set up DataChannel handlers.\nReliable.prototype._setupDC = function() {\n  // Handle various message types.\n  var self = this;\n  this._dc.onmessage = function(e) {\n    var msg = e.data;\n    var datatype = msg.constructor;\n    // FIXME: msg is String until binary is supported.\n    // Once that happens, this will have to be smarter.\n    if (datatype === String) {\n      var ab = util.binaryStringToArrayBuffer(msg);\n      msg = util.unpack(ab);\n      self._handleMessage(msg);\n    }\n  };\n};\n\n// Handles an incoming message.\nReliable.prototype._handleMessage = function(msg) {\n  var id = msg[1];\n  var idata = this._incoming[id];\n  var odata = this._outgoing[id];\n  var data;\n  switch (msg[0]) {\n    // No chunking was done.\n    case 'no':\n      var message = id;\n      if (!!message) {\n        this.onmessage(util.unpack(message));\n      }\n      break;\n    // Reached the end of the message.\n    case 'end':\n      data = idata;\n\n      // In case end comes first.\n      this._received[id] = msg[2];\n\n      if (!data) {\n        break;\n      }\n\n      this._ack(id);\n      break;\n    case 'ack':\n      data = odata;\n      if (!!data) {\n        var ack = msg[2];\n        // Take the larger ACK, for out of order messages.\n        data.ack = Math.max(ack, data.ack);\n\n        // Clean up when all chunks are ACKed.\n        if (data.ack >= data.chunks.length) {\n          util.log('Time: ', new Date() - data.timer);\n          delete this._outgoing[id];\n        } else {\n          this._processAcks();\n        }\n      }\n      // If !data, just ignore.\n      break;\n    // Received a chunk of data.\n    case 'chunk':\n      // Create a new entry if none exists.\n      data = idata;\n      if (!data) {\n        var end = this._received[id];\n        if (end === true) {\n          break;\n        }\n        data = {\n          ack: ['ack', id, 0],\n          chunks: []\n        };\n        this._incoming[id] = data;\n      }\n\n      var n = msg[2];\n      var chunk = msg[3];\n      data.chunks[n] = new Uint8Array(chunk);\n\n      // If we get the chunk we're looking for, ACK for next missing.\n      // Otherwise, ACK the same N again.\n      if (n === data.ack[2]) {\n        this._calculateNextAck(id);\n      }\n      this._ack(id);\n      break;\n    default:\n      // Shouldn't happen, but would make sense for message to just go\n      // through as is.\n      this._handleSend(msg);\n      break;\n  }\n};\n\n// Chunks BL into smaller messages.\nReliable.prototype._chunk = function(bl) {\n  var chunks = [];\n  var size = bl.size;\n  var start = 0;\n  while (start < size) {\n    var end = Math.min(size, start + this._mtu);\n    var b = bl.slice(start, end);\n    var chunk = {\n      payload: b\n    }\n    chunks.push(chunk);\n    start = end;\n  }\n  util.log('Created', chunks.length, 'chunks.');\n  return chunks;\n};\n\n// Sends ACK N, expecting Nth blob chunk for message ID.\nReliable.prototype._ack = function(id) {\n  var ack = this._incoming[id].ack;\n\n  // if ack is the end value, then call _complete.\n  if (this._received[id] === ack[2]) {\n    this._complete(id);\n    this._received[id] = true;\n  }\n\n  this._handleSend(ack);\n};\n\n// Calculates the next ACK number, given chunks.\nReliable.prototype._calculateNextAck = function(id) {\n  var data = this._incoming[id];\n  var chunks = data.chunks;\n  for (var i = 0, ii = chunks.length; i < ii; i += 1) {\n    // This chunk is missing!!! Better ACK for it.\n    if (chunks[i] === undefined) {\n      data.ack[2] = i;\n      return;\n    }\n  }\n  data.ack[2] = chunks.length;\n};\n\n// Sends the next window of chunks.\nReliable.prototype._sendWindowedChunks = function(id) {\n  util.log('sendWindowedChunks for: ', id);\n  var data = this._outgoing[id];\n  var ch = data.chunks;\n  var chunks = [];\n  var limit = Math.min(data.ack + this._window, ch.length);\n  for (var i = data.ack; i < limit; i += 1) {\n    if (!ch[i].sent || i === data.ack) {\n      ch[i].sent = true;\n      chunks.push(['chunk', id, i, ch[i].payload]);\n    }\n  }\n  if (data.ack + this._window >= ch.length) {\n    chunks.push(['end', id, ch.length])\n  }\n  chunks._multiple = true;\n  this._handleSend(chunks);\n};\n\n// Puts together a message from chunks.\nReliable.prototype._complete = function(id) {\n  util.log('Completed called for', id);\n  var self = this;\n  var chunks = this._incoming[id].chunks;\n  var bl = new Blob(chunks);\n  util.blobToArrayBuffer(bl, function(ab) {\n    self.onmessage(util.unpack(ab));\n  });\n  delete this._incoming[id];\n};\n\n// Ups bandwidth limit on SDP. Meant to be called during offer/answer.\nReliable.higherBandwidthSDP = function(sdp) {\n  // AS stands for Application-Specific Maximum.\n  // Bandwidth number is in kilobits / sec.\n  // See RFC for more info: http://www.ietf.org/rfc/rfc2327.txt\n\n  // Chrome 31+ doesn't want us munging the SDP, so we'll let them have their\n  // way.\n  var version = navigator.appVersion.match(/Chrome\\/(.*?) /);\n  if (version) {\n    version = parseInt(version[1].split('.').shift());\n    if (version < 31) {\n      var parts = sdp.split('b=AS:30');\n      var replace = 'b=AS:102400'; // 100 Mbps\n      if (parts.length > 1) {\n        return parts[0] + replace + parts[1];\n      }\n    }\n  }\n\n  return sdp;\n};\n\n// Overwritten, typically.\nReliable.prototype.onmessage = function(msg) {};\n\nmodule.exports.Reliable = Reliable;\n","var util = require('./util');\r\nvar EventEmitter = require('eventemitter3');\r\nvar Negotiator = require('./negotiator');\r\nvar Reliable = require('reliable');\r\n\r\n/**\r\n * Wraps a DataChannel between two Peers.\r\n */\r\nfunction DataConnection(peer, provider, options) {\r\n  if (!(this instanceof DataConnection)) return new DataConnection(peer, provider, options);\r\n  EventEmitter.call(this);\r\n\r\n  this.options = util.extend({\r\n    serialization: 'binary',\r\n    reliable: false\r\n  }, options);\r\n\r\n  // Connection is not open yet.\r\n  this.open = false;\r\n  this.type = 'data';\r\n  this.peer = peer;\r\n  this.provider = provider;\r\n\r\n  this.id = this.options.connectionId || DataConnection._idPrefix + util.randomToken();\r\n\r\n  this.label = this.options.label || this.id;\r\n  this.metadata = this.options.metadata;\r\n  this.serialization = this.options.serialization;\r\n  this.reliable = this.options.reliable;\r\n\r\n  // Data channel buffering.\r\n  this._buffer = [];\r\n  this._buffering = false;\r\n  this.bufferSize = 0;\r\n\r\n  // For storing large data.\r\n  this._chunkedData = {};\r\n\r\n  if (this.options._payload) {\r\n    this._peerBrowser = this.options._payload.browser;\r\n  }\r\n\r\n  Negotiator.startConnection(\r\n    this,\r\n    this.options._payload || {\r\n      originator: true\r\n    }\r\n  );\r\n}\r\n\r\nutil.inherits(DataConnection, EventEmitter);\r\n\r\nDataConnection._idPrefix = 'dc_';\r\n\r\n/** Called by the Negotiator when the DataChannel is ready. */\r\nDataConnection.prototype.initialize = function(dc) {\r\n  this._dc = this.dataChannel = dc;\r\n  this._configureDataChannel();\r\n}\r\n\r\nDataConnection.prototype._configureDataChannel = function() {\r\n  var self = this;\r\n  if (util.supports.sctp) {\r\n    this._dc.binaryType = 'arraybuffer';\r\n  }\r\n  this._dc.onopen = function() {\r\n    util.log('Data channel connection success');\r\n    self.open = true;\r\n    self.emit('open');\r\n  }\r\n\r\n  // Use the Reliable shim for non Firefox browsers\r\n  if (!util.supports.sctp && this.reliable) {\r\n    this._reliable = new Reliable(this._dc, util.debug);\r\n  }\r\n\r\n  if (this._reliable) {\r\n    this._reliable.onmessage = function(msg) {\r\n      self.emit('data', msg);\r\n    };\r\n  } else {\r\n    this._dc.onmessage = function(e) {\r\n      self._handleDataMessage(e);\r\n    };\r\n  }\r\n  this._dc.onclose = function(e) {\r\n    util.log('DataChannel closed for:', self.peer);\r\n    self.close();\r\n  };\r\n}\r\n\r\n// Handles a DataChannel message.\r\nDataConnection.prototype._handleDataMessage = function(e) {\r\n  var self = this;\r\n  var data = e.data;\r\n  var datatype = data.constructor;\r\n  if (this.serialization === 'binary' || this.serialization === 'binary-utf8') {\r\n    if (datatype === Blob) {\r\n      // Datatype should never be blob\r\n      util.blobToArrayBuffer(data, function(ab) {\r\n        data = util.unpack(ab);\r\n        self.emit('data', data);\r\n      });\r\n      return;\r\n    } else if (datatype === ArrayBuffer) {\r\n      data = util.unpack(data);\r\n    } else if (datatype === String) {\r\n      // String fallback for binary data for browsers that don't support binary yet\r\n      var ab = util.binaryStringToArrayBuffer(data);\r\n      data = util.unpack(ab);\r\n    }\r\n  } else if (this.serialization === 'json') {\r\n    data = JSON.parse(data);\r\n  }\r\n\r\n  // Check if we've chunked--if so, piece things back together.\r\n  // We're guaranteed that this isn't 0.\r\n  if (data.__peerData) {\r\n    var id = data.__peerData;\r\n    var chunkInfo = this._chunkedData[id] || {data: [], count: 0, total: data.total};\r\n\r\n    chunkInfo.data[data.n] = data.data;\r\n    chunkInfo.count += 1;\r\n\r\n    if (chunkInfo.total === chunkInfo.count) {\r\n      // Clean up before making the recursive call to `_handleDataMessage`.\r\n      delete this._chunkedData[id];\r\n\r\n      // We've received all the chunks--time to construct the complete data.\r\n      data = new Blob(chunkInfo.data);\r\n      this._handleDataMessage({data: data});\r\n    }\r\n\r\n    this._chunkedData[id] = chunkInfo;\r\n    return;\r\n  }\r\n\r\n  this.emit('data', data);\r\n}\r\n\r\n/**\r\n * Exposed functionality for users.\r\n */\r\n\r\n/** Allows user to close connection. */\r\nDataConnection.prototype.close = function() {\r\n  if (!this.open) {\r\n    return;\r\n  }\r\n  this.open = false;\r\n  Negotiator.cleanup(this);\r\n  this.emit('close');\r\n}\r\n\r\n/** Allows user to send data. */\r\nDataConnection.prototype.send = function(data, chunked) {\r\n  if (!this.open) {\r\n    this.emit('error', new Error('Connection is not open. You should listen for the `open` event before sending messages.'));\r\n    return;\r\n  }\r\n  if (this._reliable) {\r\n    // Note: reliable shim sending will make it so that you cannot customize\r\n    // serialization.\r\n    this._reliable.send(data);\r\n    return;\r\n  }\r\n  var self = this;\r\n  if (this.serialization === 'json') {\r\n    this._bufferedSend(JSON.stringify(data));\r\n  } else if (this.serialization === 'binary' || this.serialization === 'binary-utf8') {\r\n    var blob = util.pack(data);\r\n\r\n    // For Chrome-Firefox interoperability, we need to make Firefox \"chunk\"\r\n    // the data it sends out.\r\n    var needsChunking = util.chunkedBrowsers[this._peerBrowser] || util.chunkedBrowsers[util.browser];\r\n    if (needsChunking && !chunked && blob.size > util.chunkedMTU) {\r\n      this._sendChunks(blob);\r\n      return;\r\n    }\r\n\r\n    // DataChannel currently only supports strings.\r\n    if (!util.supports.sctp) {\r\n      util.blobToBinaryString(blob, function(str) {\r\n        self._bufferedSend(str);\r\n      });\r\n    } else if (!util.supports.binaryBlob) {\r\n      // We only do this if we really need to (e.g. blobs are not supported),\r\n      // because this conversion is costly.\r\n      util.blobToArrayBuffer(blob, function(ab) {\r\n        self._bufferedSend(ab);\r\n      });\r\n    } else {\r\n      this._bufferedSend(blob);\r\n    }\r\n  } else {\r\n    this._bufferedSend(data);\r\n  }\r\n}\r\n\r\nDataConnection.prototype._bufferedSend = function(msg) {\r\n  if (this._buffering || !this._trySend(msg)) {\r\n    this._buffer.push(msg);\r\n    this.bufferSize = this._buffer.length;\r\n  }\r\n}\r\n\r\n// Returns true if the send succeeds.\r\nDataConnection.prototype._trySend = function(msg) {\r\n  try {\r\n    this._dc.send(msg);\r\n  } catch (e) {\r\n    this._buffering = true;\r\n\r\n    var self = this;\r\n    setTimeout(function() {\r\n      // Try again.\r\n      self._buffering = false;\r\n      self._tryBuffer();\r\n    }, 100);\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\n// Try to send the first message in the buffer.\r\nDataConnection.prototype._tryBuffer = function() {\r\n  if (this._buffer.length === 0) {\r\n    return;\r\n  }\r\n\r\n  var msg = this._buffer[0];\r\n\r\n  if (this._trySend(msg)) {\r\n    this._buffer.shift();\r\n    this.bufferSize = this._buffer.length;\r\n    this._tryBuffer();\r\n  }\r\n}\r\n\r\nDataConnection.prototype._sendChunks = function(blob) {\r\n  var blobs = util.chunk(blob);\r\n  for (var i = 0, ii = blobs.length; i < ii; i += 1) {\r\n    var blob = blobs[i];\r\n    this.send(blob, true);\r\n  }\r\n}\r\n\r\nDataConnection.prototype.handleMessage = function(message) {\r\n  var payload = message.payload;\r\n\r\n  switch (message.type) {\r\n    case 'ANSWER':\r\n      this._peerBrowser = payload.browser;\r\n\r\n      // Forward to negotiator\r\n      Negotiator.handleSDP(message.type, this, payload.sdp);\r\n      break;\r\n    case 'CANDIDATE':\r\n      Negotiator.handleCandidate(this, payload.candidate);\r\n      break;\r\n    default:\r\n      util.warn('Unrecognized message type:', message.type, 'from peer:', this.peer);\r\n      break;\r\n  }\r\n}\r\n\r\nmodule.exports = DataConnection;\r\n","var util = require(\"./util\");\r\nvar EventEmitter = require(\"eventemitter3\");\r\nvar Socket = require(\"./socket\");\r\nvar MediaConnection = require(\"./mediaconnection\");\r\nvar DataConnection = require(\"./dataconnection\");\r\n\r\n/**\r\n * A peer who can initiate connections with other peers.\r\n */\r\nfunction Peer(id, options) {\r\n  if (!(this instanceof Peer)) return new Peer(id, options);\r\n  EventEmitter.call(this);\r\n\r\n  // Deal with overloading\r\n  if (id && id.constructor == Object) {\r\n    options = id;\r\n    id = undefined;\r\n  } else if (id) {\r\n    // Ensure id is a string\r\n    id = id.toString();\r\n  }\r\n  //\r\n\r\n  // Configurize options\r\n  options = util.extend(\r\n    {\r\n      debug: 0, // 1: Errors, 2: Warnings, 3: All logs\r\n      host: util.CLOUD_HOST,\r\n      port: util.CLOUD_PORT,\r\n      path: \"/\",\r\n      token: util.randomToken(),\r\n      config: util.defaultConfig\r\n    },\r\n    options\r\n  );\r\n  options.key = \"peerjs\";\r\n  this.options = options;\r\n  // Detect relative URL host.\r\n  if (options.host === \"/\") {\r\n    options.host = window.location.hostname;\r\n  }\r\n  // Set path correctly.\r\n  if (options.path[0] !== \"/\") {\r\n    options.path = \"/\" + options.path;\r\n  }\r\n  if (options.path[options.path.length - 1] !== \"/\") {\r\n    options.path += \"/\";\r\n  }\r\n\r\n  // Set whether we use SSL to same as current host\r\n  if (options.secure === undefined && options.host !== util.CLOUD_HOST) {\r\n    options.secure = util.isSecure();\r\n  } else if(options.host == util.CLOUD_HOST){\r\n    options.secure = true;\r\n  }\r\n  // Set a custom log function if present\r\n  if (options.logFunction) {\r\n    util.setLogFunction(options.logFunction);\r\n  }\r\n  util.setLogLevel(options.debug);\r\n  //\r\n\r\n  // Sanity checks\r\n  // Ensure WebRTC supported\r\n  if (!util.supports.audioVideo && !util.supports.data) {\r\n    this._delayedAbort(\r\n      \"browser-incompatible\",\r\n      \"The current browser does not support WebRTC\"\r\n    );\r\n    return;\r\n  }\r\n  // Ensure alphanumeric id\r\n  if (!util.validateId(id)) {\r\n    this._delayedAbort(\"invalid-id\", 'ID \"' + id + '\" is invalid');\r\n    return;\r\n  }\r\n  // Ensure valid key\r\n  // if (!util.validateKey(options.key)) {\r\n  //   this._delayedAbort(\r\n  //     \"invalid-key\",\r\n  //     'API KEY \"' + options.key + '\" is invalid'\r\n  //   );\r\n  //   return;\r\n  // }\r\n  // Ensure not using unsecure cloud server on SSL page\r\n  // if (options.secure && options.host === \"0.peerjs.com\") {\r\n  //   this._delayedAbort(\r\n  //     \"ssl-unavailable\",\r\n  //     \"The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS.\"\r\n  //   );\r\n  //   return;\r\n  // }\r\n  //\r\n\r\n  // States.\r\n  this.destroyed = false; // Connections have been killed\r\n  this.disconnected = false; // Connection to PeerServer killed but P2P connections still active\r\n  this.open = false; // Sockets and such are not yet open.\r\n  //\r\n\r\n  // References\r\n  this.connections = {}; // DataConnections for this peer.\r\n  this._lostMessages = {}; // src => [list of messages]\r\n  //\r\n\r\n  // Start the server connection\r\n  this._initializeServerConnection();\r\n  if (id) {\r\n    this._initialize(id);\r\n  } else {\r\n    this._retrieveId();\r\n  }\r\n  //\r\n}\r\n\r\nutil.inherits(Peer, EventEmitter);\r\n\r\n// Initialize the 'socket' (which is actually a mix of XHR streaming and\r\n// websockets.)\r\nPeer.prototype._initializeServerConnection = function() {\r\n  var self = this;\r\n  this.socket = new Socket(\r\n    this.options.secure,\r\n    this.options.host,\r\n    this.options.port,\r\n    this.options.path,\r\n    this.options.key,\r\n    this.options.wsport\r\n  );\r\n  this.socket.on(\"message\", function(data) {\r\n    self._handleMessage(data);\r\n  });\r\n  this.socket.on(\"error\", function(error) {\r\n    self._abort(\"socket-error\", error);\r\n  });\r\n  this.socket.on(\"disconnected\", function() {\r\n    // If we haven't explicitly disconnected, emit error and disconnect.\r\n    if (!self.disconnected) {\r\n      self.emitError(\"network\", \"Lost connection to server.\");\r\n      self.disconnect();\r\n    }\r\n  });\r\n  this.socket.on(\"close\", function() {\r\n    // If we haven't explicitly disconnected, emit error.\r\n    if (!self.disconnected) {\r\n      self._abort(\"socket-closed\", \"Underlying socket is already closed.\");\r\n    }\r\n  });\r\n};\r\n\r\n/** Get a unique ID from the server via XHR. */\r\nPeer.prototype._retrieveId = function(cb) {\r\n  var self = this;\r\n  var http = new XMLHttpRequest();\r\n  var protocol = this.options.secure ? \"https://\" : \"http://\";\r\n  var url =\r\n    protocol +\r\n    this.options.host +\r\n    \":\" +\r\n    this.options.port +\r\n    this.options.path +\r\n    this.options.key +\r\n    \"/id\";\r\n  var queryString = \"?ts=\" + new Date().getTime() + \"\" + Math.random();\r\n  url += queryString;\r\n\r\n  // If there's no ID we need to wait for one before trying to init socket.\r\n  http.open(\"get\", url, true);\r\n  http.onerror = function(e) {\r\n    util.error(\"Error retrieving ID\", e);\r\n    var pathError = \"\";\r\n    if (self.options.path === \"/\" && self.options.host !== util.CLOUD_HOST) {\r\n      pathError =\r\n        \" If you passed in a `path` to your self-hosted PeerServer, \" +\r\n        \"you'll also need to pass in that same path when creating a new \" +\r\n        \"Peer.\";\r\n    }\r\n    self._abort(\r\n      \"server-error\",\r\n      \"Could not get an ID from the server.\" + pathError\r\n    );\r\n  };\r\n  http.onreadystatechange = function() {\r\n    if (http.readyState !== 4) {\r\n      return;\r\n    }\r\n    if (http.status !== 200) {\r\n      http.onerror();\r\n      return;\r\n    }\r\n    self._initialize(http.responseText);\r\n  };\r\n  http.send(null);\r\n};\r\n\r\n/** Initialize a connection with the server. */\r\nPeer.prototype._initialize = function(id) {\r\n  this.id = id;\r\n  this.socket.start(this.id, this.options.token);\r\n};\r\n\r\n/** Handles messages from the server. */\r\nPeer.prototype._handleMessage = function(message) {\r\n  var type = message.type;\r\n  var payload = message.payload;\r\n  var peer = message.src;\r\n  var connection;\r\n\r\n  switch (type) {\r\n    case \"OPEN\": // The connection to the server is open.\r\n      this.emit(\"open\", this.id);\r\n      this.open = true;\r\n      break;\r\n    case \"ERROR\": // Server error.\r\n      this._abort(\"server-error\", payload.msg);\r\n      break;\r\n    case \"ID-TAKEN\": // The selected ID is taken.\r\n      this._abort(\"unavailable-id\", \"ID `\" + this.id + \"` is taken\");\r\n      break;\r\n    case \"INVALID-KEY\": // The given API key cannot be found.\r\n      this._abort(\r\n        \"invalid-key\",\r\n        'API KEY \"' + this.options.key + '\" is invalid'\r\n      );\r\n      break;\r\n\r\n    //\r\n    case \"LEAVE\": // Another peer has closed its connection to this peer.\r\n      util.log(\"Received leave message from\", peer);\r\n      this._cleanupPeer(peer);\r\n      break;\r\n\r\n    case \"EXPIRE\": // The offer sent to a peer has expired without response.\r\n      this.emitError(\"peer-unavailable\", \"Could not connect to peer \" + peer);\r\n      break;\r\n    case \"OFFER\": // we should consider switching this to CALL/CONNECT, but this is the least breaking option.\r\n      var connectionId = payload.connectionId;\r\n      connection = this.getConnection(peer, connectionId);\r\n\r\n      if (connection) {\r\n        connection.close();\r\n        util.warn(\"Offer received for existing Connection ID:\", connectionId);\r\n      }\r\n\r\n      // Create a new connection.\r\n      if (payload.type === \"media\") {\r\n        connection = new MediaConnection(peer, this, {\r\n          connectionId: connectionId,\r\n          _payload: payload,\r\n          metadata: payload.metadata\r\n        });\r\n        this._addConnection(peer, connection);\r\n        this.emit(\"call\", connection);\r\n      } else if (payload.type === \"data\") {\r\n        connection = new DataConnection(peer, this, {\r\n          connectionId: connectionId,\r\n          _payload: payload,\r\n          metadata: payload.metadata,\r\n          label: payload.label,\r\n          serialization: payload.serialization,\r\n          reliable: payload.reliable\r\n        });\r\n        this._addConnection(peer, connection);\r\n        this.emit(\"connection\", connection);\r\n      } else {\r\n        util.warn(\"Received malformed connection type:\", payload.type);\r\n        return;\r\n      }\r\n      // Find messages.\r\n      var messages = this._getMessages(connectionId);\r\n      for (var i = 0, ii = messages.length; i < ii; i += 1) {\r\n        connection.handleMessage(messages[i]);\r\n      }\r\n\r\n      break;\r\n    default:\r\n      if (!payload) {\r\n        util.warn(\r\n          \"You received a malformed message from \" + peer + \" of type \" + type\r\n        );\r\n        return;\r\n      }\r\n\r\n      var id = payload.connectionId;\r\n      connection = this.getConnection(peer, id);\r\n\r\n      if (connection && connection.pc) {\r\n        // Pass it on.\r\n        connection.handleMessage(message);\r\n      } else if (id) {\r\n        // Store for possible later use\r\n        this._storeMessage(id, message);\r\n      } else {\r\n        util.warn(\"You received an unrecognized message:\", message);\r\n      }\r\n      break;\r\n  }\r\n};\r\n\r\n/** Stores messages without a set up connection, to be claimed later. */\r\nPeer.prototype._storeMessage = function(connectionId, message) {\r\n  if (!this._lostMessages[connectionId]) {\r\n    this._lostMessages[connectionId] = [];\r\n  }\r\n  this._lostMessages[connectionId].push(message);\r\n};\r\n\r\n/** Retrieve messages from lost message store */\r\nPeer.prototype._getMessages = function(connectionId) {\r\n  var messages = this._lostMessages[connectionId];\r\n  if (messages) {\r\n    delete this._lostMessages[connectionId];\r\n    return messages;\r\n  } else {\r\n    return [];\r\n  }\r\n};\r\n\r\n/**\r\n * Returns a DataConnection to the specified peer. See documentation for a\r\n * complete list of options.\r\n */\r\nPeer.prototype.connect = function(peer, options) {\r\n  if (this.disconnected) {\r\n    util.warn(\r\n      \"You cannot connect to a new Peer because you called \" +\r\n        \".disconnect() on this Peer and ended your connection with the \" +\r\n        \"server. You can create a new Peer to reconnect, or call reconnect \" +\r\n        \"on this peer if you believe its ID to still be available.\"\r\n    );\r\n    this.emitError(\r\n      \"disconnected\",\r\n      \"Cannot connect to new Peer after disconnecting from server.\"\r\n    );\r\n    return;\r\n  }\r\n  var connection = new DataConnection(peer, this, options);\r\n  this._addConnection(peer, connection);\r\n  return connection;\r\n};\r\n\r\n/**\r\n * Returns a MediaConnection to the specified peer. See documentation for a\r\n * complete list of options.\r\n */\r\nPeer.prototype.call = function(peer, stream, options) {\r\n  if (this.disconnected) {\r\n    util.warn(\r\n      \"You cannot connect to a new Peer because you called \" +\r\n        \".disconnect() on this Peer and ended your connection with the \" +\r\n        \"server. You can create a new Peer to reconnect.\"\r\n    );\r\n    this.emitError(\r\n      \"disconnected\",\r\n      \"Cannot connect to new Peer after disconnecting from server.\"\r\n    );\r\n    return;\r\n  }\r\n  if (!stream) {\r\n    util.error(\r\n      \"To call a peer, you must provide a stream from your browser's `getUserMedia`.\"\r\n    );\r\n    return;\r\n  }\r\n  options = options || {};\r\n  options._stream = stream;\r\n  var call = new MediaConnection(peer, this, options);\r\n  this._addConnection(peer, call);\r\n  return call;\r\n};\r\n\r\n/** Add a data/media connection to this peer. */\r\nPeer.prototype._addConnection = function(peer, connection) {\r\n  if (!this.connections[peer]) {\r\n    this.connections[peer] = [];\r\n  }\r\n  this.connections[peer].push(connection);\r\n};\r\n\r\n/** Retrieve a data/media connection for this peer. */\r\nPeer.prototype.getConnection = function(peer, id) {\r\n  var connections = this.connections[peer];\r\n  if (!connections) {\r\n    return null;\r\n  }\r\n  for (var i = 0, ii = connections.length; i < ii; i++) {\r\n    if (connections[i].id === id) {\r\n      return connections[i];\r\n    }\r\n  }\r\n  return null;\r\n};\r\n\r\nPeer.prototype._delayedAbort = function(type, message) {\r\n  var self = this;\r\n  util.setZeroTimeout(function() {\r\n    self._abort(type, message);\r\n  });\r\n};\r\n\r\n/**\r\n * Destroys the Peer and emits an error message.\r\n * The Peer is not destroyed if it's in a disconnected state, in which case\r\n * it retains its disconnected state and its existing connections.\r\n */\r\nPeer.prototype._abort = function(type, message) {\r\n  util.error(\"Aborting!\");\r\n  if (!this._lastServerId) {\r\n    this.destroy();\r\n  } else {\r\n    this.disconnect();\r\n  }\r\n  this.emitError(type, message);\r\n};\r\n\r\n/** Emits a typed error message. */\r\nPeer.prototype.emitError = function(type, err) {\r\n  util.error(\"Error:\", err);\r\n  if (typeof err === \"string\") {\r\n    err = new Error(err);\r\n  }\r\n  err.type = type;\r\n  this.emit(\"error\", err);\r\n};\r\n\r\n/**\r\n * Destroys the Peer: closes all active connections as well as the connection\r\n *  to the server.\r\n * Warning: The peer can no longer create or accept connections after being\r\n *  destroyed.\r\n */\r\nPeer.prototype.destroy = function() {\r\n  if (!this.destroyed) {\r\n    this._cleanup();\r\n    this.disconnect();\r\n    this.destroyed = true;\r\n  }\r\n};\r\n\r\n/** Disconnects every connection on this peer. */\r\nPeer.prototype._cleanup = function() {\r\n  if (this.connections) {\r\n    var peers = Object.keys(this.connections);\r\n    for (var i = 0, ii = peers.length; i < ii; i++) {\r\n      this._cleanupPeer(peers[i]);\r\n    }\r\n  }\r\n  this.emit(\"close\");\r\n};\r\n\r\n/** Closes all connections to this peer. */\r\nPeer.prototype._cleanupPeer = function(peer) {\r\n  var connections = this.connections[peer];\r\n  for (var j = 0, jj = connections.length; j < jj; j += 1) {\r\n    connections[j].close();\r\n  }\r\n};\r\n\r\n/**\r\n * Disconnects the Peer's connection to the PeerServer. Does not close any\r\n *  active connections.\r\n * Warning: The peer can no longer create or accept connections after being\r\n *  disconnected. It also cannot reconnect to the server.\r\n */\r\nPeer.prototype.disconnect = function() {\r\n  var self = this;\r\n  util.setZeroTimeout(function() {\r\n    if (!self.disconnected) {\r\n      self.disconnected = true;\r\n      self.open = false;\r\n      if (self.socket) {\r\n        self.socket.close();\r\n      }\r\n      self.emit(\"disconnected\", self.id);\r\n      self._lastServerId = self.id;\r\n      self.id = null;\r\n    }\r\n  });\r\n};\r\n\r\n/** Attempts to reconnect with the same ID. */\r\nPeer.prototype.reconnect = function() {\r\n  if (this.disconnected && !this.destroyed) {\r\n    util.log(\"Attempting reconnection to server with ID \" + this._lastServerId);\r\n    this.disconnected = false;\r\n    this._initializeServerConnection();\r\n    this._initialize(this._lastServerId);\r\n  } else if (this.destroyed) {\r\n    throw new Error(\r\n      \"This peer cannot reconnect to the server. It has already been destroyed.\"\r\n    );\r\n  } else if (!this.disconnected && !this.open) {\r\n    // Do nothing. We're still connecting the first time.\r\n    util.error(\r\n      \"In a hurry? We're still trying to make the initial connection!\"\r\n    );\r\n  } else {\r\n    throw new Error(\r\n      \"Peer \" +\r\n        this.id +\r\n        \" cannot reconnect because it is not disconnected from the server!\"\r\n    );\r\n  }\r\n};\r\n\r\n/**\r\n * Get a list of available peer IDs. If you're running your own server, you'll\r\n * want to set allow_discovery: true in the PeerServer options. If you're using\r\n * the cloud server, email team@peerjs.com to get the functionality enabled for\r\n * your key.\r\n */\r\nPeer.prototype.listAllPeers = function(cb) {\r\n  cb = cb || function() {};\r\n  var self = this;\r\n  var http = new XMLHttpRequest();\r\n  var protocol = this.options.secure ? \"https://\" : \"http://\";\r\n  var url =\r\n    protocol +\r\n    this.options.host +\r\n    \":\" +\r\n    this.options.port +\r\n    this.options.path +\r\n    this.options.key +\r\n    \"/peers\";\r\n  var queryString = \"?ts=\" + new Date().getTime() + \"\" + Math.random();\r\n  url += queryString;\r\n\r\n  // If there's no ID we need to wait for one before trying to init socket.\r\n  http.open(\"get\", url, true);\r\n  http.onerror = function(e) {\r\n    self._abort(\"server-error\", \"Could not get peers from the server.\");\r\n    cb([]);\r\n  };\r\n  http.onreadystatechange = function() {\r\n    if (http.readyState !== 4) {\r\n      return;\r\n    }\r\n    if (http.status === 401) {\r\n      var helpfulError = \"\";\r\n      if (self.options.host !== util.CLOUD_HOST) {\r\n        helpfulError =\r\n          \"It looks like you're using the cloud server. You can email \" +\r\n          \"team@peerjs.com to enable peer listing for your API key.\";\r\n      } else {\r\n        helpfulError =\r\n          \"You need to enable `allow_discovery` on your self-hosted \" +\r\n          \"PeerServer to use this feature.\";\r\n      }\r\n      cb([]);\r\n      throw new Error(\r\n        \"It doesn't look like you have permission to list peers IDs. \" +\r\n          helpfulError\r\n      );\r\n    } else if (http.status !== 200) {\r\n      cb([]);\r\n    } else {\r\n      cb(JSON.parse(http.responseText));\r\n    }\r\n  };\r\n  http.send(null);\r\n};\r\n\r\nmodule.exports = Peer;\r\n","import {throttle, getElementSize} from './helpers'\nimport Tetris from './tetris'\nimport Drawable from './drawable'\nimport Peer from 'peerjs'\n\nfunction HTMLTetrisGame (parent, options) {\n  this.initialize = function () {\n    this.options = {\n      playable: false,\n      half: false\n    }\n    Object.assign(this.options, options)\n    this.sendGroundLoopInterval = null\n    this.parent = parent\n    this.createHtmlElements(parent)\n    this.createDrawables()\n    this.createTetrisGame()\n    this.attachWindowEvents()\n    if (this.options.playable) {\n      this.startPieceMoveDownLoop()\n      this.startDrawLoop()\n    }\n    this.handleResize()\n    setTimeout(() => {\n      this.handleResize()\n    }, 1000)\n  }\n\n  this.addReplica = function (conn) {\n    let replica = new HTMLTetrisGame(\n      this.parent,\n      {\n        playable: false,\n        half: true\n      }\n    )\n    // someone connected to us\n    this.sendGroundLoop(conn)\n    conn.on('data', (data) => {\n      replica.tetris.loadSerializedData(data)\n    })\n    conn.on('close', () => {\n      replica.destroy()\n    })\n    replica.handleResize()\n  }\n\n  this.destroy = function () {\n    this.parent.removeChild(this.element)\n  }\n\n  this.attachWindowEvents = function () {\n    window.addEventListener('load', () => { this.handleResize() })\n    window.addEventListener('resize', () => { this.handleResize() })\n    if (this.options.playable) {\n      setTimeout(() => { this.createPeer() }, 1000)\n      window.addEventListener('keydown', (e) => { this.handleKeyboardEvent(e) })\n      window.addEventListener('keyup', (e) => { this.handleKeyboardEvent(e) })\n    }\n  }\n\n  this.createTetrisGame = function () {\n    this.tetris = new Tetris({\n      drawableBackground: this.background,\n      drawablePieces: this.pieces\n    })\n  }\n\n  this.createHtmlElements = function () {\n    let element = document.createElement('div')\n    if (this.options.half) {\n      element.className = 'tetris-container-half'\n    } else {\n      element.className = 'tetris-container'\n    }\n    parent.appendChild(element)\n    let elementInner = document.createElement('div')\n    elementInner.className = 'tetris-container-inner'\n    element.appendChild(elementInner)\n    this.element = element\n    this.elementInner = elementInner\n  }\n\n  this.createDrawables = function () {\n    this.background = new Drawable()\n    this.pieces = new Drawable()\n    this.background.createAndAppend(this.elementInner)\n    this.pieces.createAndAppend(this.elementInner)\n  }\n\n  this.handleResize = function () {\n    let size = getElementSize(this.element)\n    let blockSize = size.height / this.tetris.options.groundHeight\n    if (blockSize * this.tetris.options.groundWidth > size.width) {\n      // blocksize exceed width crop using width\n      blockSize = size.width / this.tetris.options.groundWidth\n    }\n    blockSize = parseInt(blockSize)\n    size = {\n      width: this.tetris.options.groundWidth * blockSize,\n      height: this.tetris.options.groundHeight * blockSize\n    }\n    // resize drawables\n    this.background.resize(size)\n    this.pieces.resize(size)\n    // resize game\n    this.tetris.resize(blockSize)\n  }\n\n  this.moveDown = throttle(function () { this.tetris.pieceMoveDown() }.bind(this), 40)\n  this.moveLeft = throttle(function () { this.tetris.pieceMoveLeft() }.bind(this), 100)\n  this.moveRight = throttle(function () { this.tetris.pieceMoveRight() }.bind(this), 100)\n\n  this.handleKeyboardEvent = function (event) {\n    switch (event.which) {\n      case 80:\n        // P\n        if (event.type === 'keyup') {}\n        break\n      case 37:\n        // left\n        if (event.type === 'keydown') {\n          this.moveLeft()\n        }\n        break\n      case 38:\n        // up\n        if (event.type === 'keyup') {\n          this.tetris.rotatePieceCounterClockwise()\n        }\n        break\n      case 39:\n        // right\n        if (event.type === 'keydown') {\n          this.moveRight()\n        }\n        break\n      case 82:\n        // R\n        this.tetris.reset()\n        break\n      case 40:\n        // down\n        this.moveDown()\n        break\n      case 32:\n        // space\n        if (event.type === 'keyup') {\n          this.tetris.rotatePieceCounterClockwise()\n        }\n        break\n      case 78:\n        // n\n        if (event.type === 'keyup') {\n          let name = window.prompt('I the other name')\n          this.connect(name)\n        }\n        break\n      default:\n        console.log('which', event.which)\n        break\n    }\n  }.bind(this)\n\n  // networking\n  this.sendGroundLoop = function (conn) {\n    clearInterval(this.sendGroundLoopInterval)\n    this.sendGroundLoopInterval = setInterval(() => {\n      conn.send(\n        this.tetris.serialize()\n      )\n    }, 1000)\n  }\n\n  this.connect = function (anotherName) {\n    let conn = this.peer.connect('zIKosj1p' + anotherName)\n    conn.on('open', () => {\n      this.addReplica(conn)\n    })\n  }\n\n  this.startPieceMoveDownLoop = function () {\n    setInterval(() => {\n      this.tetris.pieceMoveDown({ auto: true })\n    }, 800)\n  }\n\n  this.startDrawLoop = function () {\n    setInterval(() => {\n      this.tetris.draw()\n    }, 30) // 40fps\n  }\n\n  this.createPeer = function () {\n    this.name = window.prompt('I need your name')\n    this.peer = new Peer('zIKosj1p' + this.name)\n    this.peer.on('connection', (conn) => {\n      this.addReplica(conn)\n    })\n  }\n  this.initialize()\n}\n\nexport default HTMLTetrisGame\n","import './main.css'\nimport Game from './htmlgame'\n\nvar parent = document.getElementById('main-tetris')\nlet game = new Game(\n  parent,\n  {\n    playable: true\n  }\n)\n\nexport default () => {}\n","// import another component\nimport main from './main'\n\nmain()\n"]}